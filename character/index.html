---
layout: default
custom_css: [character]
custom_js: [translation-loader]

redirect_from: 
  - /kr/character/
  - /kr/character/index.html
---

<div class="main-wrapper">
    <!-- Ïñ∏Ïñ¥ ÏïàÎÇ¥ Î©îÏãúÏßÄ -->
    <div id="language-notice" class="language-notice" style="display: none;">
        <p id="language-notice-text"></p>
    </div>
    
    <div class="navigation-path">
        <script>document.write(`<a href="../?v=${APP_VERSION}" id="nav-home">Ìôà</a>`);</script>
        <span class="separator">/</span>
        <span class="current-page" id="nav-current">Í¥¥ÎèÑ</span>
    </div>
    <div class="header-container">
        <h1 id="page-title">Í¥¥ÎèÑ Ïú°ÏÑ±</h1>
    </div>
    <!-- Filter section -->
    <div class="filter-section">
        <div class="filter-header">
            <button class="filter-toggle-btn">
                <img src="{{ site.baseurl }}/assets/img/character-cards/filter.png" alt="ÌïÑÌÑ∞" />
                <span></span>
            </button>
            <button class="filter-reset-btn" style="display: none;">
                <img src="{{ site.baseurl }}/assets/img/character-cards/reset.png" alt="Ï¥àÍ∏∞Ìôî" />
            </button>
        </div>
        
        <div class="filter-content" style="display: none;">
            <!-- Element filter -->
            <div class="filter-group">
                <h3>ÏÜçÏÑ±</h3>
                <div class="filter-options">
                    <label>
                        <input type="checkbox" name="element" value="Î¨ºÎ¶¨">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏÜçÏÑ±_Î¨ºÎ¶¨.png" alt="Î¨ºÎ¶¨">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="Ï¥ùÍ≤©">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏÜçÏÑ±_Ï¥ùÍ≤©.png" alt="Ï¥ùÍ≤©">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ÌôîÏóº">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏÜçÏÑ±_ÌôîÏóº.png" alt="ÌôîÏóº">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ÎπôÍ≤∞">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏÜçÏÑ±_ÎπôÍ≤∞.png" alt="ÎπôÍ≤∞">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="Ï†ÑÍ≤©">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏÜçÏÑ±_Ï†ÑÍ≤©.png" alt="Ï†ÑÍ≤©">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ÏßàÌíç">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏÜçÏÑ±_ÏßàÌíç.png" alt="ÏßàÌíç">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ÏóºÎèô">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏÜçÏÑ±_ÏóºÎèô.png" alt="ÏóºÎèô">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ÌïµÏó¥">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏÜçÏÑ±_ÌïµÏó¥.png" alt="ÌïµÏó¥">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="Ï∂ïÎ≥µ">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏÜçÏÑ±_Ï∂ïÎ≥µ.png" alt="Ï∂ïÎ≥µ">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="Ï£ºÏõê">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏÜçÏÑ±_Ï£ºÏõê.png" alt="Ï£ºÏõê">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ÎßåÎä•">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏÜçÏÑ±_ÎßåÎä•.png" alt="ÎßåÎä•">
                        <span></span>
                    </label>
                </div>
            </div>
            
            <!-- Position filter -->
            <div class="filter-group">
                <h3>ÏßÅÏóÖ</h3>
                <div class="filter-options">
                    <label>
                        <input type="checkbox" name="position" value="ÏßÄÎ∞∞">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏßÅÏóÖ_ÏßÄÎ∞∞.png" alt="ÏßÄÎ∞∞">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="Î∞òÌï≠">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏßÅÏóÖ_Î∞òÌï≠.png" alt="Î∞òÌï≠">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="Ïö∞Ïõî">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏßÅÏóÖ_Ïö∞Ïõî.png" alt="Ïö∞Ïõî">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="Íµ¥Î≥µ">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏßÅÏóÖ_Íµ¥Î≥µ.png" alt="Íµ¥Î≥µ">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="Î∞©ÏúÑ">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏßÅÏóÖ_Î∞©ÏúÑ.png" alt="Î∞©ÏúÑ">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="Íµ¨Ïõê">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏßÅÏóÖ_Íµ¨Ïõê.png" alt="Íµ¨Ïõê">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="Ìï¥Î™Ö">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ÏßÅÏóÖ_Ìï¥Î™Ö.png" alt="Ìï¥Î™Ö">
                    </label>
                </div>
            </div>
            
            <!-- Rarity filter -->
            <div class="filter-group">
                <h3>Ïú†Ìòï</h3>
                <div class="filter-options tag-options">
                    <label>
                        <input type="checkbox" name="rarity" value="5" hidden>
                        <div class="star-container">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star5.png" alt="‚òÖ">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star5.png" alt="‚òÖ">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star5.png" alt="‚òÖ">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star5.png" alt="‚òÖ">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star5.png" alt="‚òÖ">
                        </div>
                    </label>
                    <label>
                        <input type="checkbox" name="rarity" value="4" hidden>
                        <div class="star-container">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star4.png" alt="‚òÖ">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star4.png" alt="‚òÖ">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star4.png" alt="‚òÖ">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star4.png" alt="‚òÖ">
                        </div>
                    </label>
                    <label><input type="checkbox" name="tag" value="ÌïúÏ†ï"><img src="{{ site.baseurl }}/assets/img/pay/Ï†ïÌï¥ÏßÑ Ïö¥Î™Ö.png" alt="ÌïúÏ†ï"></label>
                    <label><input type="checkbox" name="tag" value="ÌÜµÏÉÅ"><img src="{{ site.baseurl }}/assets/img/pay/ÎØ∏ÎûòÏùò Ïö¥Î™Ö.png" alt="ÌÜµÏÉÅ"></label>
                    <label><input type="checkbox" name="tag" value="ÌéòÎ•¥ÏÜåÎÇò3"><span>P3</span></label>
                    <label><input type="checkbox" name="tag" value="ÌéòÎ•¥ÏÜåÎÇò5"><span>P5</span></label>
                </div>
            </div>

            <!-- Tag filter -->
            <div class="filter-group">
                <h3>ÌÉúÍ∑∏</h3>
                <div class="filter-options tag-options">
                    <label><input type="checkbox" name="tag" value="TECHNICAL"><span>TECHNICAL</span></label>
                    <label><input type="checkbox" name="tag" value="Ï∂îÍ∞ÄÌö®Í≥º"><span>Ï∂îÍ∞Ä Ìö®Í≥º</span></label>
                    <label><input type="checkbox" name="tag" value="ÏßÄÏÜçÎåÄÎØ∏ÏßÄ"><span>ÏßÄÏÜç ÎåÄÎØ∏ÏßÄ</span></label>
                    <label><input type="checkbox" name="tag" value="Î∞©Ïñ¥Î†•Í∞êÏÜå"><span>Î∞©Ïñ¥Î†• Í∞êÏÜå</span></label>
                    <label><input type="checkbox" name="tag" value="Í¥ÄÌÜµ"><span>Í¥ÄÌÜµ</span></label>
                    <label><input type="checkbox" name="tag" value="Ìö®Í≥ºÎ™ÖÏ§ë"><span>Ìö®Í≥º Î™ÖÏ§ë</span></label>
                    <label><input type="checkbox" name="tag" value="Ïã§Îìú"><span>Ïã§Îìú</span></label>
                    <label><input type="checkbox" name="tag" value="ÌôîÏÉÅ"><span>ÌôîÏÉÅ</span></label>
                    <label><input type="checkbox" name="tag" value="ÌíçÏäµ"><span>ÌíçÏäµ</span></label>
                    <label><input type="checkbox" name="tag" value="Í∞êÏ†Ñ"><span>Í∞êÏ†Ñ</span></label>
                    <label><input type="checkbox" name="tag" value="ÎèôÍ≤∞"><span>ÎèôÍ≤∞</span></label>
                </div>
            </div>
        </div>
    </div>

    <!-- Separator line -->
    <div class="separator-line"></div>

    <!-- Search section below filter section -->
    <div class="search-section">
        <div class="search-container">
            <div class="search-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z" fill="rgba(255, 255, 255, 0.6)"/>
                </svg>
            </div>
            <input type="text" id="characterSearch" placeholder="Ï∫êÎ¶≠ÌÑ∞ Í≤ÄÏÉâ..." autocomplete="off">
            <div id="searchDropdown" class="search-dropdown"></div>
        </div>
        <div class="search-count"></div>
    </div>

    <!-- Character card container -->
    <div class="character-cards" id="characterCards">
        <!-- Dynamically generated by JavaScript -->
    </div>


<script>
    // Îã§Íµ≠Ïñ¥ ÏßÄÏõê Ìï®Ïàò
    async function updateLanguageContent() {
        const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';
        
        // Jekyll Îã§Íµ≠Ïñ¥ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
        const i18nData = {
            kr: {
                language_notice: "",
                nav_home: "Ìôà",
                nav_current: "Í¥¥ÎèÑ",
                page_title: "Í¥¥ÎèÑ Ïú°ÏÑ±",
                filtered_count: "Ï†ÑÏ≤¥",
                search_placeholder: "Ï∫êÎ¶≠ÌÑ∞ Í≤ÄÏÉâ..."
            },
            en: {
                language_notice: "{{ site.data.i18n.en.language_notice | default: 'üåç English translation is in progress. Some content may still be in Korean.' }}",
                nav_home: "{{ site.data.i18n.en.nav_home | default: 'Home' }}",
                nav_current: "{{ site.data.i18n.en.character_breadcrumb | default: 'Characters' }}",
                page_title: "{{ site.data.i18n.en.character_page_title | default: 'Characters' }}",
                filtered_count: "{{ site.data.i18n.en.filtered_count | default: 'Total' }}",
                search_placeholder: "{{ site.data.i18n.en.character_search_placeholder | default: 'Search characters...' }}"
            },
            jp: {
                language_notice: "{{ site.data.i18n.jp.language_notice | default: 'üåç Êó•Êú¨Ë™ûÁøªË®≥„ÅØÈÄ≤Ë°å‰∏≠„Åß„Åô„ÄÇ‰∏ÄÈÉ®„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÅØÈüìÂõΩË™û„ÅÆ„Åæ„Åæ„ÅÆÂ†¥Âêà„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ' }}",
                nav_home: "{{ site.data.i18n.jp.nav_home | default: '„Éõ„Éº„É†' }}",
                nav_current: "{{ site.data.i18n.jp.character_breadcrumb | default: '„Ç≠„É£„É©„ÇØ„Çø„Éº' }}",
                page_title: "{{ site.data.i18n.jp.character_page_title | default: '„Ç≠„É£„É©„ÇØ„Çø„Éº' }}",
                filtered_count: "{{ site.data.i18n.jp.filtered_count | default: 'ÂÖ®‰Ωì' }}",
                search_placeholder: "{{ site.data.i18n.jp.character_search_placeholder | default: '„Ç≠„É£„É©„ÇØ„Çø„ÉºÊ§úÁ¥¢...' }}"
            }
        };
        
        const data = i18nData[currentLang];
        if (!data) return;
        
        // Ïñ∏Ïñ¥ ÏïàÎÇ¥ Î©îÏãúÏßÄ
        if (currentLang !== 'kr') {
            const notice = document.getElementById('language-notice');
            const noticeText = document.getElementById('language-notice-text');
            if (notice && noticeText && data.language_notice) {
                noticeText.textContent = data.language_notice;
                notice.style.display = 'block';
            }
        }
        
        // ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò Î∞è Ï†úÎ™© ÏóÖÎç∞Ïù¥Ìä∏
        const navHome = document.getElementById('nav-home');
        const navCurrent = document.getElementById('nav-current');
        const pageTitle = document.getElementById('page-title');
        const searchInput = document.getElementById('characterSearch');
        
        if (navHome) navHome.textContent = data.nav_home;
        if (navCurrent) navCurrent.textContent = data.nav_current;
        if (pageTitle) pageTitle.textContent = data.page_title;
        if (searchInput) searchInput.placeholder = data.search_placeholder;
        
        // ÌïÑÌÑ∞ Ïπ¥Ïö¥Ìä∏ ÌÖçÏä§Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏Î•º ÏúÑÌïú Ï†ÑÏó≠ Î≥ÄÏàò ÏÑ§Ï†ï
        window.i18nFilteredCount = data.filtered_count;
        
        // ÌïÑÌÑ∞ Ï†úÎ™© Î≤àÏó≠
        updateFilterTitles(currentLang);
    }
    
    // ÌïÑÌÑ∞ Ï†úÎ™© Î≤àÏó≠ Ìï®Ïàò
    function updateFilterTitles(currentLang) {
        const filterTitles = {
            kr: {
                element: "ÏÜçÏÑ±",
                position: "ÏßÅÏóÖ", 
                type: "Ïú†Ìòï",
                tag: "ÌÉúÍ∑∏",
                count_unit: "Î™Ö"
            },
            en: {
                element: "Element",
                position: "Position",
                type: "Type", 
                tag: "Tag",
                count_unit: " "
            },
            jp: {
                element: "Â±ûÊÄß",
                position: "ËÅ∑Ê•≠",
                type: "„Çø„Ç§„Éó",
                tag: "„Çø„Ç∞",
                count_unit: "‰Ωì"
            }
        };
        
        const titles = filterTitles[currentLang];
        if (!titles) return;
        
        // ÌïÑÌÑ∞ Í∑∏Î£π Ï†úÎ™©Îì§ ÏóÖÎç∞Ïù¥Ìä∏
        const filterGroups = document.querySelectorAll('.filter-group h3');
        if (filterGroups.length >= 4) {
            filterGroups[0].textContent = titles.element; // ÏÜçÏÑ±
            filterGroups[1].textContent = titles.position; // ÏßÅÏóÖ
            filterGroups[2].textContent = titles.type; // Ïú†Ìòï
            filterGroups[3].textContent = titles.tag; // ÌÉúÍ∑∏
        }
        
        // Í∞úÏàò Îã®ÏúÑ Ï†ÑÏó≠ Î≥ÄÏàò ÏÑ§Ï†ï
        window.i18nCountUnit = titles.count_unit;
    }

    // Ïñ∏Ïñ¥Î≥Ñ SEO ÏÑ§Ï†ï Ìï®Ïàò
    function updateSEOContent() {
        const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';
        
        const seoData = {
            'kr': {
                title: 'Í¥¥ÎèÑ Ïú°ÏÑ± Í∞ÄÏù¥Îìú - ÌéòÎ•¥ÏÜåÎÇò5 Îçî Ìå¨ÌÖÄ X Î£®ÌéòÎ•¥ÎÑ∑',
                description: 'ÌéòÎ•¥ÏÜåÎÇò5 Îçî Ìå¨ÌÖÄ XÏùò Í¥¥ÎèÑÎ≥Ñ Ïú°ÏÑ± Í∞ÄÏù¥Îìú. Ï∂îÏ≤ú ÏÑ∏ÌåÖ, Ïä§ÌÇ¨, ÏùòÏãù, Ï†ÑÏö©Î¨¥Í∏∞ Ï†ïÎ≥¥Î•º ÌôïÏù∏ÌïòÏÑ∏Ïöî.'
            },
            'en': {
                title: 'Character Guide - Persona 5: The Phantom X LufelNet',
                description: 'Character development guide for Persona 5: The Phantom X. Check recommended setup, skills, awareness, and exclusive weapon info.'
            },
            'jp': {
                title: 'ÊÄ™ÁõóËÇ≤Êàê„Ç¨„Ç§„Éâ - „Éö„É´„ÇΩ„Éä5 „Ç∂„Éª„Éï„Ç°„É≥„Éà„É† X LufelNet',
                description: '„Éö„É´„ÇΩ„Éä5 „Ç∂„Éª„Éï„Ç°„É≥„Éà„É† X„ÅÆÊÄ™ÁõóÂà•ËÇ≤Êàê„Ç¨„Ç§„Éâ„ÄÇ„Åä„Åô„Åô„ÇÅË®≠ÂÆö„ÄÅ„Çπ„Ç≠„É´„ÄÅÊÑèË≠ò„ÄÅÂ∞ÇÁî®Ê≠¶Âô®ÊÉÖÂ†±„Çí„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ'
            }
        };
        
        const currentSEO = seoData[currentLang] || seoData['kr'];
        
        // ÌÉÄÏù¥ÌãÄ ÏóÖÎç∞Ïù¥Ìä∏
        document.title = currentSEO.title;
        
        // Î©îÌÉÄ ÌÉúÍ∑∏ ÏóÖÎç∞Ïù¥Ìä∏
        const metaDescription = document.querySelector('meta[name="description"]');
        const ogTitle = document.querySelector('meta[property="og:title"]');
        const ogDescription = document.querySelector('meta[property="og:description"]');
        
        if (metaDescription) metaDescription.setAttribute('content', currentSEO.description);
        if (ogTitle) ogTitle.setAttribute('content', currentSEO.title);
        if (ogDescription) ogDescription.setAttribute('content', currentSEO.description);
    }

    // Initialize navigation on page load
    // Í∏∞Ï°¥ DOMContentLoaded Î¶¨Ïä§ÎÑà Ï†úÍ±∞Îê® - ÌïòÎã®Ïùò ÌÜµÌï©Îêú Î¶¨Ïä§ÎÑà ÏÇ¨Ïö©

    // Ïä§ÌÅ¨Î¶ΩÌä∏ÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Ï∂îÏ∂úÌïòÎäî Ìï®Ïàò
    function extractDataFromScript(scriptText) {
        // characterDataÏôÄ characterListÎ•º Ï∂îÏ∂úÌïòÎäî Ï†ïÍ∑úÏãù
        const characterDataMatch = scriptText.match(/const characterData = ({[\s\S]*?});/);
        const characterListMatch = scriptText.match(/const characterList = ({[\s\S]*?});/);
        
        if (!characterDataMatch || !characterListMatch) {
            throw new Error('Failed to extract data from script');
        }
        
        // JSONÏúºÎ°ú ÌååÏã±ÌïòÍ∏∞ ÏúÑÌï¥ Function ÏÉùÏÑ±Ïûê ÏÇ¨Ïö©
        const characterData = new Function('return ' + characterDataMatch[1])();
        const characterList = new Function('return ' + characterListMatch[1])();
        
        return { characterData, characterList };
    }

    // Ïñ∏Ïñ¥Î≥Ñ Ï∫êÎ¶≠ÌÑ∞ Îç∞Ïù¥ÌÑ∞ Î°úÎî© Î∞è Î≥ëÌï©
    async function loadCharacterData() {
        const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';
        
        try {
            // 1. ÌïúÍµ≠Ïñ¥ Îç∞Ïù¥ÌÑ∞ Î°úÎî© (Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞)
            const krResponse = await fetch(`/data/kr/characters/characters.js?v=${APP_VERSION}`);
            if (!krResponse.ok) {
                throw new Error('Failed to load KR character data');
            }
            
            const krScriptText = await krResponse.text();
            const { characterData: krCharacterData, characterList: krCharacterList } = extractDataFromScript(krScriptText);
            
            console.log('KR character count:', Object.keys(krCharacterData).length);
            console.log('KR character list:', krCharacterList);
            
            // 2. Ïñ∏Ïñ¥Î≥Ñ Îç∞Ïù¥ÌÑ∞ Î°úÎî© (ÌïúÍµ≠Ïñ¥Í∞Ä ÏïÑÎãå Í≤ΩÏö∞)
            if (currentLang !== 'kr') {
                console.log(`üîç Attempting to load ${currentLang} data...`);
                const langUrl = `/data/${currentLang}/characters/characters.js?v=${APP_VERSION}`;
                console.log('Language data URL:', langUrl);
                
                const langResponse = await fetch(langUrl);
                console.log('Language data response status:', langResponse.status);
                
                if (langResponse.ok) {
                    console.log('‚úÖ Language data loaded successfully');
                    const langScriptText = await langResponse.text();
                    console.log('Language script text length:', langScriptText.length);
                    
                    const { characterData: langCharacterData, characterList: langCharacterList } = extractDataFromScript(langScriptText);
                    
                    console.log(`${currentLang.toUpperCase()} character count:`, Object.keys(langCharacterData).length);
                    console.log(`${currentLang.toUpperCase()} character list:`, langCharacterList);
                    
                    // 3. Îç∞Ïù¥ÌÑ∞ Î≥ëÌï© (ÌïòÏù¥Î∏åÎ¶¨Îìú Î∞©Ïãù) - Ïñ∏Ïñ¥Î≥Ñ Ï∫êÎ¶≠ÌÑ∞Îßå Ìè¨Ìï®
                    console.log('üîÑ Starting data merge...');
                    const mergedData = mergeCharacterData(krCharacterData, langCharacterData);
                    console.log('‚úÖ Data merge completed');
                    
                    // Ï§ëÏöî: Ï†ÑÏó≠ Î≥ÄÏàòÎ•º ÏôÑÏ†ÑÌûà ÍµêÏ≤¥
                    window.characterData = mergedData; // Î≥ëÌï©Îêú Îç∞Ïù¥ÌÑ∞Îßå ÏÇ¨Ïö©
                    window.characterList = langCharacterList; // Ïñ∏Ïñ¥Î≥Ñ Ï∫êÎ¶≠ÌÑ∞ Î™©Î°ù ÏÇ¨Ïö©
                    
                    console.log('Final characterData count:', Object.keys(window.characterData).length);
                    console.log('Final characterData keys:', Object.keys(window.characterData));
                    console.log('Final character list:', window.characterList);
                    
                    // Î≥ëÌï©Îêú Îç∞Ïù¥ÌÑ∞ ÏÉòÌîå ÌôïÏù∏
                    const sampleChar = Object.keys(window.characterData)[1]; // Î†å
                    console.log(`üîç Final merged data sample (${sampleChar}):`, {
                        element: window.characterData[sampleChar]?.element,
                        position: window.characterData[sampleChar]?.position, 
                        rarity: window.characterData[sampleChar]?.rarity,
                        name: window.characterData[sampleChar]?.name,
                        persona: window.characterData[sampleChar]?.persona
                    });
                    
                } else {
                    console.log('‚ùå Language data not found, using KR data. Status:', langResponse.status);
                    // Ïñ∏Ïñ¥Î≥Ñ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏúºÎ©¥ ÌïúÍµ≠Ïñ¥ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
                    window.characterData = krCharacterData;
                    window.characterList = krCharacterList;
                }
            } else {
                console.log('Using KR data directly');
                // ÌïúÍµ≠Ïñ¥Ïù∏ Í≤ΩÏö∞ Í∑∏ÎåÄÎ°ú ÏÇ¨Ïö©
                window.characterData = krCharacterData;
                window.characterList = krCharacterList;
            }
            
            return true;
            
        } catch (error) {
            console.error('Failed to load character data:', error);
            return false;
        }
    }
    
    // Ï∫êÎ¶≠ÌÑ∞ Îç∞Ïù¥ÌÑ∞ Î≥ëÌï© Ìï®Ïàò (ÌïòÏù¥Î∏åÎ¶¨Îìú Î∞©Ïãù)
    function mergeCharacterData(krData, langData) {
        const mergedData = {};
        const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';
        
        console.log('üöÄüöÄüöÄ NEW MERGE FUNCTION IS RUNNING! üöÄüöÄüöÄ');
        console.log('=== MERGE CHARACTER DATA DEBUG ===');
        console.log('Current language:', currentLang);
        console.log('KR data keys:', Object.keys(krData).length, 'characters');
        console.log('Lang data keys:', Object.keys(langData).length, 'characters');
        
        // ÏÉòÌîå Îç∞Ïù¥ÌÑ∞ ÌôïÏù∏
        const firstKrKey = Object.keys(krData)[0];
        const firstLangKey = Object.keys(langData)[0];
        
        console.log(`Sample KR data (${firstKrKey}):`, {
            element: krData[firstKrKey]?.element,
            position: krData[firstKrKey]?.position,
            rarity: krData[firstKrKey]?.rarity,
            name: krData[firstKrKey]?.name,
            name_en: krData[firstKrKey]?.name_en,
            name_jp: krData[firstKrKey]?.name_jp,
            persona: krData[firstKrKey]?.persona,
            persona_en: krData[firstKrKey]?.persona_en,
            persona_jp: krData[firstKrKey]?.persona_jp,
            role: krData[firstKrKey]?.role,
            tag: krData[firstKrKey]?.tag
        });
        
        console.log(`Sample Lang data (${firstLangKey}):`, {
            element: langData[firstLangKey]?.element,
            position: langData[firstLangKey]?.position,
            rarity: langData[firstLangKey]?.rarity,
            name: langData[firstLangKey]?.name,
            role: langData[firstLangKey]?.role,
            tag: langData[firstLangKey]?.tag
        });
        
        // Ïñ∏Ïñ¥Î≥Ñ Îç∞Ïù¥ÌÑ∞Ïóê ÏûàÎäî Ï∫êÎ¶≠ÌÑ∞Îßå Ìè¨Ìï® (langData Í∏∞Ï§ÄÏúºÎ°ú ÌïÑÌÑ∞ÎßÅ)
        for (const characterKey in langData) {
            console.log('Merging character:', characterKey);
            
            if (krData[characterKey]) {
                console.log(`‚úÖ Found KR data for ${characterKey}`);
                // ÌïúÍµ≠Ïñ¥ Îç∞Ïù¥ÌÑ∞Î•º Í∏∞Î≥∏ÏúºÎ°ú ÏôÑÏ†ÑÌûà Î≥µÏÇ¨ (Î™®Îì† ÏÜçÏÑ± Î≥¥Ï°¥)
                mergedData[characterKey] = { ...krData[characterKey] };
                console.log(`Copied KR data for ${characterKey}:`, {
                    element: mergedData[characterKey].element,
                    position: mergedData[characterKey].position,
                    rarity: mergedData[characterKey].rarity,
                    name: mergedData[characterKey].name
                });
                
                const langChar = langData[characterKey];
                const krChar = krData[characterKey];
                
                // name Ï≤òÎ¶¨: ÌòÑÏû¨ Ïñ∏Ïñ¥Ïóê Îî∞Îùº Ï†ÅÏ†àÌïú Ïù¥Î¶Ñ ÏÇ¨Ïö©
                if (currentLang === 'en') {
                    if (krChar.name_en) {
                        mergedData[characterKey].name = krChar.name_en;
                        console.log(`Using KR EN name for ${characterKey}: ${krChar.name_en}`);
                    } else if (langChar.name && langChar.name !== '') {
                        mergedData[characterKey].name = langChar.name;
                        console.log(`Using Lang EN name for ${characterKey}: ${langChar.name}`);
                    } else {
                        console.log(`Using default KR name for ${characterKey}: ${krChar.name}`);
                    }
                } else if (currentLang === 'jp') {
                    if (krChar.name_jp) {
                        mergedData[characterKey].name = krChar.name_jp;
                        console.log(`Using KR JP name for ${characterKey}: ${krChar.name_jp}`);
                    } else if (langChar.name && langChar.name !== '') {
                        mergedData[characterKey].name = langChar.name;
                        console.log(`Using Lang JP name for ${characterKey}: ${langChar.name}`);
                    } else {
                        console.log(`Using default KR name for ${characterKey}: ${krChar.name}`);
                    }
                } else {
                    // KR Ïñ∏Ïñ¥Ïùº ÎïåÎäî Í∏∞Î≥∏ KR Ïù¥Î¶Ñ ÏÇ¨Ïö©
                    console.log(`Using default KR name for ${characterKey}: ${krChar.name}`);
                }
                
                // persona Ï≤òÎ¶¨: ÌòÑÏû¨ Ïñ∏Ïñ¥Ïóê Îî∞Îùº Ï†ÅÏ†àÌïú ÌéòÎ•¥ÏÜåÎÇò Ïù¥Î¶Ñ ÏÇ¨Ïö©
                if (currentLang === 'en') {
                    if (krChar.persona_en) {
                        mergedData[characterKey].persona = krChar.persona_en;
                        console.log(`Using KR EN persona for ${characterKey}: ${krChar.persona_en}`);
                    } else if (langChar.persona && langChar.persona !== '') {
                        mergedData[characterKey].persona = langChar.persona;
                        console.log(`Using Lang EN persona for ${characterKey}: ${langChar.persona}`);
                    }
                } else if (currentLang === 'jp') {
                    if (krChar.persona_jp) {
                        mergedData[characterKey].persona = krChar.persona_jp;
                        console.log(`Using KR JP persona for ${characterKey}: ${krChar.persona_jp}`);
                    } else if (langChar.persona && langChar.persona !== '') {
                        mergedData[characterKey].persona = langChar.persona;
                        console.log(`Using Lang JP persona for ${characterKey}: ${langChar.persona}`);
                    }
                }
                
                // ÏÜçÏÑ± Î≤àÏó≠ Ï≤òÎ¶¨ (element ÌïÑÎìúÎäî Í∑∏ÎåÄÎ°ú Ïú†ÏßÄÌïòÎêò, ÌëúÏãúÏö© Î≤àÏó≠ Ï∂îÍ∞Ä)
                if (currentLang !== 'kr' && typeof characterTranslations !== 'undefined' && characterTranslations.elements) {
                    const translatedElement = characterTranslations.elements[mergedData[characterKey].element];
                    if (translatedElement) {
                        mergedData[characterKey].element_display = translatedElement;
                    }
                    
                    const translatedPosition = characterTranslations.positions[mergedData[characterKey].position];
                    if (translatedPosition) {
                        mergedData[characterKey].position_display = translatedPosition;
                    }
                }
                
                // Îã§Î•∏ ÌïÑÎìúÎì§ÏùÄ Ïñ∏Ïñ¥Î≥Ñ Îç∞Ïù¥ÌÑ∞Ïóê Í∞íÏù¥ ÏûàÍ≥† Îπà Î¨∏ÏûêÏó¥Ïù¥ ÏïÑÎãê ÎïåÎßå ÎçÆÏñ¥Ïì∞Í∏∞
                // Ï§ëÏöî: element, position, rarity Îì±ÏùÄ Ï†àÎåÄ ÎçÆÏñ¥Ïì∞ÏßÄ ÏïäÏùå (ÌïúÍµ≠Ïñ¥ Îç∞Ïù¥ÌÑ∞ Ïú†ÏßÄ)
                if (langChar.role && langChar.role !== '') {
                    mergedData[characterKey].role = langChar.role;
                }
                if (langChar.tag && langChar.tag !== '') {
                    mergedData[characterKey].tag = langChar.tag;
                }
                if (langChar.release_order !== undefined && langChar.release_order !== 0) {
                    mergedData[characterKey].release_order = langChar.release_order;
                }
                
                // Ï§ëÏöîÌïú ÏÜçÏÑ±Îì§Ïù¥ Ï†úÎåÄÎ°ú Î≥¥Ï°¥ÎêòÏóàÎäîÏßÄ ÌôïÏù∏
                if (!mergedData[characterKey].element || !mergedData[characterKey].position || !mergedData[characterKey].rarity) {
                    console.warn(`Missing critical data for ${characterKey}:`, {
                        element: mergedData[characterKey].element,
                        position: mergedData[characterKey].position,
                        rarity: mergedData[characterKey].rarity
                    });
                }
                
            } else {
                console.warn(`‚ùå Character ${characterKey} not found in KR data`);
                console.warn('Available KR characters:', Object.keys(krData).slice(0, 10), '... (showing first 10)');
            }
        }
        
        console.log('Merged data keys:', Object.keys(mergedData).length, 'characters');
        console.log('Final merged characters:', Object.keys(mergedData));
        
        // Ï≤´ Î≤àÏß∏ Î≥ëÌï©Îêú Ï∫êÎ¶≠ÌÑ∞Ïùò Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞ ÌôïÏù∏
        const firstMergedKey = Object.keys(mergedData)[0];
        if (firstMergedKey) {
            console.log('FULL MERGED DATA for', firstMergedKey, ':', mergedData[firstMergedKey]);
        }
        
        return mergedData;
    }
    
    // P3 ÌïÑÌÑ∞ ÌëúÏãú Ïó¨Î∂Ä ÌôïÏù∏
    function shouldShowP3Filter() {
        if (!characterData) return false;
        
        // Î°úÎî©Îêú Ï∫êÎ¶≠ÌÑ∞ Ï§ëÏóê persona3=trueÏù∏ Ï∫êÎ¶≠ÌÑ∞Í∞Ä ÏûàÎäîÏßÄ ÌôïÏù∏
        return Object.values(characterData).some(char => char.persona3 === true);
    }
    
    // P3 ÌïÑÌÑ∞ ÌëúÏãú/Ïà®ÍπÄ Ï≤òÎ¶¨
    function toggleP3Filter() {
        const p3Filter = document.querySelector('label input[value="ÌéòÎ•¥ÏÜåÎÇò3"]');
        if (p3Filter) {
            const p3Label = p3Filter.closest('label');
            if (shouldShowP3Filter()) {
                p3Label.style.display = 'inline-block';
            } else {
                p3Label.style.display = 'none';
            }
        }
    }

    // Ï§ëÎ≥µ Ïã§Ìñâ Î∞©ÏßÄÎ•º ÏúÑÌïú ÌîåÎûòÍ∑∏
    let isInitializing = false;
    let isInitialized = false;

    async function initializePageContent() {
        // Ï§ëÎ≥µ Ïã§Ìñâ Î∞©ÏßÄ
        if (isInitializing || isInitialized) {
            console.log('initializePageContent already running or completed');
            return;
        }
        
        isInitializing = true;
        console.log('=== STARTING PAGE INITIALIZATION ===');
        
        // Ï∫êÎ¶≠ÌÑ∞ Îç∞Ïù¥ÌÑ∞ Î°úÎî©
        const dataLoaded = await loadCharacterData();
        if (!dataLoaded || typeof window.characterData === 'undefined') {
            console.error('characterData is not loaded');
            isInitializing = false;
            return;
        }
        
        // ÏßÄÏó≠ Î≥ÄÏàòÎ•º window.characterDataÎ°ú ÏÑ§Ï†ï
        const characterData = window.characterData;
        const characterList = window.characterList;
        
        // P3 ÌïÑÌÑ∞ ÌëúÏãú Ïó¨Î∂Ä Ï≤òÎ¶¨
        toggleP3Filter();

        const cardsContainer = document.getElementById('characterCards');
        const searchCount = document.querySelector('.search-count');
        
        // Í∏∞Ï°¥ Ïπ¥ÎìúÎì§ Ï†úÍ±∞ (Ï§ëÎ≥µ Î∞©ÏßÄ)
        cardsContainer.innerHTML = '';
        
        // Combine mainParty and supportParty from characterList (Ïñ∏Ïñ¥Î≥Ñ Ï†úÌïúÎêú Î™©Î°ù)
        let allCharacters = [
            ...characterList.mainParty,
            ...characterList.supportParty
        ];

        // Exclude 'Wonder' from characters
        allCharacters = allCharacters.filter(character => character !== "ÏõêÎçî");
        
        console.log('Character list for current language:', allCharacters);
        console.log('Available characters in characterData:', Object.keys(characterData));
        
        // characterListÏóê ÏûàÎäî Ï∫êÎ¶≠ÌÑ∞Îßå ÏÇ¨Ïö©ÌïòÍ≥†, characterDataÏóêÎèÑ Ï°¥Ïû¨ÌïòÎäîÏßÄ ÌôïÏù∏
        const availableCharacters = allCharacters.filter(characterName => {
            const exists = characterData[characterName] !== undefined;
            if (!exists) {
                console.warn(`Character ${characterName} not found in characterData`);
            }
            return exists;
        });
        
        console.log('Final available characters:', availableCharacters);
        
        // Sort by release_order (descending), then by rarity
        const sortedCharacters = availableCharacters.sort((a, b) => {
            const releaseOrderDiff = characterData[b].release_order - characterData[a].release_order;
            if (releaseOrderDiff !== 0) return releaseOrderDiff;
            return characterData[b].rarity - characterData[a].rarity;
        });
        
        // Ï¥àÍ∏∞ Í≤ÄÏÉâ Í≤∞Í≥º Ïàò ÌëúÏãú
        const countText = window.i18nFilteredCount || 'Ï†ÑÏ≤¥';
        const countUnit = window.i18nCountUnit || 'Î™Ö';
        searchCount.textContent = `${countText} ${sortedCharacters.length}${countUnit}`;
        
        console.log('=== STARTING CARD CREATION ===');
        console.log('sortedCharacters array:', sortedCharacters);
        console.log('characterData object keys:', Object.keys(characterData));
        
        // Create card for each character
        sortedCharacters.forEach((characterName, index) => {
            console.log(`[${index}] Creating card for: ${characterName}`);
            
            // window.characterData ÏßÅÏ†ë ÌôïÏù∏
            if (index === 0) {
                console.log(`üîç Direct window.characterData check for ${characterName}:`, {
                    element: window.characterData[characterName]?.element,
                    position: window.characterData[characterName]?.position,
                    rarity: window.characterData[characterName]?.rarity,
                    name: window.characterData[characterName]?.name
                });
            }
            
            const charData = characterData[characterName];
            if (!charData) {
                console.error(`No data found for character: ${characterName}`);
                return;
            }
            
            // Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞ Íµ¨Ï°∞ ÌôïÏù∏ (Ï≤´ Î≤àÏß∏ Ï∫êÎ¶≠ÌÑ∞Îßå)
            if (index === 0) {
                console.log(`FULL DATA for ${characterName}:`, charData);
                console.log(`All keys in charData:`, Object.keys(charData));
                console.log(`üîç characterData vs window.characterData:`, {
                    'characterData': characterData === window.characterData,
                    'characterData keys': Object.keys(characterData).length,
                    'window.characterData keys': Object.keys(window.characterData).length
                });
            }
            
            console.log(`${characterName} data:`, {
                element: charData.element,
                position: charData.position,
                rarity: charData.rarity,
                name: charData.name
            });
            
            // ÏÜçÏÑ± Í∞í ÎîîÎ≤ÑÍ∑∏
            const element = charData.element;
            const position = charData.position;
            const rarity = charData.rarity;
            
            if (!element || !position || !rarity) {
                console.warn(`Missing attributes for ${characterName}:`, {
                    element: element,
                    position: position,
                    rarity: rarity
                });
            }
            
            const card = document.createElement('div');
            card.className = 'card';
            card.dataset.element = element || 'undefined';
            card.dataset.position = position || 'undefined';
            card.dataset.rarity = rarity || 'undefined';
            card.dataset.persona5 = charData.persona5 ? 'true' : 'false';
            card.dataset.persona3 = charData.persona3 ? 'true' : 'false';
            card.dataset.limit = charData.limit ? 'true' : 'false';
            card.dataset.tags = charData.tag || '';
            
            // Create link wrapper - Ïñ∏Ïñ¥ ÌååÎùºÎØ∏ÌÑ∞ Ï∂îÍ∞Ä
            const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';
            const link = document.createElement('a');
            link.href = `/character.html?name=${encodeURIComponent(characterName)}&lang=${currentLang}&v=${APP_VERSION}`;
            link.style.textDecoration = 'none';
            link.style.color = 'inherit';
            
            // Position icon container
            const positionContainer = document.createElement('div');
            positionContainer.className = 'position-container';
            
            // Position icon
            const positionIcon = document.createElement('img');
            const positionForIcon = position || 'undefined';
            positionIcon.src = `{{ site.baseurl }}/assets/img/character-cards/ÏßÅÏóÖ_${positionForIcon}.png`;
            positionIcon.alt = charData.position_display || position || 'undefined';
            positionIcon.className = 'position-icon';
            
            // Character image
            const img = document.createElement('img');
            img.src = `{{ site.baseurl }}/assets/img/character-cards/card_skeleton.webp`;
            img.alt = characterName;
            img.className = 'character-img';
            
            // Ïã§Ï†ú Ïù¥ÎØ∏ÏßÄ Î°úÎìú
            const realImage = new Image();
            realImage.src = `{{ site.baseurl }}/assets/img/character-cards/${characterName}.webp`;
            realImage.alt = characterName;
            realImage.className = 'character-img';
            realImage.onload = () => {
                img.src = realImage.src;
                img.classList.add('loaded');
            };
            
            // Element icon
            const elementIcon = document.createElement('img');
            const elementForIcon = element || 'undefined';
            elementIcon.src = `{{ site.baseurl }}/assets/img/character-cards/ÏÜçÏÑ±_${elementForIcon}.png`;
            elementIcon.alt = charData.element_display || element || 'undefined';
            elementIcon.className = 'element-icon';
            
            // Add name
            const nameText = document.createElement('span');
            nameText.textContent = charData.name;
            nameText.className = 'name-text';
            nameText.dataset.persona3 = charData.persona3;
            nameText.dataset.persona4 = charData.persona4;
            nameText.dataset.persona5 = charData.persona5;
            
            positionContainer.appendChild(positionIcon);
            link.appendChild(positionContainer);
            link.appendChild(img);
            link.appendChild(elementIcon);
            link.appendChild(nameText);
            card.appendChild(link);
            cardsContainer.appendChild(card);
        });

        // ÌïÑÌÑ∞ Î∞è Í≤ÄÏÉâ Í∏∞Îä• Ï¥àÍ∏∞Ìôî
        initializeFiltersAndSearch(sortedCharacters);
        
        // Î≤àÏó≠ Ï†ÅÏö© (Îç∞Ïù¥ÌÑ∞ Î°úÎî© ÌõÑ)
        await applyTranslations();
        
        // Ï¥àÍ∏∞Ìôî ÏôÑÎ£å
        isInitializing = false;
        isInitialized = true;
        console.log('=== PAGE INITIALIZATION COMPLETED ===');
    } // initializePageContent Ìï®Ïàò Ï¢ÖÎ£å
    
    // ÌïÑÌÑ∞ Î∞è Í≤ÄÏÉâ Í∏∞Îä• Ï¥àÍ∏∞Ìôî
    function initializeFiltersAndSearch(sortedCharacters) {
        const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';
        
        // ÏòÅÏñ¥/ÏùºÎ≥∏Ïñ¥Ïùº Îïå ÌÉúÍ∑∏ ÌïÑÌÑ∞ Ïà®Í∏∞Í∏∞
        if (currentLang === 'en' || currentLang === 'jp') {
            const tagFilterGroup = document.querySelector('.filter-group:last-child');
            if (tagFilterGroup) {
                tagFilterGroup.style.display = 'none';
            }
        }

        // ÌïÑÌÑ∞ Î≥ÄÍ≤Ω Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà
        const filterInputs = document.querySelectorAll('input[type="checkbox"]');
        filterInputs.forEach(input => {
            input.addEventListener('change', applyFilters);
        });

        const searchCount = document.querySelector('.search-count');
        const filterToggleBtn = document.querySelector('.filter-toggle-btn');
        const filterContent = document.querySelector('.filter-content');
        const filterResetBtn = document.querySelector('.filter-reset-btn');
        const checkboxes = document.querySelectorAll('.filter-options input[type="checkbox"]');
        
        if (filterContent) {
            filterContent.style.display = 'block';
        }

        // Filter toggle
        if (filterToggleBtn) {
            filterToggleBtn.addEventListener('click', () => {
                filterContent.style.display = filterContent.style.display === 'none' ? 'block' : 'none';
            });
            filterToggleBtn.style.display = 'none';
        }
        
        // Reset button
        if (filterResetBtn) {
            filterResetBtn.addEventListener('click', () => {
                checkboxes.forEach(cb => cb.checked = false);
                filterResetBtn.style.display = 'none';
                applyFilters();
            });
            filterResetBtn.style.display = 'none';
        }

        // Filter application function
        function applyFilters() {
            const selectedElements = Array.from(document.querySelectorAll('input[name="element"]:checked')).map(cb => cb.value);
            const selectedPositions = Array.from(document.querySelectorAll('input[name="position"]:checked')).map(cb => cb.value);
            const selectedRarities = Array.from(document.querySelectorAll('input[name="rarity"]:checked')).map(cb => parseInt(cb.value));
            const selectedTags = Array.from(document.querySelectorAll('input[name="tag"]:checked')).map(cb => cb.value);
            
            let visibleCount = 0;
            
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                const element = card.dataset.element;
                const position = card.dataset.position;
                const rarity = parseInt(card.dataset.rarity);
                const isPersona5 = card.dataset.persona5 === 'true';
                const isPersona3 = card.dataset.persona3 === 'true';
                const isLimited = card.dataset.limit === 'true';
                const characterTags = card.dataset.tags || '';
                
                const elementMatch = selectedElements.length === 0 || 
                    selectedElements.includes(element) || 
                    (element === "ÏßàÌíçÎπôÍ≤∞" && (selectedElements.includes("ÏßàÌíç") || selectedElements.includes("ÎπôÍ≤∞")));
                    
                const positionMatch = selectedPositions.length === 0 || selectedPositions.includes(position);
                const rarityMatch = selectedRarities.length === 0 || selectedRarities.includes(rarity);
                
                const tagMatch = selectedTags.every(tag => {
                    switch(tag) {
                        case 'ÌéòÎ•¥ÏÜåÎÇò5':
                            return isPersona5;
                        case 'ÌéòÎ•¥ÏÜåÎÇò3':
                            return isPersona3;
                        case 'ÌïúÏ†ï':
                            return isLimited;
                        case 'ÌÜµÏÉÅ':
                            return !isLimited;
                        case 'TECHNICAL':
                            return characterTags.includes('TECHNICAL') || characterTags.includes('Ïä§ÌÇ¨ÎßàÏä§ÌÑ∞');
                        case 'Ï∂îÍ∞ÄÌö®Í≥º':
                            return characterTags.includes('Ï∂îÍ∞Ä Ìö®Í≥º') || characterTags.includes('Ï∂îÍ∞ÄÌö®Í≥º');
                        case 'ÏßÄÏÜçÎåÄÎØ∏ÏßÄ':
                            return characterTags.includes('ÏßÄÏÜç ÎåÄÎØ∏ÏßÄ') || characterTags.includes('ÌôîÏÉÅ') || characterTags.includes('Ï£ºÏõê');
                        case 'ÌôîÏÉÅ':
                            return characterTags.includes('ÌôîÏÉÅ') || (characterTags.includes('ÏõêÏÜå Ïù¥ÏÉÅ') && !characterTags.includes('ÏõêÏÜå Ïù¥ÏÉÅ Ï†úÍ±∞'));
                        case 'ÌíçÏäµ':
                            return characterTags.includes('ÌíçÏäµ') || (characterTags.includes('ÏõêÏÜå Ïù¥ÏÉÅ') && !characterTags.includes('ÏõêÏÜå Ïù¥ÏÉÅ Ï†úÍ±∞'));
                        case 'Í∞êÏ†Ñ':
                            return characterTags.includes('Í∞êÏ†Ñ') || (characterTags.includes('ÏõêÏÜå Ïù¥ÏÉÅ') && !characterTags.includes('ÏõêÏÜå Ïù¥ÏÉÅ Ï†úÍ±∞'));
                        case 'ÎèôÍ≤∞':
                            return characterTags.includes('ÎèôÍ≤∞') || (characterTags.includes('ÏõêÏÜå Ïù¥ÏÉÅ') && !characterTags.includes('ÏõêÏÜå Ïù¥ÏÉÅ Ï†úÍ±∞'));
                        case 'Ïã§Îìú':
                            return characterTags.includes('Ïã§Îìú');
                        case 'Ìö®Í≥ºÎ™ÖÏ§ë':
                            return characterTags.includes('Ìö®Í≥º Î™ÖÏ§ë');
                        case 'Î∞©Ïñ¥Î†•Í∞êÏÜå':
                            return characterTags.includes('Î∞©Ïñ¥Î†• Í∞êÏÜå');
                        case 'Í¥ÄÌÜµ':
                            return characterTags.includes('Í¥ÄÌÜµ');
                        default:
                            return false;
                    }
                });
                
                const shouldShow = elementMatch && positionMatch && rarityMatch && (selectedTags.length === 0 || tagMatch);
                card.style.display = shouldShow ? 'block' : 'none';
                if (shouldShow) visibleCount++;
            });
            
            // Update search count
            if (searchCount) {
                const countText = window.i18nFilteredCount || 'Ï†ÑÏ≤¥';
                const countUnit = window.i18nCountUnit || 'Î™Ö';
                searchCount.textContent = `${countText} ${visibleCount}${countUnit}`;
            }
        }

        // Î≥ÑÏπ≠ Îß§Ìïë
        const nicknameMap = {
            'Ïú†Ïù¥' : 'YUI',
            'ÎùºÎ©¥' : 'Ïπ¥ÎÖ∏ Ïäå',
            'ÏößÏÉ§' : 'ÏÇ¨Ïπ¥Î™®ÌÜ† Î•òÏßÄ',
            'ÏàòÎ™®ÏΩî' : 'ÎÖ∏Í≤å ÌÜ†Î™®ÏΩî¬∑Ïó¨Î¶Ñ',
            'ÏàòÌÜ†Ìïò' : 'ÏïÑÎùºÏù¥ Î™®ÌÜ†Ìïò¬∑Ïó¨Î¶Ñ',
            'ÏôïÏôïÎ£®': 'ÎèÑÍ≤êÏûêÏπ¥ Î£®Ïö∞ÎÇò',
            'ÏñºÌÉ±': 'ÏïÑÏãúÏïº ÎßàÏÇ¨ÌÇ§',
            'Ï°∞Ïª§': 'ÏïÑÎßàÎØ∏Ïïº Î†å',
            'ÏùòÏÇ¨' : 'ÌÇ§ÌÉÄÏûêÌÜ† ÌÇ§Îùº',
            'Í∑∏ÏÉàÎÅº': 'ÏïÑÏºÄÏπò Í≥†Î°ú',
            'ÌôîÏò§ÎßÅ' : 'Î¶¨ ÏïºÏò§ÎßÅ¬∑ÏÇ¨ÏûêÎ¨¥',
            'Î∂àÏò§ÎßÅ' : 'Î¶¨ ÏïºÏò§ÎßÅ¬∑ÏÇ¨ÏûêÎ¨¥',
            '5Î¶¨ÏΩî' : 'ÌÉÄÎÑ§Î¨¥Îùº Î¶¨ÏΩî¬∑Îß§Ìôî',
            'ÌíçÎ¶¨ÏΩî' : 'ÌÉÄÎÑ§Î¨¥Îùº Î¶¨ÏΩî¬∑Îß§Ìôî',
            'ÌíçÌÉÄÎâ¥' : 'ÏΩîÌÜ†ÎÑ§ Î™ΩÌÉÄÎâ¥¬∑Î∞±Ï°∞',
            'Î∞±ÌÉÄÎâ¥' : 'ÏΩîÌÜ†ÎÑ§ Î™ΩÌÉÄÎâ¥¬∑Î∞±Ï°∞',
            '3Ï£º' : 'Ïú†ÌÇ§ ÎßàÏΩîÌÜ†'
        };

        // Í≤ÄÏÉâ Í∏∞Îä• Íµ¨ÌòÑ
        const searchInput = document.getElementById('characterSearch');
        const dropdown = document.getElementById('searchDropdown');

        if (searchInput) {
            searchInput.addEventListener('input', (e) => {
                const searchValue = e.target.value.toLowerCase();
                if (dropdown) {
                    dropdown.innerHTML = '';
                    
                    if (searchValue.length > 0) {
                        // characterDataÍ∞Ä Î°úÎìúÎêòÏóàÎäîÏßÄ ÌôïÏù∏
                        if (!window.characterData) {
                            console.error('Character data not loaded yet');
                            return;
                        }

                        // sortedCharacters Î∞∞Ïó¥ÏóêÏÑú Í≤ÄÏÉâ
                        const matches = sortedCharacters.filter(characterName => {
                            if (!window.characterData[characterName]) {
                                console.warn(`No data found for character: ${characterName}`);
                                return false;
                            }

                            const charData = window.characterData[characterName];
                            const displayName = charData.name ? charData.name.toLowerCase() : '';
                            const originalName = characterName.toLowerCase();
                            
                            // Î≥ÑÏπ≠ Îß§Ïπ≠ÎèÑ Ìè¨Ìï®
                            const nicknameMatch = Object.entries(nicknameMap).find(([nickname, realName]) => 
                                nickname.toLowerCase().includes(searchValue) && realName === charData.name
                            );

                            return displayName.includes(searchValue) || 
                                   originalName.includes(searchValue) ||
                                   nicknameMatch !== undefined;
                        });

                        if (matches.length > 0) {
                            dropdown.style.display = 'block';
                            matches.forEach(name => {
                                if (!window.characterData[name]) return;
                                
                                const div = document.createElement('div');
                                div.className = 'dropdown-item';
                                div.textContent = window.characterData[name].name;
                                div.addEventListener('click', () => {
                                    searchInput.value = window.characterData[name].name;
                                    dropdown.style.display = 'none';
                                    filterBySearch(name.toLowerCase());
                                });
                                dropdown.appendChild(div);
                            });
                        } else {
                            dropdown.style.display = 'none';
                        }
                    } else {
                        dropdown.style.display = 'none';
                        filterBySearch('');
                    }
                }

                filterBySearch(searchValue);
            });
        }

        // Search filtering function
        function filterBySearch(searchValue) {
            if (!window.characterData) {
                console.error('Character data not loaded yet');
                return;
            }

            let visibleCount = 0;
            const cards = document.querySelectorAll('.card');
            
            cards.forEach(card => {
                const nameText = card.querySelector('.name-text');
                if (!nameText) return;
                
                const displayName = nameText.textContent;
                if (!displayName) return;
                
                const displayNameLower = displayName.toLowerCase();
                
                // characterDataÏóêÏÑú Ìï¥Îãπ Ï∫êÎ¶≠ÌÑ∞ Ï∞æÍ∏∞
                const characterKey = sortedCharacters.find(name => 
                    window.characterData[name] && window.characterData[name].name === displayName
                );

                // Î≥ÑÏπ≠ Îß§Ïπ≠ ÌôïÏù∏
                const nicknameMatch = Object.entries(nicknameMap).find(([nickname, realName]) => 
                    nickname.toLowerCase().includes(searchValue) && realName === displayName
                );
                
                const shouldShow = searchValue === '' || 
                    (characterKey && characterKey.toLowerCase().includes(searchValue)) || 
                    displayNameLower.includes(searchValue) ||
                    nicknameMatch !== undefined;
                
                card.style.display = shouldShow ? 'block' : 'none';
                if (shouldShow) visibleCount++;
            });
            
            // Í≤ÄÏÉâ Í≤∞Í≥º Ïàò ÏóÖÎç∞Ïù¥Ìä∏
            if (searchCount) {
                const countText = window.i18nFilteredCount || 'Ï†ÑÏ≤¥';
                const countUnit = window.i18nCountUnit || 'Î™Ö';
                searchCount.textContent = `${countText} ${visibleCount}${countUnit}`;
            }
        }
    } // initializePageContent Ìï®Ïàò Ï¢ÖÎ£å
    
    // Î≤àÏó≠ ÏãúÏä§ÌÖú Ï†ÅÏö©
    async function applyTranslations() {
        const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';
        if (currentLang === 'kr') return;
        
        try {
            // Î≤àÏó≠ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            const translations = await TranslationLoader.loadTranslations('characters', currentLang);
            if (!translations) {
                console.warn('No translations found for', currentLang);
                return;
            }
            
            console.log('Applying translations for', currentLang, translations);
            
            // Ïπ¥Îìú ÏóÖÎç∞Ïù¥Ìä∏
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                const nameElement = card.querySelector('.name-text');
                if (!nameElement) return;
                
                const originalName = nameElement.textContent;
                const characterKey = Object.keys(characterData).find(key => 
                    characterData[key].name === originalName
                );
                
                if (characterKey && characterData[characterKey]) {
                    const char = characterData[characterKey];
                    
                    // Ïù¥Î¶Ñ Î≤àÏó≠ (name_en ÎòêÎäî name_jp ÏÇ¨Ïö©)
                    const translatedName = currentLang === 'en' ? char.name_en : char.name_jp;
                    if (translatedName) {
                        nameElement.textContent = translatedName;
                    }
                    
                    // ÏÜçÏÑ± ÏïÑÏù¥ÏΩò alt ÌÖçÏä§Ìä∏ Î≤àÏó≠
                    const elementImg = card.querySelector('.element-icon');
                    if (elementImg && translations.elements && translations.elements[char.element]) {
                        elementImg.alt = translations.elements[char.element];
                        elementImg.title = translations.elements[char.element];
                    }
                }
            });
            
            // ÌïÑÌÑ∞ Î†àÏù¥Î∏î Î≤àÏó≠
            updateFilterLabels(translations, currentLang);
            
            // Í≤ÄÏÉâ ÌîåÎ†àÏù¥Ïä§ÌôÄÎçî Î≤àÏó≠
            updateSearchPlaceholder(currentLang);
            
            // UI ÌÖçÏä§Ìä∏ Î≤àÏó≠
            updateUITexts(currentLang);
            
        } catch (error) {
            console.warn('Translation application failed:', error);
        }
    }
    
    // ÌïÑÌÑ∞ Î†àÏù¥Î∏î Î≤àÏó≠
    function updateFilterLabels(translations, lang) {
        if (!translations) return;
        
        // ÏÜçÏÑ± ÌïÑÌÑ∞ Î≤àÏó≠
        if (translations.elements) {
            const elementLabels = document.querySelectorAll('.filter-group:first-child .filter-options label span');
            elementLabels.forEach((span, index) => {
                const elementKey = span.textContent;
                if (translations.elements[elementKey]) {
                    span.textContent = translations.elements[elementKey];
                }
            });
        }
        
        // ÏßÅÏóÖ ÌïÑÌÑ∞ Î≤àÏó≠ 
        if (translations.positions) {
            const positionLabels = document.querySelectorAll('.filter-group:nth-child(2) .filter-options label');
            positionLabels.forEach(label => {
                const img = label.querySelector('img');
                if (img) {
                    const positionKey = img.alt;
                    if (translations.positions[positionKey]) {
                        img.alt = translations.positions[positionKey];
                        img.title = translations.positions[positionKey];
                    }
                }
            });
        }
        
        // ÌÉúÍ∑∏ ÌïÑÌÑ∞ Î≤àÏó≠
        if (translations.tags) {
            const tagLabels = document.querySelectorAll('.filter-group:last-child .filter-options label span');
            tagLabels.forEach(span => {
                const tagKey = span.textContent;
                if (translations.tags[tagKey]) {
                    span.textContent = translations.tags[tagKey];
                }
            });
        }
    }
    
    // Í≤ÄÏÉâ ÌîåÎ†àÏù¥Ïä§ÌôÄÎçî Î≤àÏó≠
    function updateSearchPlaceholder(lang) {
        const searchInput = document.getElementById('characterSearch');
        if (!searchInput) return;
        
        const placeholders = {
            'en': 'Search characters...',
            'jp': '„Ç≠„É£„É©„ÇØ„Çø„ÉºÊ§úÁ¥¢...'
        };
        
        if (placeholders[lang]) {
            searchInput.placeholder = placeholders[lang];
        }
    }
    
    // UI ÌÖçÏä§Ìä∏ Î≤àÏó≠
    function updateUITexts(lang) {
        if (lang === 'kr') return;
        
        // Í∏∞Ï°¥ i18n ÏãúÏä§ÌÖú ÌôúÏö©
        if (window.i18nData && window.i18nData[lang]) {
            const i18n = window.i18nData[lang];
            
            // ÌéòÏù¥ÏßÄ Ï†úÎ™©
            const pageTitle = document.getElementById('page-title');
            if (pageTitle && i18n.character_title) {
                pageTitle.textContent = i18n.character_title;
            }
            
            // Î∏åÎ†àÎìúÌÅ¨Îüº
            const navHome = document.getElementById('nav-home');
            const navCurrent = document.getElementById('nav-current');
            if (navHome && i18n.nav_home) navHome.textContent = i18n.nav_home;
            if (navCurrent && i18n.nav_character) navCurrent.textContent = i18n.nav_character;
            
            // ÌïÑÌÑ∞ Í∑∏Î£π Ï†úÎ™©Îì§
            const filterGroups = document.querySelectorAll('.filter-group h3');
            const filterTitles = [i18n.filter_element, i18n.filter_position, i18n.filter_type, i18n.filter_tag];
            filterGroups.forEach((title, index) => {
                if (filterTitles[index]) {
                    title.textContent = filterTitles[index];
                }
            });
        }
    }
    
    // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî (ÌÜµÌï©Îêú Ï¥àÍ∏∞Ìôî Ìï®Ïàò)
    document.addEventListener('DOMContentLoaded', async () => {
        console.log('DOMContentLoaded event fired');
        
        // Í∏∞Î≥∏ Ï¥àÍ∏∞Ìôî ÏûëÏóÖ
        Navigation.load('character'); // nav active
        VersionChecker.check();
        
        // SEO ÏÑ§Ï†ï ÏóÖÎç∞Ïù¥Ìä∏
        updateSEOContent();
        
        // Ïñ∏Ïñ¥ ÎùºÏö∞ÌÑ∞ Ï¥àÍ∏∞Ìôî Î∞è ÏΩòÌÖêÏ∏† ÏóÖÎç∞Ïù¥Ìä∏
        if (typeof LanguageRouter !== 'undefined') {
            // Ïù¥ÎØ∏ Ïñ∏Ïñ¥ ÌååÎùºÎØ∏ÌÑ∞Í∞Ä ÏûàÍ±∞ÎÇò ÏßÅÏ†ë Ï†ëÍ∑ºÌïú Í≤ΩÏö∞ Î¶¨Îã§Ïù¥Î†âÏÖò ÏóÜÏù¥ ÏßÑÌñâ
            const hasLangParam = window.location.search.includes('lang=');
            if (hasLangParam) {
                // Ïñ∏Ïñ¥ ÌååÎùºÎØ∏ÌÑ∞Í∞Ä ÏûàÏúºÎ©¥ Î∞îÎ°ú ÏΩòÌÖêÏ∏† Î°úÎìú
                updateLanguageContent().then(async () => {
                    await initializePageContent();
                });
            } else {
                // Ïñ∏Ïñ¥ ÌååÎùºÎØ∏ÌÑ∞Í∞Ä ÏóÜÏúºÎ©¥ Í∏∞Î≥∏ ÌïúÍµ≠Ïñ¥Î°ú ÏÑ§Ï†ïÌïòÍ≥† ÏΩòÌÖêÏ∏† Î°úÎìú
                const currentUrl = new URL(window.location);
                currentUrl.searchParams.set('lang', 'kr');
                window.history.replaceState({}, '', currentUrl);
                
                updateLanguageContent().then(async () => {
                    await initializePageContent();
                });
            }
        } else {
            updateLanguageContent();
            await initializePageContent();
        }
    });
    
    // Ï∂îÍ∞Ä ÏïàÏ†ÑÏû•Ïπò: window.onloadÏóêÏÑúÎèÑ Ï≤¥ÌÅ¨
    window.addEventListener('load', async () => {
        console.log('Window load event fired');
        if (!isInitialized) {
            console.log('Page not initialized yet, running initialization...');
            await initializePageContent();
        } else {
            console.log('Page already initialized, skipping...');
        }
    });
    
</script> 