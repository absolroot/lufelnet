---
layout: default
custom_css: [persona]
custom_js: [tooltip]
custom_data: [tooltip.js, wonder/skills.js]
permalink: /persona/
redirect_from:
- /kr/persona/
- /kr/persona/index.html
language: kr
title : ì£¼ìš” í˜ë¥´ì†Œë‚˜ - í˜ë¥´ì†Œë‚˜5 ë” íŒ¬í…€ X ë£¨í˜ë¥´ë„·
description: í˜ë¥´ì†Œë‚˜5 ë” íŒ¬í…€ Xì˜ ì£¼ìš” í˜ë¥´ì†Œë‚˜ ì •ë³´
alternate_urls:
en: /persona/?lang=en
jp: /persona/?lang=jp
---

{% if page.alternate_urls %}
<link rel="alternate" hreflang="ko" href="{{ site.url }}/persona/" />
{% for lang in page.alternate_urls %}
<link rel="alternate" hreflang="{{ lang[0] }}" href="{{ site.url }}{{ lang[1] }}" />
{% endfor %}
<link rel="alternate" hreflang="x-default" href="{{ site.url }}/persona/" />
{% endif %}

<div class="main-wrapper">
    <link rel="stylesheet" href="{{ site.baseurl }}/apps/persona/skillfrom.css?v={{ site.time | date: '%s' }}">
    <script src="{{ site.baseurl }}/assets/js/ad-injector.js?v={{ site.time | date: '%s' }}"></script>
    <!-- í˜ë¥´ì†Œë‚˜ ìˆœì„œ ë° ë¡œë” -->
    <script src="{{ site.baseurl }}/data/persona/order.js?v={{ site.time | date: '%s' }}"></script>
    <script src="{{ site.baseurl }}/assets/js/persona-loader.js?v={{ site.time | date: '%s' }}"></script>
    <script src="{{ site.baseurl }}/apps/persona/getfrom.js?v={{ site.time | date: '%s' }}"></script>
    <!-- ì–¸ì–´ ì•ˆë‚´ ë©”ì‹œì§€ -->
    <!--
    <div id="language-notice" class="language-notice" style="display: none;">
        <p id="language-notice-text"></p>
    </div>-->

    <div class="navigation-path">
        <script>document.write(`<a href="../../?v=${APP_VERSION}" id="nav-home">í™ˆ</a>`);</script>
        <span class="separator">/</span>
        <span class="current-page" id="nav-current">í˜ë¥´ì†Œë‚˜</span>
    </div>
    <div class="header-container">
        <h1 id="page-title">ì£¼ìš” í˜ë¥´ì†Œë‚˜</h1>
    </div>

    <!-- Filter section -->
    <div class="filter-section">
        <div class="filter-header">
            <button class="filter-toggle-btn">
                <img src="{{ site.baseurl }}/assets/img/character-cards/filter.png" alt="í•„í„°" />
                <span></span>
            </button>
            <button class="filter-reset-btn" style="display: none;">
                <img src="{{ site.baseurl }}/assets/img/character-cards/reset.png" alt="ì´ˆê¸°í™”" />
            </button>
        </div>

        <div class="filter-content" style="display: none;">
            <!-- Element filter -->
            <div class="filter-group">
                <h3>ì†ì„±</h3>
                <div class="filter-options">
                    <label>
                        <input type="checkbox" name="element" value="ë¬¼ë¦¬">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì†ì„±_ë¬¼ë¦¬.png" alt="ë¬¼ë¦¬">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ì´ê²©">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì†ì„±_ì´ê²©.png" alt="ì´ê²©">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="í™”ì—¼">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì†ì„±_í™”ì—¼.png" alt="í™”ì—¼">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ë¹™ê²°">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì†ì„±_ë¹™ê²°.png" alt="ë¹™ê²°">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ì „ê²©">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì†ì„±_ì „ê²©.png" alt="ì „ê²©">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ì§ˆí’">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì†ì„±_ì§ˆí’.png" alt="ì§ˆí’">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ì—¼ë™">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì†ì„±_ì—¼ë™.png" alt="ì—¼ë™">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="í•µì—´">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì†ì„±_í•µì—´.png" alt="í•µì—´">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ì¶•ë³µ">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì†ì„±_ì¶•ë³µ.png" alt="ì¶•ë³µ">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ì£¼ì›">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì†ì„±_ì£¼ì›.png" alt="ì£¼ì›">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ë§ŒëŠ¥">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì†ì„±_ë§ŒëŠ¥.png" alt="ë§ŒëŠ¥">
                        <span></span>
                    </label>
                </div>
            </div>

            <!-- Position filter -->
            <div class="filter-group">
                <h3>ì§ì—…</h3>
                <div class="filter-options">
                    <label>
                        <input type="checkbox" name="position" value="ì§€ë°°">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì§ì—…_ì§€ë°°.png" alt="ì§€ë°°">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="ë°˜í•­">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì§ì—…_ë°˜í•­.png" alt="ë°˜í•­">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="ìš°ì›”">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì§ì—…_ìš°ì›”.png" alt="ìš°ì›”">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="êµ´ë³µ">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì§ì—…_êµ´ë³µ.png" alt="êµ´ë³µ">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="ë°©ìœ„">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì§ì—…_ë°©ìœ„.png" alt="ë°©ìœ„">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="êµ¬ì›">
                        <img src="{{ site.baseurl }}/assets/img/persona/ì§ì—…_êµ¬ì›.png" alt="êµ¬ì›">
                    </label>
                </div>
            </div>

            <!-- Rarity filter -->
            <div class="filter-group">
                <h3>í¬ê·€ë„</h3>
                <div class="filter-options">
                    <label>
                        <input type="checkbox" name="rarity" value="5" hidden>
                        <div class="star-container">
                            <img src="{{ site.baseurl }}/assets/img/persona/star5.webp" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/persona/star5.webp" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/persona/star5.webp" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/persona/star5.webp" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/persona/star5.webp" alt="â˜…">
                        </div>
                    </label>
                    <label>
                        <input type="checkbox" name="rarity" value="4" hidden>
                        <div class="star-container">
                            <img src="{{ site.baseurl }}/assets/img/persona/star4.webp" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/persona/star4.webp" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/persona/star4.webp" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/persona/star4.webp" alt="â˜…">
                        </div>
                    </label>
                    <label>
                        <input type="checkbox" name="rarity" value="3" hidden>
                        <div class="star-container">
                            <img src="{{ site.baseurl }}/assets/img/persona/star3.webp" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/persona/star3.webp" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/persona/star3.webp" alt="â˜…">
                        </div>
                    </label>
                </div>
            </div>

            <!-- Grade filter -->
            <div class="filter-group">
                <h3>ë“±ê¸‰</h3>
                <div class="filter-options">
                    <label>
                        <input type="checkbox" name="grade" value="1">
                        <img src="{{ site.baseurl }}/assets/img/persona/persona-grade1.webp" alt="1ë“±ê¸‰">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="grade" value="2">
                        <img src="{{ site.baseurl }}/assets/img/persona/persona-grade2.webp" alt="2ë“±ê¸‰">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="grade" value="3">
                        <img src="{{ site.baseurl }}/assets/img/persona/persona-grade3.webp" alt="3ë“±ê¸‰">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="grade" value="4">
                        <img src="{{ site.baseurl }}/assets/img/persona/persona-grade4.webp" alt="4ë“±ê¸‰">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="grade" value="5">
                        <img src="{{ site.baseurl }}/assets/img/persona/persona-grade5.webp" alt="5ë“±ê¸‰">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="grade" value="6">
                        <img src="{{ site.baseurl }}/assets/img/persona/persona-grade6.webp" alt="6ë“±ê¸‰">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="grade" value="7">
                        <img src="{{ site.baseurl }}/assets/img/persona/persona-grade7.webp" alt="7ë“±ê¸‰">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="grade" value="8">
                        <img src="{{ site.baseurl }}/assets/img/persona/persona-grade8.webp" alt="8ë“±ê¸‰">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="grade" value="9">
                        <img src="{{ site.baseurl }}/assets/img/persona/persona-grade9.webp" alt="9ë“±ê¸‰">
                        <span></span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- Separator line -->
    <div class="separator-line"></div>

    <!-- Search section below filter section -->
    <div class="search-section">
        <div class="search-container">
            <div class="search-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z"
                        fill="rgba(255, 255, 255, 0.6)" />
                </svg>
            </div>
            <input type="text" id="personaSearch" placeholder="í˜ë¥´ì†Œë‚˜ ê²€ìƒ‰..." autocomplete="off">
            <div id="searchDropdown" class="search-dropdown"></div>
        </div>
        <div class="search-count">
            <span id="filteredCount">ì „ì²´ 0ê°œ</span>
        </div>
        <!-- Expand-all toggle -->
        <div class="expand-all-toggle">
            <input type="checkbox" id="expandAllToggle">
            <label for="expandAllToggle" id="expandAllLabel">ì „ì²´ í¼ì¹˜ê¸°</label>
        </div>
        
        <span class="skill-level-separator">|</span>
        <div class="skill-level-toggle">
            <span class="skill-level-label">ìŠ¤í‚¬ ë ˆë²¨ :</span>
            <div class="skill-level-buttons skill-level-buttons-global">
                <button type="button" class="skill-level-btn active" data-level="0">LV6</button>
                <button type="button" class="skill-level-btn" data-level="1">LV7</button>
                <button type="button" class="skill-level-btn" data-level="2">LV8</button>
                <button type="button" class="skill-level-btn" data-level="ALL">ALL</button>
            </div>
        </div>
        
        
    </div>

    <!-- Explain Container -->
    <div class="explain-container">
        <div class="explain-box">
            <div class="explain-section">
                <h4>ë³¸ëŠ¥ Â· ê³ ìœ  ìŠ¤í‚¬ Â· HIGHLIGHT</h4>
                <div class="priority-examples">
                    <div class="priority-label">ì¤‘ìš”ë„ :</div>
                    <div class="priority-item">
                        <div class="priority-box high"></div>
                        <span>ìƒ</span>
                    </div>
                    <div class="priority-item">
                        <div class="priority-box medium"></div>
                        <span>ì¤‘</span>
                    </div>
                    <div class="priority-item">
                        <div class="priority-box low"></div>
                        <span>í•˜</span>
                    </div>
                </div>
            </div>
            <div class="explain-section">
                <h4>ì¶”ì²œ ìŠ¤í‚¬</h4>
                <div class="priority-examples">
                    <div class="priority-label">ìš°ì„ ìˆœìœ„ :</div>
                    <div class="priority-item">
                        <div class="priority-text high" data-priority-text="high">ë†’ìŒ</div>
                    </div>
                    <div class="priority-item">
                        <div class="priority-text medium" data-priority-text="normal">ì¼ë°˜</div>

                    </div>
                    <div class="priority-item">
                        <div class="priority-text low" data-priority-text="low">ë‚®ìŒ</div>
                    </div>
                    <div class="priority-item">
                        <div class="priority-text extra-low" data-priority-text="very-low">ë§¤ìš° ë‚®ìŒ</div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- ì¹´ë“œ ë¦¬ìŠ¤íŠ¸ ìœ„ì— ì§ì ‘ ì‚½ì… -->
    <style>
        /*
        .reveal-ad-button {
            background-color: #221c1c;
        }

        @media (max-width: 1200px) {
            .ad-container {
                width: 100% !important;
                padding: 0px 0px !important;
                margin-top: 0px !important;
            }

            ins.adsbygoogle[data-side-rail-status="displayed"] {
                display: none !important;
            }

            .adsbygoogle {
                padding-bottom: 0 !important;
                background: transparent !important;
            }
        }*/

        /* ì„±ëŠ¥ ìµœì í™” ìŠ¤íƒ€ì¼ */
        .persona-detail-container {
            /* GPU ê°€ì† í™œì„±í™” */
            transform: translateZ(0);
            backface-visibility: hidden;
            will-change: auto;

            /* íŠ¸ëœì§€ì…˜ ë¹„í™œì„±í™”ë¡œ ì„±ëŠ¥ í–¥ìƒ */
            transition: none !important;
            /* í™”ë©´ ë°– ì½˜í…ì¸  ì§€ì—° ë Œë”ë§ ë° ë ˆì´ì•„ì›ƒ ê²©ë¦¬ */
            content-visibility: auto;
            contain-intrinsic-size: 520px;
            /* ì¹´ë“œ ëŒ€ëµ ë†’ì´ íŒíŠ¸: ì‹¤ì œ ë Œë” í›„ êµì •ë¨ */
            contain: content;
        }

        .persona-img,
        .card-background,
        .cover-star {
            /* ì´ë¯¸ì§€ ë Œë”ë§ ìµœì í™” */
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
        }

        /* ìˆ¨ê¹€ ì²˜ë¦¬ëœ ìš”ì†Œë“¤ì˜ ë ˆì´ì•„ì›ƒ ìµœì í™” */
        .persona-detail-container[style*="position: absolute"] {
            left: -9999px !important;
            top: -9999px !important;
            z-index: -1;
        }

        /* ìŠ¤í¬ë¡¤ ì„±ëŠ¥ ìµœì í™” */
        .persona-cards {
            contain: layout style paint;
            overflow-anchor: none;
            /* 8ì—´ ê·¸ë¦¬ë“œ ë°°ì¹˜ */
            display: grid;
            grid-template-columns: repeat(8, minmax(0, 1fr));
            /* Define gap vars so we can compensate around grid-break */
            --row-gap: 16px;
            --col-gap: 24px;
            gap: var(--row-gap) var(--col-gap);
        }

        /* ë°˜ì‘í˜• ì—´ ìˆ˜ ì¡°ì • */
        @media (max-width: 1440px) {
            .persona-cards {
                grid-template-columns: repeat(6, minmax(0, 1fr));
            }
        }

        @media (max-width: 768px) {
            .persona-cards {
                grid-template-columns: repeat(5, minmax(0, 1fr));
            }
        }

        @media (max-width: 660px) {
            .persona-cards {
                grid-template-columns: repeat(4, minmax(0, 1fr));
            }
        }

        @media (max-width: 1440px) {
            .persona-cards {
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }
        }

        @media (max-width: 450px) {
            .persona-cards {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }

        /* ì¹´ë“œ ì»¨í…Œì´ë„ˆ: ê¸°ë³¸ì€ 1ì—´ ì°¨ì§€, í™•ì¥ ì‹œ ì „í­ ì°¨ì§€ */
        .persona-detail-container {
            grid-column: span 1;
        }

        .persona-detail-container.expanded {
            grid-column: 1 / -1;
        }

        /* í™•ì¥ ìƒíƒœì¼ ë•Œ ë³„ë„ íŒ¨ë”©ì„ ì ìš©í•  ìˆ˜ ìˆë„ë¡ í›… ì œê³µ */
        @media(min-width:1440px) {
            .persona-detail-container {
                padding: 0px;
                background: var(--card-background)
            }

            .persona-detail-container.active {
                padding: 20px;
                background: var(--card-background);
                border-bottom: solid 3px rgb(115 0 0);
            }
        }

        @media(max-width:1440px) {
            .persona-detail-container {
                padding: 20px 0 0 0px;
                background: var(--card-background)
            }

            .persona-detail-container.active {
                padding: 20px 10px 10px 10px;
                background: var(--card-background);
                border-bottom: solid 3px rgb(115 0 0);
            }
        }

        /* ê¸°ë³¸(ì¶•ì†Œ) ìƒíƒœì—ì„  ì •ë³´ ì„¹ì…˜ ìˆ¨ê¹€, ì¹´ë“œì™€ ì´ë¦„ë§Œ ë…¸ì¶œ */
        .persona-detail-container .persona-info-section {
            display: none;
        }

        .persona-detail-container.expanded .persona-info-section,
        .expand-all .persona-detail-container .persona-info-section {
            display: flex;
        }


        .persona-detail-container .persona-header-info {
            margin-top: 8px;
        }

        /* ì¹´ë“œ í•˜ë‹¨ ì´ë¦„ ìº¡ì…˜ (ì¶•ì†Œ ëª¨ë“œì—ì„œ í‘œì‹œ) */
        .persona-detail-container .persona-name {
            margin-top: 10px;
            margin-bottom: 10px;
            text-align: center;
            font-weight: 500;
            font-size: 13px;
            color: EEEEEE;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* expand-all ì‹œ ì „í­ í™•ì¥ */
        .expand-all .persona-detail-container {
            grid-column: 1 / -1;
        }

        .expand-all-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .expand-all-toggle input {
            width: auto;
            padding: 0;
            border: 0;
            background: transparent;
            color: inherit;
            appearance: auto
        }

        .expand-all-toggle label {
            font-size: 12px;
            opacity: .9
        }

        @media screen and (max-width: 768px) {
            .expand-all-toggle {
                display: none;
            }
        }

        /* ê´‘ê³ ëŠ” ê·¸ë¦¬ë“œì—ì„œ í•­ìƒ ì „í­ ì‚¬ìš© */
        .persona-cards .ad-container {
            grid-column: 1 / -1;
        }

        /* grid-breakëŠ” ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. */

        /* Hide name caption when active (expanded styling) */
        .persona-detail-container.active .persona-card-section .persona-name {
            display: none;
        }

        /* Acquisition (íšë“ì²˜) section */
        .persona-acq-info {
            padding: 12px 16px 12px 16px;
            background: rgba(0, 0, 0, 0.15);
            border-radius: 8px;
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .persona-acq-info .acq-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
        }

        .persona-acq-info .acq-header h3 {
            font-size: 13px;
            margin: 0;
        }

        .persona-acq-info .acq-detail {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #ddd;
            border-radius: 6px;
            padding: 2px 6px;
            font-size: 11px;
            cursor: pointer;
        }

        .persona-acq-info .acq-body {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .persona-acq-info .acq-row {
            display: flex;
            align-items: center;
            gap: 6px;
            flex-wrap: wrap;
        }

        .persona-acq-info .acq-icon {
            width: 22px;
            height: 22px;
            object-fit: contain;
        }

        .persona-acq-info .acq-plus {
            opacity: .8;
            padding: 0 2px;
        }

        .persona-acq-info .acq-text {
            font-size: 12px;
            opacity: .9;
        }

        .persona-acq-info .acq-emblem {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .persona-acq-info .acq-emblem-num {
            font-size: 12px;
            color: #ffd54f;
        }
    </style>

    <!-- Persona card container -->
    <div class="persona-cards drag-me" id="personaCards">
        <!-- Dynamically generated by JavaScript -->
    </div>

    <!-- ê´‘ê³  -->
    <!--
    <div class="ads-container responsive-padding">
        <ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-gc+3n+7a-ag-4h"
            data-ad-client="ca-pub-5862324369257695" data-ad-slot="5373524213"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    </div>

    <div id="ad-unit-bottom" class="AD-bottom"
        style="margin-top: 24px; text-align: center; align-items: center; display: flex; justify-content: center;">
        <ins class="adsbygoogle" style="display:inline-block;width:970px;height:90px"
            data-ad-client="ca-pub-5862324369257695" data-ad-slot="9244892982"></ins>
    </div>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    <div style="height: 12px;"></div>
    
    <style>
        @media (max-width: 1440px) {
            .AD-bottom {
                display: none !important;
            }
        }

        @media (min-width: 1440px) {
            .ads-container {
                display: none !important;
            }
        }

        .responsive-padding {
            margin: 20px 20px 20px 0;
            padding: 0 0;
        }

        @media (max-width: 1200px) {
            .responsive-padding {
                margin: 20px 0 0px 0;
                padding: 0;
            }
        }
    </style>
    -->
</div>


</div>





<script>
    // ë‹¤êµ­ì–´ ì§€ì› í•¨ìˆ˜
    async function updateLanguageContent() {
        const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';

        // ë‹¤êµ­ì–´ ë°ì´í„° ì •ì˜
        const i18nData = {
            kr: {
                language_notice: "",
                nav_home: "í™ˆ",
                nav_current: "í˜ë¥´ì†Œë‚˜",
                page_title: "ì£¼ìš” í˜ë¥´ì†Œë‚˜",
                filtered_count: "ì „ì²´",
                search_placeholder: "í˜ë¥´ì†Œë‚˜ ê²€ìƒ‰...",
                filter_element: "ì†ì„±",
                filter_position: "ì§ì—…",
                filter_rarity: "í¬ê·€ë„",
                filter_grade: "ë“±ê¸‰",
                count_unit: "ê°œ",
                skill_level_label: "ìŠ¤í‚¬ ë ˆë²¨ :"
            },
            en: {
                language_notice: "ğŸŒ Please let me know if you find an accurate translation.\nIt may contain content that hasn't been released yet.",
                nav_home: "Home",
                nav_current: "Personas",
                page_title: "Core Personas",
                filtered_count: "Total",
                search_placeholder: "Search personas...",
                filter_element: "Element",
                filter_position: "Position",
                filter_rarity: "Rarity",
                filter_grade: "Grade",
                count_unit: "",
                skill_level_label: "Skill Level :"
            },
            jp: {
                language_notice: "ğŸŒ æ­£ç¢ºãªç¿»è¨³ãŒè¦‹ã¤ã‹ã£ãŸå ´åˆã¯ã€ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚\nã¾ã ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ã„ãªã„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒå«ã¾ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚",
                nav_home: "ãƒ›ãƒ¼ãƒ ",
                nav_current: "ãƒšãƒ«ã‚½ãƒŠ",
                page_title: "ä¸»è¦ãƒšãƒ«ã‚½ãƒŠ",
                filtered_count: "å…¨ä½“",
                search_placeholder: "ãƒšãƒ«ã‚½ãƒŠæ¤œç´¢...",
                filter_element: "å±æ€§",
                filter_position: "è·æ¥­",
                filter_rarity: "ã‚¿ã‚¤ãƒ—",
                filter_grade: "ã‚°ãƒ¬ãƒ¼ãƒ‰",
                count_unit: "",
                skill_level_label: "ã‚¹ã‚­ãƒ«ãƒ¬ãƒ™ãƒ« :"
            }
        };

        const data = i18nData[currentLang];
        if (!data) return;

        // ì–¸ì–´ ì•ˆë‚´ ë©”ì‹œì§€
        if (currentLang !== 'kr') {
            const notice = document.getElementById('language-notice');
            const noticeText = document.getElementById('language-notice-text');
            if (notice && noticeText && data.language_notice) {
                noticeText.textContent = data.language_notice;
                notice.style.display = 'block';
            }
        }

        // ë„¤ë¹„ê²Œì´ì…˜ ë° ì œëª© ì—…ë°ì´íŠ¸
        const navHome = document.getElementById('nav-home');
        const navCurrent = document.getElementById('nav-current');
        const pageTitle = document.getElementById('page-title');
        const searchInput = document.getElementById('personaSearch');

        if (navHome) navHome.textContent = data.nav_home;
        if (navCurrent) navCurrent.textContent = data.nav_current;
        if (pageTitle) pageTitle.textContent = data.page_title;
        if (searchInput) searchInput.placeholder = data.search_placeholder;

        // í•„í„° ë¼ë²¨ ë²ˆì—­
        const filterLabels = document.querySelectorAll('.filter-group h3');
        if (filterLabels[0]) filterLabels[0].textContent = data.filter_element;
        if (filterLabels[1]) filterLabels[1].textContent = data.filter_position;
        if (filterLabels[2]) filterLabels[2].textContent = data.filter_rarity;
        if (filterLabels[3]) filterLabels[3].textContent = data.filter_grade;

        // ìŠ¤í‚¬ ë ˆë²¨ ë¼ë²¨ ë²ˆì—­
        const skillLevelLabel = document.querySelector('.skill-level-label');
        if (skillLevelLabel && data.skill_level_label) {
            skillLevelLabel.textContent = data.skill_level_label;
        }

        // í•„í„° ì¹´ìš´íŠ¸ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•œ ì „ì—­ ë³€ìˆ˜ ì„¤ì •
        window.i18nFilteredCount = data.filtered_count;
        window.i18nCountUnit = data.count_unit;

        // ì–¸ì–´ë³„ ì„¤ëª… ë°•ìŠ¤ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        updateExplainBoxTexts(currentLang);
    }

    // ì–¸ì–´ë³„ SEO ì„¤ì • í•¨ìˆ˜
    function updateSEOContent() {
        const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';

        const seoData = {
            'kr': {
                title: 'ì£¼ìš” í˜ë¥´ì†Œë‚˜ - í˜ë¥´ì†Œë‚˜5 ë” íŒ¬í…€ X',
                description: 'í˜ë¥´ì†Œë‚˜5 ë” íŒ¬í…€ Xì˜ ì£¼ìš” í˜ë¥´ì†Œë‚˜ ì •ë³´. ë³¸ëŠ¥, ê³ ìœ  ìŠ¤í‚¬, ì¶”ì²œ ìŠ¤í‚¬ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.'
            },
            'en': {
                title: 'Core Personas Build & Guide - Persona 5: The Phantom X',
                description: 'Core Persona information for Persona 5: The Phantom X. Check instinct, unique skills, and recommended skills.'
            },
            'jp': {
                title: 'ä¸»è¦ãƒšãƒ«ã‚½ãƒŠ æ”»ç•¥ - ãƒšãƒ«ã‚½ãƒŠ5 ã‚¶ãƒ»ãƒ•ã‚¡ãƒ³ãƒˆãƒ  X',
                description: 'ãƒšãƒ«ã‚½ãƒŠ5 ã‚¶ãƒ»ãƒ•ã‚¡ãƒ³ãƒˆãƒ  Xã®ä¸»è¦ãƒšãƒ«ã‚½ãƒŠæƒ…å ±ã€‚æœ¬èƒ½ã€å›ºæœ‰ã‚¹ã‚­ãƒ«ã€æ¨å¥¨ã‚¹ã‚­ãƒ«æƒ…å ±ã‚’ã”ç¢ºèªãã ã•ã„ã€‚'
            }
        };

        const currentSEO = seoData[currentLang] || seoData['kr'];

        // íƒ€ì´í‹€ ì—…ë°ì´íŠ¸
        document.title = currentSEO.title;

        // ë©”íƒ€ íƒœê·¸ ì—…ë°ì´íŠ¸
        const metaDescription = document.querySelector('meta[name="description"]');
        const ogTitle = document.querySelector('meta[property="og:title"]');
        const ogDescription = document.querySelector('meta[property="og:description"]');

        if (metaDescription) metaDescription.setAttribute('content', currentSEO.description);
        if (ogTitle) ogTitle.setAttribute('content', currentSEO.title);
        if (ogDescription) ogDescription.setAttribute('content', currentSEO.description);
    }



    // URLì—ì„œ ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ë¥¼ ê°€ì ¸ì™€ì„œ ê²€ìƒ‰ì„ ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜
    function handleSearchParam() {
        const urlParams = new URLSearchParams(window.location.search);
        const searchQuery = urlParams.get('search');
        //console.log("[DEBUG] search param:", searchQuery);

        if (searchQuery) {
            const searchInput = document.getElementById('personaSearch');
            //console.log("[DEBUG] searchInput:", searchInput);

            if (searchInput) {
                // URL ê¸°ë°˜ ê²€ìƒ‰ ì ìš© í”Œë˜ê·¸ ì„¤ì • (ìë™ í™•ì¥ ë° ë“œë¡­ë‹¤ìš´ ìˆ¨ê¹€ì€ ì´ ê²½ìš°ì—ë§Œ)
                window.isApplyingUrlSearch = true;
                searchInput.value = searchQuery;
                //console.log("[DEBUG] Dispatching input event");
                searchInput.dispatchEvent(new Event('input', { bubbles: true }));
                // ì´ˆê¸° íŒŒë¼ë¯¸í„° ì ìš© ì‹œ ìë™ì™„ì„± ë“œë¡­ë‹¤ìš´ì€ í‘œì‹œí•˜ì§€ ì•ŠìŒ
                const dropdown = document.getElementById('searchDropdown');
                if (dropdown) dropdown.style.display = 'none';
            }
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        Navigation.load('persona');
        VersionChecker.check();

        // SEO ì„¤ì • ì—…ë°ì´íŠ¸
        updateSEOContent();

        // ì–¸ì–´ ë¼ìš°í„° ì´ˆê¸°í™” ë° ì½˜í…ì¸  ì—…ë°ì´íŠ¸
        if (typeof LanguageRouter !== 'undefined') {
            // ì´ë¯¸ ì–¸ì–´ íŒŒë¼ë¯¸í„°ê°€ ìˆê±°ë‚˜ ì§ì ‘ ì ‘ê·¼í•œ ê²½ìš° ë¦¬ë‹¤ì´ë ‰ì…˜ ì—†ì´ ì§„í–‰
            const hasLangParam = window.location.search.includes('lang=');
            if (hasLangParam) {
                // ì–¸ì–´ íŒŒë¼ë¯¸í„°ê°€ ìˆìœ¼ë©´ ë°”ë¡œ ì½˜í…ì¸  ë¡œë“œ
                updateLanguageContent().then(() => {
                    const runInit = () => {
                        initializePageContent().then(() => {
                            // ê²€ìƒ‰ íŒŒë¼ë¯¸í„° ì²˜ë¦¬ (ì§§ì€ ì§€ì—° ì¶”ê°€)
                            setTimeout(handleSearchParam, 100);
                            // ì „ì—­ ìŠ¤í‚¬ ë ˆë²¨ ì„ íƒê¸° ì´ˆê¸°í™”
                            setupGlobalSkillLevelSelector();
                        });
                    };
                    if (typeof ensurePersonaFilesLoaded === 'function') {
                        ensurePersonaFilesLoaded(runInit);
                    } else {
                        runInit();
                    }
                });
            } else {
                // ì–¸ì–´ íŒŒë¼ë¯¸í„°ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ í•œêµ­ì–´ë¡œ ì„¤ì •í•˜ê³  ì½˜í…ì¸  ë¡œë“œ
                const currentUrl = new URL(window.location);
                currentUrl.searchParams.set('lang', 'kr');
                window.history.replaceState({}, '', currentUrl);

                updateLanguageContent().then(() => {
                    const runInit = () => {
                        initializePageContent().then(() => {
                            // ê²€ìƒ‰ íŒŒë¼ë¯¸í„° ì²˜ë¦¬ (ì§§ì€ ì§€ì—° ì¶”ê°€)
                            setTimeout(handleSearchParam, 100);
                            // ì „ì—­ ìŠ¤í‚¬ ë ˆë²¨ ì„ íƒê¸° ì´ˆê¸°í™”
                            setupGlobalSkillLevelSelector();
                        });
                    };
                    if (typeof ensurePersonaFilesLoaded === 'function') {
                        ensurePersonaFilesLoaded(runInit);
                    } else {
                        runInit();
                    }
                });
            }
        } else {
            updateLanguageContent().then(() => {
                const runInit = () => {
                    initializePageContent().then(() => {
                        // ê²€ìƒ‰ íŒŒë¼ë¯¸í„° ì²˜ë¦¬ (ì§§ì€ ì§€ì—° ì¶”ê°€)
                        setTimeout(handleSearchParam, 100);
                        // ì „ì—­ ìŠ¤í‚¬ ë ˆë²¨ ì„ íƒê¸° ì´ˆê¸°í™”
                        setupGlobalSkillLevelSelector();
                    });
                };
                if (typeof ensurePersonaFilesLoaded === 'function') {
                    ensurePersonaFilesLoaded(runInit);
                } else {
                    runInit();
                }
            });
        }
    });

    // ê³µìš©: LV6/LV7/LV8/ALL ë²„íŠ¼ìœ¼ë¡œ "/" êµ¬ë¶„ 3ë‹¨ ìˆ˜ì¹˜ë¥¼ í•„í„°ë§í•˜ëŠ” í—¬í¼
    function filterDescByLevel(originalText, levelIndex) {
        if (levelIndex === null || levelIndex === undefined) return originalText;
        // "150.0%/157.5%/165.0%" ë˜ëŠ” "1471/1854/2275" í˜•íƒœë¥¼ ê°œë³„ ê°’ìœ¼ë¡œ ì¹˜í™˜
        const tripleRegex = /(\d+(?:\.\d+)?)(%?)\/(\d+(?:\.\d+)?)(%?)\/(\d+(?:\.\d+)?)(%?)/g;
        return originalText.replace(tripleRegex, (match, n1, u1, n2, u2, n3, u3) => {
            const variants = [`${n1}${u1}`, `${n2}${u2}`, `${n3}${u3}`];
            return variants[levelIndex] || variants[0];
        });
    }

    async function initializePageContent() {
        const cardsContainer = document.getElementById('personaCards');

        // í˜„ì¬ ì–¸ì–´ í™•ì¸
        const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';

        // ìƒˆ ë°ì´í„°(window.personaFiles)ë§Œ ì‚¬ìš© (ê¸°ì¡´ persona.js ëŠ” ë” ì´ìƒ ì°¸ì¡°í•˜ì§€ ì•ŠìŒ)
        const personaSource = (typeof window !== 'undefined' && window.personaFiles)
            ? window.personaFiles
            : {};

        // order.js ì—ì„œ ë¡œë“œëœ ìˆœì„œ ì •ë³´
        const orderList = (typeof window !== 'undefined' && window.personaOrder)
            ? window.personaOrder
            : [];

        // ì „ì—­ ìŠ¤í‚¬ ë ˆë²¨ (0: LV6, 1: LV7, 2: LV8, null: ALL)
        let globalSkillLevel = 0;

        // ì–¸ì–´ë³„ ì„¤ëª… ë°•ìŠ¤ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        updateExplainBoxTexts(currentLang);

        // ì •ë ¬ëœ í˜ë¥´ì†Œë‚˜ ì´ë¦„ ëª©ë¡ êµ¬ì„±
        const allNames = Object.keys(personaSource);
        const inOrder = [];
        const remaining = new Set(allNames);

        orderList.forEach(name => {
            if (remaining.has(name)) {
                inOrder.push(name);
                remaining.delete(name);
            }
        });
        const tail = Array.from(remaining).sort(); // ë‚¨ì€ ì• ë“¤ì€ ì´ë¦„ìˆœìœ¼ë¡œ ë’¤ì—
        const sortedPersonas = inOrder.concat(tail);

        // Update initial count (ì •ë ¬ëœ ëª©ë¡ ê¸¸ì´ ê¸°ì¤€)
        const countText = window.i18nFilteredCount || 'ì „ì²´';
        const countUnit = window.i18nCountUnit !== undefined ? window.i18nCountUnit : (currentLang === 'kr' ? 'ê°œ' : '');
        document.getElementById('filteredCount').textContent = `${countText} ${sortedPersonas.length}${countUnit}`;
        // ëŒ€ëŸ‰ ë Œë”ë§ ìµœì í™”: ì²­í¬ ë‹¨ìœ„ë¡œ ë¶„í•  ë Œë”ë§í•˜ì—¬ ë©”ì¸ ìŠ¤ë ˆë“œ ì ìœ ë¥¼ ì¤„ì„
        const CHUNK_SIZE = 10;
        let currentIndex = 0;

        function renderChunk() {
            const fragment = document.createDocumentFragment();
            let processed = 0;
            while (processed < CHUNK_SIZE && currentIndex < sortedPersonas.length) {
                const personaName = sortedPersonas[currentIndex];
                const index = currentIndex;
                const detailContainer = document.createElement('div');
                detailContainer.className = 'persona-detail-container';
                // Add data attributes for filtering
                detailContainer.dataset.element = personaSource[personaName].element;
                detailContainer.dataset.position = personaSource[personaName].position;
                detailContainer.dataset.rarity = personaSource[personaName].star;
                detailContainer.dataset.name = personaName;  // Add data-name attribute for search
                detailContainer.dataset.grade = personaSource[personaName].grade;  // Add data-grade attribute for grade
                detailContainer.dataset.event = personaSource[personaName].event;
                detailContainer.dataset.wild_emblem_rainbow = personaSource[personaName].wild_emblem_rainbow;
                // Preserve original order for restoring after collapse
                detailContainer.dataset.order = String(index);

                // Left card image section
                const cardSection = document.createElement('div');
                cardSection.className = 'persona-card-section';

                // Insert existing card creation code here
                const card = document.createElement('div');
                card.className = 'card';
                card.dataset.element = personaSource[personaName].element;
                card.dataset.position = personaSource[personaName].position;
                card.dataset.rarity = personaSource[personaName].star;

                // Add card background with optimization
                const cardBg = document.createElement('img');
                cardBg.src = `{{ site.baseurl }}/assets/img/persona/persona-card-${personaSource[personaName].element}.webp`;
                cardBg.alt = "card background";
                cardBg.className = 'card-background';
                cardBg.loading = 'lazy';
                cardBg.decoding = 'async';

                // Persona image with optimized lazy loading
                const img = document.createElement('img');
                img.src = `{{ site.baseurl }}/assets/img/persona/${personaName}.webp`;
                img.alt = personaName;
                img.className = 'persona-img';
                img.loading = 'lazy';
                img.decoding = 'async';  // ë¹„ë™ê¸° ë””ì½”ë”©ìœ¼ë¡œ ë Œë”ë§ ì„±ëŠ¥ í–¥ìƒ

                // Add rarity cover
                const coverStar = document.createElement('img');
                coverStar.src = `{{ site.baseurl }}/assets/img/persona/persona-cover-star${personaSource[personaName].star}.webp`;
                coverStar.alt = "rarity cover";
                coverStar.className = 'cover-star';
                coverStar.loading = 'lazy';

                // Add remaining elements
                const positionContainer = document.createElement('div');
                positionContainer.className = 'position-container';

                const positionIcon = document.createElement('img');
                positionIcon.src = `{{ site.baseurl }}/assets/img/persona/ì§ì—…_${personaSource[personaName].position}.png`;
                positionIcon.alt = personaSource[personaName].position;
                positionIcon.className = 'position-icon';
                positionIcon.loading = 'lazy';
                positionIcon.decoding = 'async';

                const elementIcon = document.createElement('img');
                elementIcon.src = `{{ site.baseurl }}/assets/img/persona/ì†ì„±_${personaSource[personaName].element}.png`;
                elementIcon.alt = personaSource[personaName].element;
                elementIcon.className = 'element-icon';
                elementIcon.loading = 'lazy';
                elementIcon.decoding = 'async';

                positionContainer.appendChild(positionIcon);

                // Wild Emblem
                if (personaSource[personaName].wild_emblem_rainbow) {
                    const wildEmblem = document.createElement('img');
                    wildEmblem.src = `{{ site.baseurl }}/assets/img/persona/wild-emblem-rainbow.png`;
                    wildEmblem.alt = "wild emblem";
                    wildEmblem.className = 'wild-emblem';
                    wildEmblem.loading = 'lazy';
                    wildEmblem.decoding = 'async';
                    // attach to card so it can be absolutely positioned at top-right via CSS
                    card.appendChild(wildEmblem);
                }


                // Final assembly
                card.appendChild(cardBg);
                card.appendChild(img);
                card.appendChild(coverStar);
                card.appendChild(positionContainer);
                card.appendChild(elementIcon);

                cardSection.appendChild(card);

                // Right info section
                const infoSection = document.createElement('div');
                infoSection.className = 'persona-info-section';

                // ì–¸ì–´ë³„ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (ìƒˆ data/persona/* êµ¬ì¡° ìš°ì„ )
                const persona = personaSource[personaName];
                let displayName = personaName;
                let uniqueSkillName = persona.uniqueSkill?.name || '';
                // ìƒˆ êµ¬ì¡°(desc/desc_en/desc_jp) ìš°ì„ , ì—†ìœ¼ë©´ êµ¬ êµ¬ì¡°(effect/effect_en/effect_jp) ì‚¬ìš©
                let uniqueSkillEffect = persona.uniqueSkill?.desc || persona.uniqueSkill?.effect || '';
                let highlightEffect = persona.highlight?.desc || persona.highlight?.effect || '';
                let comment = persona.comment;

                // Instinct / Passive Skill ë³€í˜•(ì˜ˆ: ì—¬ëŸ¬ ë‹¨ê³„) ì§€ì›ì„ ìœ„í•œ ë°°ì—´
                const instinctVariants = [];

                // ìƒˆ êµ¬ì¡°: passive_skill ë°°ì—´ ê¸°ë°˜
                if (Array.isArray(persona.passive_skill) && persona.passive_skill.length > 0) {
                    persona.passive_skill.forEach((p) => {
                        if (!p) return;
                        let name = p.name;
                        let effects = p.desc;
                        const priority = typeof persona.passive_priority === 'number' ? persona.passive_priority : 0;

                        if (currentLang === 'en') {
                            name = p.name_en || name;
                            effects = p.desc_en || effects;
                        } else if (currentLang === 'jp') {
                            name = p.name_jp || name;
                            effects = p.desc_jp || effects;
                        }

                        let baseName = name;
                        let roman = '';
                        const m = name && name.match(/\s+([IVX]+)$/);
                        if (m) {
                            roman = m[1];
                            baseName = name.slice(0, m.index).trim();
                        }

                        instinctVariants.push({ name, baseName, roman, effects, priority });
                    });
                } else {
                    // êµ¬ êµ¬ì¡°: instinct / instinct2 ê¸°ë°˜ (fallback)
                    function pushLegacyInstinctVariant(src) {
                        if (!src) return;
                        let name = src.name;
                        let effects = src.effects;
                        let priority = src.priority;

                        if (currentLang === 'en') {
                            name = src.name_en || name;
                            effects = src.effects_en || effects;
                        } else if (currentLang === 'jp') {
                            name = src.name_jp || name;
                            effects = src.effects_jp || effects;
                        }

                        let baseName = name;
                        let roman = '';
                        const m = name && name.match(/\s+([IVX]+)$/);
                        if (m) {
                            roman = m[1];
                            baseName = name.slice(0, m.index).trim();
                        }

                        instinctVariants.push({ name, baseName, roman, effects, priority });
                    }

                    pushLegacyInstinctVariant(persona.instinct);
                    if (persona.instinct2) pushLegacyInstinctVariant(persona.instinct2);
                }

                // ì–¸ì–´ë³„ ì´ë¦„/ê¸°íƒ€ í…ìŠ¤íŠ¸ ë²ˆì—­
                if (currentLang === 'en') {
                    displayName = persona.name_en || personaName;
                    uniqueSkillName = persona.uniqueSkill?.name_en || persona.uniqueSkill?.name || uniqueSkillName;
                    uniqueSkillEffect =
                        persona.uniqueSkill?.desc_en ||
                        persona.uniqueSkill?.desc ||
                        persona.uniqueSkill?.effect_en ||
                        persona.uniqueSkill?.effect ||
                        uniqueSkillEffect;
                    highlightEffect =
                        persona.highlight?.desc_en ||
                        persona.highlight?.desc ||
                        persona.highlight?.effect_en ||
                        persona.highlight?.effect ||
                        highlightEffect;
                    comment = persona.comment_en || persona.comment;
                } else if (currentLang === 'jp') {
                    displayName = persona.name_jp || personaName;
                    uniqueSkillName = persona.uniqueSkill?.name_jp || persona.uniqueSkill?.name || uniqueSkillName;
                    uniqueSkillEffect =
                        persona.uniqueSkill?.desc_jp ||
                        persona.uniqueSkill?.desc ||
                        persona.uniqueSkill?.effect_jp ||
                        persona.uniqueSkill?.effect ||
                        uniqueSkillEffect;
                    highlightEffect =
                        persona.highlight?.desc_jp ||
                        persona.highlight?.desc ||
                        persona.highlight?.effect_jp ||
                        persona.highlight?.effect ||
                        highlightEffect;
                    comment = persona.comment_jp || persona.comment;
                }

                // Collapsed-mode name caption under the card
                const nameCaption = document.createElement('div');
                nameCaption.className = 'persona-name';
                nameCaption.textContent = displayName;

                // ë§Œì•½ persona_best ê°’ì´ true ì¼ê²½ìš° nameCaptionì— color ì ìš©
                if (personaSource[personaName].best_persona) {
                    nameCaption.style.color = 'rgb(255 109 122)';
                }
                cardSection.appendChild(nameCaption);

                // Name and grade
                const headerInfo = document.createElement('div');
                headerInfo.className = 'persona-header-info';

                headerInfo.innerHTML = `
            <h2>${displayName}</h2>
            <img class="persona-grade-img" src="{{ site.baseurl }}/assets/img/persona/persona-grade${personaSource[personaName].grade}.webp" alt="Grade ${personaSource[personaName].grade}">
            `;


                // Instinct / Passive Skill (ë³µìˆ˜ ë³€í˜• ì§€ì›)
                const instinctInfo = document.createElement('div');
                instinctInfo.className = 'persona-instinct-info';
                // ê¸°ë³¸ priority: ìƒˆ êµ¬ì¡°ì˜ passive_priority ìš°ì„ , ì—†ìœ¼ë©´ legacy instinct.priority ì‚¬ìš©
                instinctInfo.dataset.priority =
                    typeof persona.passive_priority === 'number'
                        ? persona.passive_priority
                        : (persona.instinct ? (persona.instinct.priority || 0) : 0);

                // í—¤ë”: ì´ë¦„ + ë¡œë§ˆì ë²„íŠ¼
                const instinctHeader = document.createElement('div');
                instinctHeader.className = 'persona-instinct-header';

                const instinctTitle = document.createElement('h3');
                const baseTitle = instinctVariants[0]
                    ? (instinctVariants[0].baseName || instinctVariants[0].name)
                    : (persona.instinct && persona.instinct.name) || '';
                instinctTitle.textContent = baseTitle;
                instinctHeader.appendChild(instinctTitle);

                // ê¸°ë³¸ í™œì„± ì¸ìŠ¤íŒ…íŠ¸ ì¸ë±ìŠ¤: ê°€ì¥ ë§ˆì§€ë§‰(ìµœê³  ë‹¨ê³„) ë³€í˜•
                let activeInstinctIndex = instinctVariants.length > 0 ? (instinctVariants.length - 1) : 0;
                let instinctButtonsWrap = null;

                if (instinctVariants.length > 1) {
                    instinctButtonsWrap = document.createElement('div');
                    instinctButtonsWrap.className = 'instinct-variant-buttons';

                    instinctVariants.forEach((variant, idx) => {
                        const btn = document.createElement('button');
                        btn.type = 'button';
                        btn.className = 'instinct-variant-btn' + (idx === activeInstinctIndex ? ' active' : '');
                        // 0 ë‹¨ê³„ëŠ” "0", ì´í›„ëŠ” ë¡œë§ˆì(I, II, III ...) í˜¹ì€ ìˆ«ì
                        if (idx === 0) {
                            btn.textContent = '0';
                        } else if (variant.roman) {
                            btn.textContent = variant.roman;
                        } else {
                            // ê°„ë‹¨í•œ ë¡œë§ˆì ë³€í™˜ (1~9 ë²”ìœ„ ê°€ì •)
                            const intToRoman = (n) => {
                                const map = [
                                    ['IX', 9],
                                    ['V', 5],
                                    ['IV', 4],
                                    ['I', 1],
                                ];
                                let remain = n;
                                let out = '';
                                for (const [sym, val] of map) {
                                    while (remain >= val) {
                                        out += sym;
                                        remain -= val;
                                    }
                                }
                                return out || String(n);
                            };
                            btn.textContent = intToRoman(idx);
                        }
                        btn.setAttribute('aria-pressed', idx === activeInstinctIndex ? 'true' : 'false');
                        btn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            if (activeInstinctIndex === idx) return;
                            activeInstinctIndex = idx;
                            // ë²„íŠ¼ active ìƒíƒœ ê°±ì‹ 
                            instinctButtonsWrap.querySelectorAll('.instinct-variant-btn').forEach((b, i) => {
                                const isActive = i === activeInstinctIndex;
                                b.classList.toggle('active', isActive);
                                b.setAttribute('aria-pressed', isActive ? 'true' : 'false');
                            });
                            // íš¨ê³¼ í…ìŠ¤íŠ¸ ë° priority ê°±ì‹ 
                            updateInstinctEffect();
                        });
                        instinctButtonsWrap.appendChild(btn);
                    });

                    instinctHeader.appendChild(instinctButtonsWrap);
                }

                instinctInfo.appendChild(instinctHeader);

                // íš¨ê³¼ í…ìŠ¤íŠ¸ ì˜ì—­
                const instinctEffectP = document.createElement('p');
                instinctEffectP.className = 'instinct-text';

                function updateInstinctEffect() {
                    const current = instinctVariants[activeInstinctIndex] || instinctVariants[0];
                    if (!current) return;
                    const text = Array.isArray(current.effects) ? current.effects.join('\n') : current.effects;
                    instinctEffectP.textContent = text || '';
                    // ì œëª©ë„ í˜„ì¬ ë³€í˜•ì˜ ì´ë¦„ìœ¼ë¡œ ê°±ì‹ 
                    instinctTitle.textContent = current.baseName || current.name || instinctTitle.textContent;
                    if (typeof current.priority !== 'undefined') {
                        instinctInfo.dataset.priority = current.priority;
                    }
                    // ìˆ«ì í•˜ì´ë¼ì´íŠ¸ ë° íˆ´íŒ ì¬ì ìš©
                    if (typeof addTooltips === 'function') {
                        try { addTooltips(); } catch (_) { /* noop */ }
                    }
                }

                // ì´ˆê¸° íš¨ê³¼ ë Œë”ë§
                updateInstinctEffect();
                instinctInfo.appendChild(instinctEffectP);

                // Container for unique skill and highlight
                const skillContainer = document.createElement('div');
                skillContainer.className = 'skill-highlight-container';

                // Unique skill
                const uniqueSkillInfo = document.createElement('div');
                uniqueSkillInfo.className = 'persona-unique-skill-info';
                uniqueSkillInfo.dataset.priority = personaSource[personaName].uniqueSkill.priority;
                // Use global icon when language is en/jp and icon_gl exists
                const uniqueSkillIconName = (currentLang === 'en' || currentLang === 'jp')
                    ? (personaSource[personaName].uniqueSkill.icon_gl || personaSource[personaName].uniqueSkill.icon)
                    : personaSource[personaName].uniqueSkill.icon;

                const uniqueHeader = document.createElement('div');
                uniqueHeader.className = 'persona-unique-header';
                const uniqueTitle = document.createElement('h3');
                const uniqueIcon = document.createElement('img');
                uniqueIcon.src = `{{ site.baseurl }}/assets/img/persona/ì†ì„±_${uniqueSkillIconName}.png`;
                uniqueIcon.alt = "Skill Element";
                uniqueIcon.className = 'skill-type-icon';
                uniqueTitle.appendChild(uniqueIcon);
                uniqueTitle.appendChild(document.createTextNode(` ${uniqueSkillName}`));
                uniqueHeader.appendChild(uniqueTitle);

                const uniqueDescP = document.createElement('p');
                // ì›ë¬¸ ì €ì¥
                uniqueDescP.dataset.originalText = uniqueSkillEffect;
                // ì „ì—­ ìŠ¤í‚¬ ë ˆë²¨ì´ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´ ì´ˆê¸° ë Œë”ì—ì„œë„ ë°”ë¡œ í•„í„° ì ìš©
                if (typeof globalSkillLevel === 'number') {
                    uniqueDescP.textContent = filterDescByLevel(uniqueSkillEffect, globalSkillLevel);
                } else {
                    uniqueDescP.textContent = uniqueSkillEffect;
                }

                uniqueSkillInfo.appendChild(uniqueHeader);
                uniqueSkillInfo.appendChild(uniqueDescP);

                // Highlight - ì–¸ì–´ë³„ ë¼ë²¨ ì ìš©
                const highlightLabels = {
                    'kr': 'HIGHLIGHT',
                    'en': 'HIGHLIGHT',
                    'jp': 'HIGHLIGHT'
                };
                const highlightLabel = highlightLabels[currentLang] || 'HIGHLIGHT';

                const highlightInfo = document.createElement('div');
                highlightInfo.className = 'persona-highlight-info';
                highlightInfo.dataset.priority = personaSource[personaName].highlight.priority;

                const highlightHeader = document.createElement('div');
                highlightHeader.className = 'persona-highlight-header';
                const highlightTitle = document.createElement('h3');
                highlightTitle.textContent = highlightLabel;
                highlightHeader.appendChild(highlightTitle);

                const highlightDescP = document.createElement('p');
                // ì›ë¬¸ ì €ì¥
                highlightDescP.dataset.originalText = highlightEffect;
                // ì „ì—­ ìŠ¤í‚¬ ë ˆë²¨ì´ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´ ì´ˆê¸° ë Œë”ì—ì„œë„ ë°”ë¡œ í•„í„° ì ìš©
                if (typeof globalSkillLevel === 'number') {
                    highlightDescP.textContent = filterDescByLevel(highlightEffect, globalSkillLevel);
                } else {
                    highlightDescP.textContent = highlightEffect;
                }

                highlightInfo.appendChild(highlightHeader);
                highlightInfo.appendChild(highlightDescP);

                // Add to container
                skillContainer.appendChild(uniqueSkillInfo);
                skillContainer.appendChild(highlightInfo);

                // Add elements to info section
                infoSection.appendChild(headerInfo);
                // Insert Acquisition section between header and instinct (if script is loaded)
                try {
                    if (window.Acquisition && typeof window.Acquisition.renderInto === 'function') {
                        window.Acquisition.renderInto(infoSection, personaName);
                    }
                } catch (e) { /* noop */ }
                infoSection.appendChild(instinctInfo);
                infoSection.appendChild(skillContainer);  // Add container instead of individual elements

                // Recommended skill list - ì–¸ì–´ë³„ ë¼ë²¨ ì ìš©
                if (personaSource[personaName].recommendSkill && personaSource[personaName].recommendSkill.length > 0 && personaSource[personaName].recommendSkill[0].name) {
                    const recommendedSkillLabels = {
                        'kr': 'ì¶”ì²œ ìŠ¤í‚¬',
                        'en': 'Recommended Skills',
                        'jp': 'æ¨å¥¨ã‚¹ã‚­ãƒ«'
                    };
                    const recommendedSkillLabel = recommendedSkillLabels[currentLang] || 'ì¶”ì²œ ìŠ¤í‚¬';

                    const recommendedSkills = document.createElement('div');
                    recommendedSkills.className = 'persona-recommended-skills';
                    recommendedSkills.innerHTML = `
                    <h3>${recommendedSkillLabel}</h3>
                    <ul>
                        ${personaSource[personaName].recommendSkill.map(skill => {
                        const skillInfo = personaSkillList[skill.name];
                        if (!skillInfo) return ''; // Skip if skill info not found

                        // ìŠ¤í‚¬ ì´ë¦„ê³¼ ì„¤ëª…ë„ ì–¸ì–´ë³„ë¡œ ë²ˆì—­ (í˜„ì¬ëŠ” í•œêµ­ì–´ë§Œ ìˆìœ¼ë¯€ë¡œ ê·¸ëŒ€ë¡œ ì‚¬ìš©)
                        let skillName = skill.name;
                        let skillDescription = skillInfo.description;

                        // ì–¸ì–´ë³„ ìŠ¤í‚¬ ì´ë¦„ê³¼ ì„¤ëª… ì ìš©
                        if (currentLang === 'en') {
                            skillName = skillInfo.name_en || skill.name;
                            skillDescription = skillInfo.description_en || skillInfo.description;
                        } else if (currentLang === 'jp') {
                            skillName = skillInfo.name_jp || skill.name;
                            skillDescription = skillInfo.description_jp || skillInfo.description;
                        }
                        // Choose icon based on language (use icon_gl for en/jp when available)
                        const iconName = (currentLang === 'en' || currentLang === 'jp')
                            ? (skillInfo.icon_gl || skillInfo.icon)
                            : skillInfo.icon;

                        const isPassive = skillInfo.type === "íŒ¨ì‹œë¸Œ";

                        return `
                                <li data-priority="${skill.priority}">
                                    <div class="skill-info">
                                        <div class="skill-name-container">
                                            <img src="{{ site.baseurl }}/assets/img/persona/ì†ì„±_${iconName}.png" alt="${iconName}" class="skill-icon">
                                            <span class="skill-name" data-skill-kor-full="${skill.name}">${skillName}</span>
                                        </div>
                                        <span class="skill-description" ${isPassive ? 'data-passive="true"' : ''}>${skillDescription}</span>
                                    </div>
                                </li>
                            `;
                    }).join('')}
                    </ul>
                `;
                    infoSection.appendChild(recommendedSkills);

                    // ì¶”ì²œ ìŠ¤í‚¬ ì„¤ëª…ì—ë„ ìŠ¤í‚¬ ë ˆë²¨ í† ê¸€(6/7/8/ALL) ì ìš©ì„ ìœ„í•´
                    // ì›ë³¸ í…ìŠ¤íŠ¸ë¥¼ data-original-text ë¡œ ì €ì¥í•˜ê³ ,
                    // ì´ˆê¸° ë Œë” ì‹œ í˜„ì¬ globalSkillLevel ì´ ìˆ«ìë¼ë©´ í•„í„°ë¥¼ í•œ ë²ˆ ì ìš©í•œë‹¤.
                    const recommendedDescSpans = recommendedSkills.querySelectorAll('.skill-description');
                    recommendedDescSpans.forEach((span) => {
                        // type ì´ "íŒ¨ì‹œë¸Œ" ì¸ ìŠ¤í‚¬ì€ ìŠ¤í‚¬ ë ˆë²¨ í† ê¸€ì˜ ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ”ë‹¤.
                        if (span.dataset.passive === 'true') return;
                        const original = span.textContent || '';
                        span.dataset.originalText = original;
                        if (typeof globalSkillLevel === 'number') {
                            span.textContent = filterDescByLevel(original, globalSkillLevel);
                        }
                    });
                }

                // Comment
                if (comment && comment.trim() !== '') {
                    const commentDiv = document.createElement('div');
                    commentDiv.className = 'persona-comment';
                    commentDiv.innerHTML = `
                    <div class="comment-container">
                        <span class="comment-icon">ğŸ’¬</span>
                        <p>${comment}</p>
                    </div>
                `;
                    infoSection.appendChild(commentDiv);
                }

                // Add sections to container
                detailContainer.appendChild(cardSection);
                detailContainer.appendChild(infoSection);

                fragment.appendChild(detailContainer);
                currentIndex++;
                processed++;
            }
            // ì²­í¬ ë‹¨ìœ„ë¡œ DOM ì‚½ì…
            cardsContainer.appendChild(fragment);

            if (currentIndex < sortedPersonas.length) {
                if ('requestIdleCallback' in window) {
                    requestIdleCallback(renderChunk, { timeout: 100 });
                } else {
                    setTimeout(renderChunk, 0);
                }
            } else {
                // ì „ì²´ ë Œë” ì™„ë£Œ í›„ íˆ´íŒ 1íšŒ ì§€ì—° ì‹¤í–‰ ë° ì»¨í…Œì´ë„ˆ ìºì‹±
                if (typeof addTooltips === 'function') {
                    if ('requestIdleCallback' in window) {
                        requestIdleCallback(() => addTooltips(), { timeout: 1000 });
                    } else {
                        setTimeout(() => addTooltips(), 0);
                    }
                }
                // ì»¨í…Œì´ë„ˆ ëª©ë¡ ìºì‹± (í•„í„°/ê²€ìƒ‰ì—ì„œ ì¬ì‚¬ìš©)
                containers = document.querySelectorAll('.persona-detail-container');
                // ì¸í„°ë™ì…˜ ì—°ê²°
                wireCardInteractions();

                // ë Œë” ì™„ë£Œ í›„ URL ê²€ìƒ‰ íŒŒë¼ë¯¸í„° ì ìš© (ì»¨í…Œì´ë„ˆ ì¤€ë¹„ëœ ì´í›„ì—ë§Œ ì‹¤í–‰)
                try {
                    const urlParams = new URLSearchParams(window.location.search);
                    const searchQuery = urlParams.get('search');
                    if (searchQuery && searchInput) {
                        searchInput.value = searchQuery;
                        // ë“œë¡­ë‹¤ìš´ì€ í‘œì‹œí•˜ì§€ ì•ŠìŒ
                        if (dropdown) dropdown.style.display = 'none';
                        // ë¦¬ìŠ¤ë„ˆê°€ ì—°ê²°ëœ ì´í›„ ì•ˆì „í•˜ê²Œ íŠ¸ë¦¬ê±°
                        searchInput.dispatchEvent(new Event('input', { bubbles: true }));
                    }
                } catch (_) { /* no-op */ }
            }
        }
        // ì´ˆê¸° ë Œë” ì‹œì‘
        if ('requestIdleCallback' in window) {
            requestIdleCallback(renderChunk, { timeout: 50 });
        } else {
            setTimeout(renderChunk, 0);
        }

        // ì»¨í…Œì´ë„ˆ ëª©ë¡ì€ ë Œë” ì™„ë£Œ í›„ í• ë‹¹ë¨
        let containers = null;
        /*
        // ê´‘ê³  ì‚½ì… ì¹´ìš´í„° (Expand All ë¹„í™œì„± ìƒíƒœì—ì„œ ì¹´ë“œ ì—´ ë•Œë§Œ ì¦ê°€)
        let adOpenCount = 0;

        function injectAdForContainer(container) {
            try {
                const infoSection = container.querySelector('.persona-info-section');
                if (!infoSection) return;
                // ì´ë¯¸ ì‚½ì…ëœ ê²½ìš° ì¤‘ë³µ ë°©ì§€
                if (infoSection.querySelector('.dynamic-ad')) return;
                const adHost = document.createElement('div');
                adHost.className = 'dynamic-ad card-inline-ad';
                infoSection.appendChild(adHost);
                if (typeof ModalAdInjector !== 'undefined' && ModalAdInjector.injectAdInto) {
                    try { ModalAdInjector.injectAdInto(adHost, { width: 970, height: 90, className: 'card-ad-wrap', marginTop: 12 }); } catch (_) { }
                }
            } catch (_) {  }
        }*/

        // ì¹´ë“œ í´ë¦­ í™•ì¥ ë° ì „ì²´ í¼ì¹˜ê¸° í† ê¸€ ì—°ê²°
        function wireCardInteractions() {
            const grid = document.getElementById('personaCards');
            const expandAllToggle = document.getElementById('expandAllToggle');

            // i18n for label
            const expandAllLabel = document.getElementById('expandAllLabel');
            const labelTexts = { kr: 'ì „ì²´ í¼ì¹˜ê¸°', en: 'Expand all', jp: 'ã™ã¹ã¦å±•é–‹' };
            const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';
            if (expandAllLabel) expandAllLabel.textContent = labelTexts[currentLang] || labelTexts.kr;

            function removeAllBreakers() {
                grid.querySelectorAll('.grid-break').forEach(b => b.remove());
            }

            // Legacy no-ops (grid-break no longer used)
            function ensureBreakerBefore(_container) { /* no-op */ }
            function removeBreakerBefore(_container) { /* no-op */ }
            function removeAllBreakers() {
                grid.querySelectorAll('.grid-break').forEach(n => n.remove());
            }

            // Clean any leftover breakers from previous sessions/interactions
            removeAllBreakers();

            function applyExpandAllState() {
                if (!expandAllToggle) return;
                if (expandAllToggle.checked) {
                    grid.classList.add('expand-all');
                    // ì „ì²´ í™•ì¥: ëª¨ë“  ì»¨í…Œì´ë„ˆ í™•ì¥ ë° active
                    containers.forEach(c => {
                        c.classList.add('expanded');
                        c.classList.add('active');
                    });
                } else {
                    grid.classList.remove('expand-all');
                    // ì „ì²´ ì¶•ì†Œ: ëª¨ë“  ì»¨í…Œì´ë„ˆ ì¶•ì†Œ ë° active ì œê±°
                    containers.forEach(c => {
                        c.classList.remove('expanded');
                        c.classList.remove('active');
                    });
                    restoreOriginalOrder();
                }
            }

            function restoreOriginalOrder() {
                const items = Array.from(grid.querySelectorAll('.persona-detail-container'));
                items.sort((a, b) => (parseInt(a.dataset.order) - parseInt(b.dataset.order)));
                const frag = document.createDocumentFragment();
                items.forEach(el => frag.appendChild(el));
                grid.appendChild(frag);
            }

            function getSameRowPrevious(container) {
                const rect = container.getBoundingClientRect();
                const top = rect.top;
                const tolerance = 8; // px, breakpoint/zoom ì˜¤ì°¨ ë³´ì •
                const prevSiblings = [];
                let el = container.previousElementSibling;
                while (el) {
                    if (el.classList && el.classList.contains('persona-detail-container')) {
                        // ìˆ¨ê¹€(absolute)ì¸ ê²½ìš° ì œì™¸
                        const style = window.getComputedStyle(el);
                        if (style.position !== 'absolute') {
                            const r = el.getBoundingClientRect();
                            if (Math.abs(r.top - top) <= tolerance) {
                                prevSiblings.push(el);
                            } else {
                                // ë‹¤ë¥¸ í–‰ì„ ë§Œë‚˜ë©´ ì¤‘ë‹¨
                                break;
                            }
                        }
                    } else if (el.classList && el.classList.contains('grid-break')) {
                        // ê·¸ë¦¬ë“œ ë¸Œë ˆì´ì»¤ ë§Œë‚˜ë©´ ê°™ì€ í–‰ ì´ì „ ìš”ì†ŒëŠ” ì—†ìŒ
                        break;
                    }
                    el = el.previousElementSibling;
                }
                // DOM ìˆœì„œ ìœ ì§€ ìœ„í•´ ì—­ìˆœìœ¼ë¡œ ìŒ“ì˜€ë˜ ê²ƒì„ ë’¤ì§‘ì–´ ë°˜í™˜
                return prevSiblings.reverse();
            }

            // ê°œë³„ ì¹´ë“œ í´ë¦­ìœ¼ë¡œ í™•ì¥/ì¶•ì†Œ (expand-allì´ êº¼ì ¸ ìˆì„ ë•Œë§Œ)
            containers.forEach(container => {
                const clickTarget = container.querySelector('.persona-card-section') || container;
                clickTarget.style.cursor = 'pointer';
                clickTarget.addEventListener('click', (e) => {
                    if (expandAllToggle && expandAllToggle.checked) return; // ì „ì²´ í¼ì¹˜ê¸° ì¤‘ì—ëŠ” ê°œë³„ í† ê¸€ ë¹„í™œì„±í™”
                    const willExpand = !container.classList.contains('expanded');
                    if (willExpand) {
                        // Expand Allì´ êº¼ì ¸ ìˆì„ ë•ŒëŠ” í•˜ë‚˜ë§Œ ì—´ë¦¬ë„ë¡ ì´ì „ ì—´ë¦° ì¹´ë“œ ë‹«ê¸°
                        /*
                        containers.forEach(c => {
                            if (c !== container) { c.classList.remove('expanded'); c.classList.remove('active'); }
                        });*/
                        // í™•ì¥: ê°™ì€ í–‰ì˜ ì•ì„  ì¹´ë“œë“¤ì„ ë¨¼ì € ê³„ì‚°í•˜ê³ 
                        // í™•ì¥ ì¹´ë“œë¥¼ ê·¸ í–‰ì˜ ì²« ìš”ì†Œ ì•ì— ì´ë™í•˜ì—¬ ìƒˆ ì¤„ì„ ì‹œì‘í•˜ê²Œ í•¨
                        const sameRowPrev = getSameRowPrevious(container);
                        if (sameRowPrev.length > 0) {
                            const firstOfRow = sameRowPrev[0];
                            firstOfRow.parentNode.insertBefore(container, firstOfRow);
                        }
                        container.classList.add('expanded');
                        container.classList.add('active');

                        // ê´‘ê³  ì¹´ìš´íŠ¸ ì¦ê°€ ë° 1, 5, 9...ë²ˆì§¸ ì—´ ë•Œ ê´‘ê³  ì‚½ì…
                        /*
                        adOpenCount += 1;
                        if (adOpenCount === 1 || ((adOpenCount - 1) % 4 === 0)) {
                            injectAdForContainer(container);
                            // í•„í„°/ê²€ìƒ‰ ì‹œ ê´‘ê³  ê°€ì‹œì„± ê·œì¹™ ì ìš©
                            try { manageAdVisibility(); } catch (_) { }
                        }*/
                    } else {
                        // ì¶•ì†Œ: í´ë˜ìŠ¤ ì œê±° í›„ ì›ë˜ DOM ìˆœì„œ ë³µêµ¬
                        container.classList.remove('expanded');
                        container.classList.remove('active');
                        restoreOriginalOrder();
                    }
                });
            });

            if (expandAllToggle) {
                expandAllToggle.addEventListener('change', applyExpandAllState);
                // ì´ˆê¸° ìƒíƒœ ì ìš©
                applyExpandAllState();
            }
        }

        // ----------------------------------------------------
        // Filter implementation

        const filterToggleBtn = document.querySelector('.filter-toggle-btn');
        const filterContent = document.querySelector('.filter-content');
        const filterResetBtn = document.querySelector('.filter-reset-btn');
        const checkboxes = document.querySelectorAll('.filter-options input[type="checkbox"]');
        filterContent.style.display = 'block';

        // Filter toggle
        filterToggleBtn.addEventListener('click', () => {
            filterContent.style.display = filterContent.style.display === 'none' ? 'block' : 'none';
        });

        // í•„í„° ë””ë°”ìš´ì‹±ì„ ìœ„í•œ íƒ€ì´ë¨¸
        let filterDebounceTimer;

        // Detect checkbox changes with debouncing
        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                // ë””ë°”ìš´ì‹± ì ìš©
                clearTimeout(filterDebounceTimer);
                filterDebounceTimer = setTimeout(() => {
                    // Check if any filters are selected
                    const hasChecked = Array.from(checkboxes).some(cb => cb.checked);
                    //filterResetBtn.style.display = hasChecked ? 'block' : 'none';

                    // Apply filters
                    applyFilters();
                }, 50); // 50ms ë””ë°”ìš´ì‹±
            });
        });

        // Reset button

        filterResetBtn.addEventListener('click', () => {
            // ë°°ì¹˜ë¡œ ì²´í¬ë°•ìŠ¤ ìƒíƒœ ë³€ê²½
            requestAnimationFrame(() => {
                checkboxes.forEach(cb => cb.checked = false);
                filterResetBtn.style.display = 'none';

                // ìºì‹œ ì´ˆê¸°í™”
                filterCache = {
                    elements: new Set(),
                    positions: new Set(),
                    rarities: new Set(),
                    grades: new Set()
                };

                applyFilters();
            });
        });

        filterToggleBtn.style.display = 'none';
        filterResetBtn.style.display = 'none';

        // í•„í„° ìƒíƒœ ìºì‹±ì„ ìœ„í•œ ë³€ìˆ˜ë“¤
        let filterCache = {
            elements: new Set(),
            positions: new Set(),
            rarities: new Set(),
            grades: new Set()
        };

        // ê´‘ê³  ê°€ì‹œì„± ê´€ë¦¬ í•¨ìˆ˜
        /*
        function manageAdVisibility() {
            const hasActiveFilters = Array.from(checkboxes).some(cb => cb.checked);
            const hasActiveSearch = searchInput && searchInput.value.trim() !== '';
            const isFilteringActive = hasActiveFilters || hasActiveSearch;

            const dynamicAds = document.querySelectorAll('.dynamic-ad');

            if (isFilteringActive) {
                // í•„í„°ë‚˜ ê²€ìƒ‰ì´ í™œì„±í™”ëœ ê²½ìš°: ë§ˆì§€ë§‰ ê´‘ê³ ë§Œ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€ ìˆ¨ê¹€
                dynamicAds.forEach((ad, index) => {
                    if (index === dynamicAds.length - 1) {
                        // ë§ˆì§€ë§‰ ê´‘ê³ ëŠ” í‘œì‹œ
                        ad.style.display = 'block';
                    } else {
                        // ë‚˜ë¨¸ì§€ ê´‘ê³ ëŠ” ìˆ¨ê¹€
                        ad.style.display = 'none';
                    }
                });
            } else {
                // í•„í„°ë‚˜ ê²€ìƒ‰ì´ ë¹„í™œì„±í™”ëœ ê²½ìš°: ëª¨ë“  ê´‘ê³  í‘œì‹œ
                dynamicAds.forEach(ad => {
                    ad.style.display = 'block';
                });
            }
        }*/

        // ì„±ëŠ¥ ìµœì í™”ëœ í•„í„° ì ìš© í•¨ìˆ˜
        function applyFilters() {
            if (!containers) return; // ì•„ì§ ë Œë”ë§ ì¤‘ì´ë©´ ë¬´ì‹œ
            // í•„í„° ìƒíƒœë¥¼ Setìœ¼ë¡œ ìºì‹±í•˜ì—¬ ë¹ ë¥¸ ì¡°íšŒ
            filterCache.elements = new Set(Array.from(document.querySelectorAll('input[name="element"]:checked')).map(cb => cb.value));
            filterCache.positions = new Set(Array.from(document.querySelectorAll('input[name="position"]:checked')).map(cb => cb.value));
            filterCache.rarities = new Set(Array.from(document.querySelectorAll('input[name="rarity"]:checked')).map(cb => parseInt(cb.value)));
            filterCache.grades = new Set(Array.from(document.querySelectorAll('input[name="grade"]:checked')).map(cb => cb.value));

            let visibleCount = 0;

            // requestAnimationFrameìœ¼ë¡œ DOM ì¡°ì‘ ë°°ì¹˜ ì²˜ë¦¬
            requestAnimationFrame(() => {
                containers.forEach(container => {
                    const element = container.dataset.element;
                    const position = container.dataset.position;
                    const rarity = parseInt(container.dataset.rarity);
                    const grade = container.dataset.grade;
                    const personaName = container.dataset.name;

                    // Set.has()ë¡œ ë¹ ë¥¸ ì¡°íšŒ (O(1))
                    const elementMatch = filterCache.elements.size === 0 || filterCache.elements.has(element);
                    const positionMatch = filterCache.positions.size === 0 || filterCache.positions.has(position);
                    const rarityMatch = filterCache.rarities.size === 0 || filterCache.rarities.has(rarity);
                    const gradeMatch = filterCache.grades.size === 0 ||
                        filterCache.grades.has(grade);

                    const isVisible = elementMatch && positionMatch && rarityMatch && gradeMatch;

                    // display ëŒ€ì‹  positionìœ¼ë¡œ ì„±ëŠ¥ ê°œì„  (ë ˆì´ì•„ì›ƒ ì¬ê³„ì‚° ë°©ì§€)
                    if (isVisible) {
                        container.style.position = 'relative';
                        container.style.visibility = 'visible';
                        container.style.height = 'auto';
                        visibleCount++;
                    } else {
                        container.style.position = 'absolute';
                        container.style.visibility = 'hidden';
                        container.style.height = '0';
                    }
                });

                // ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
                const countText = window.i18nFilteredCount || 'ì „ì²´';
                const countUnit = window.i18nCountUnit !== undefined ? window.i18nCountUnit : (currentLang === 'kr' ? 'ê°œ' : '');
                document.getElementById('filteredCount').textContent = `${countText} ${visibleCount}${countUnit}`;

                // ê´‘ê³  ê°€ì‹œì„± ê´€ë¦¬
                //manageAdVisibility();
            });
        }

        // Search functionality implementation
        const searchInput = document.getElementById('personaSearch');
        const dropdown = document.getElementById('searchDropdown');
        // ë“œë¡­ë‹¤ìš´ ë…¸ì¶œ ì–µì œ í”Œë˜ê·¸ (ì—”í„°/URL ê²€ìƒ‰ í™•ì • í›„ ì¬ë…¸ì¶œ ë°©ì§€)
        let suppressDropdown = false;
        // ë§ˆì§€ë§‰ í™•ì • ê²€ìƒ‰ì–´ (ì—”í„°/URL ì ìš© ì‹œ ê¸°ë¡)
        let lastConfirmedSearchValue = '';
        // Note: reuse cached NodeList from above to avoid redeclaration and extra DOM query
        // const containers = document.querySelectorAll('.persona-detail-container');

        // ì–¸ì–´ë³„ í˜ë¥´ì†Œë‚˜ ì´ë¦„ ë§¤í•‘ ìƒì„±
        const personaNameMapping = {};
        const nameSource = (typeof window !== 'undefined' && window.personaFiles)
            ? window.personaFiles
            : {};
        Object.keys(nameSource).forEach(koreanName => {
            const persona = nameSource[koreanName];
            personaNameMapping[koreanName.toLowerCase()] = koreanName;

            // ì˜ì–´ ì´ë¦„ ì¶”ê°€
            if (persona.name_en) {
                personaNameMapping[persona.name_en.toLowerCase()] = koreanName;
            }

            // ì¼ë³¸ì–´ ì´ë¦„ ì¶”ê°€
            if (persona.name_jp) {
                personaNameMapping[persona.name_jp.toLowerCase()] = koreanName;
            }
        });

        // ë””ë°”ìš´ì‹±ì„ ìœ„í•œ íƒ€ì´ë¨¸
        let searchDebounceTimer;

        // ê²€ìƒ‰ í•¸ë“¤ëŸ¬ í•¨ìˆ˜ ë¶„ë¦¬
        function handleSearchInput(e) {
            const searchValue = e ? e.target.value.toLowerCase() : '';

            // ì‚¬ìš©ìê°€ ë§ˆì§€ë§‰ í™•ì • ê²€ìƒ‰ì–´ì—ì„œ ë³€ê²½ì„ ì‹œì‘í•˜ë©´ ë“œë¡­ë‹¤ìš´ ì–µì œ í•´ì œ
            if (searchValue !== lastConfirmedSearchValue) {
                suppressDropdown = false;
            }

            // ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸ (ì¦‰ì‹œ) â€” ì–µì œ ì¤‘ì´ë©´ ìˆ¨ê¹€ ìœ ì§€
            if (suppressDropdown) {
                if (dropdown) dropdown.style.display = 'none';
            } else {
                updateDropdown(searchValue);
            }

            // ê²€ìƒ‰ í•„í„°ë§ (ë””ë°”ìš´ì‹± ì ìš©)
            clearTimeout(searchDebounceTimer);
            searchDebounceTimer = setTimeout(() => {
                filterBySearch(searchValue);
            }, 100); // 100ms ë””ë°”ìš´ì‹±
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
        searchInput.addEventListener('input', handleSearchInput);
        // Enterë¡œ ê²€ìƒ‰ í™•ì • ì‹œ ë“œë¡­ë‹¤ìš´ ë‹«ê³  ì¦‰ì‹œ í•„í„° ì ìš©
        searchInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                const value = searchInput.value.trim().toLowerCase();
                // ì¼ë°˜ ì…ë ¥ ê²€ìƒ‰: ë“œë¡­ë‹¤ìš´ ìœ ì§€, ìë™ í™•ì¥ ì—†ìŒ
                clearTimeout(searchDebounceTimer);
                filterBySearch(value);
            }
        });

        // ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ ë¶„ë¦¬
        function updateDropdown(searchValue) {
            // URL íŒŒë¼ë¯¸í„° ê²€ìƒ‰ ì ìš© ì¤‘ì—ëŠ” ë“œë¡­ë‹¤ìš´ì„ ë…¸ì¶œí•˜ì§€ ì•ŠìŒ
            if (window.isApplyingUrlSearch) {
                if (dropdown) dropdown.style.display = 'none';
                return;
            }
            if (suppressDropdown) {
                if (dropdown) dropdown.style.display = 'none';
                return;
            }
            dropdown.innerHTML = '';

            if (searchValue.length > 0) {
                const matches = Object.keys(personaNameMapping).filter(name =>
                    name.includes(searchValue)
                ).slice(0, 10); // ì„±ëŠ¥ì„ ìœ„í•´ ìµœëŒ€ 10ê°œë¡œ ì œí•œ

                if (matches.length > 0) {
                    dropdown.style.display = 'block';

                    // DocumentFragmentë¡œ ë°°ì¹˜ DOM ì¶”ê°€
                    const fragment = document.createDocumentFragment();

                    matches.forEach(matchedName => {
                        const koreanName = personaNameMapping[matchedName];
                const persona = nameSource[koreanName];

                        // í˜„ì¬ ì–¸ì–´ì— ë§ëŠ” í‘œì‹œ ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
                        let displayName = koreanName;
                        if (currentLang === 'en' && persona.name_en) {
                            displayName = persona.name_en;
                        } else if (currentLang === 'jp' && persona.name_jp) {
                            displayName = persona.name_jp;
                        }

                        const div = document.createElement('div');
                        div.className = 'dropdown-item';
                        div.textContent = displayName;
                        div.addEventListener('click', () => {
                            searchInput.value = displayName;
                            dropdown.style.display = 'none';
                            filterBySearch(matchedName.toLowerCase());
                        });
                        fragment.appendChild(div);
                    });

                    dropdown.appendChild(fragment);
                } else {
                    dropdown.style.display = 'none';
                }
            } else {
                dropdown.style.display = 'none';
            }
        }

        // ê²€ìƒ‰ ê²°ê³¼ ìºì‹±
        let searchCache = new Map();

        // ì„±ëŠ¥ ìµœì í™”ëœ ê²€ìƒ‰ í•„í„°ë§ í•¨ìˆ˜
        function filterBySearch(searchValue) {
            // ìºì‹œì—ì„œ ê²°ê³¼ í™•ì¸
            if (searchCache.has(searchValue)) {
                applySearchResults(searchCache.get(searchValue));
                return;
            }

            let visibleCount = 0;
            const results = [];
            let firstVisibleIndex = -1;

            // requestAnimationFrameìœ¼ë¡œ ë°°ì¹˜ ì²˜ë¦¬
            requestAnimationFrame(() => {
                containers.forEach(container => {
                    const koreanName = container.dataset.name;
                    const persona = nameSource[koreanName];

                    // ëª¨ë“  ì–¸ì–´ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰ ê°€ëŠ¥í•˜ë„ë¡
                    const searchableNames = [
                        koreanName.toLowerCase(),
                        persona.name_en ? persona.name_en.toLowerCase() : '',
                        persona.name_jp ? persona.name_jp.toLowerCase() : ''
                    ].filter(name => name); // ë¹ˆ ë¬¸ìì—´ ì œê±°

                    const isVisible = searchValue === '' || searchableNames.some(name => name.includes(searchValue));

                    // display ëŒ€ì‹  positionìœ¼ë¡œ ì„±ëŠ¥ ê°œì„ 
                    if (isVisible) {
                        container.style.position = 'relative';
                        container.style.visibility = 'visible';
                        container.style.height = 'auto';
                        visibleCount++;
                    } else {
                        container.style.position = 'absolute';
                        container.style.visibility = 'hidden';
                        container.style.height = '0';
                    }

                    results.push(isVisible);
                    if (isVisible && firstVisibleIndex === -1) {
                        firstVisibleIndex = results.length - 1;
                    }
                });

                // ê²°ê³¼ ìºì‹± (ìµœëŒ€ 50ê°œê¹Œì§€ë§Œ)
                if (searchCache.size < 50) {
                    searchCache.set(searchValue, results);
                }

                // ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
                const countText = window.i18nFilteredCount || 'ì „ì²´';
                const countUnit = window.i18nCountUnit !== undefined ? window.i18nCountUnit : (currentLang === 'kr' ? 'ê°œ' : '');
                document.getElementById('filteredCount').textContent = `${countText} ${visibleCount}${countUnit}`;

                // ê´‘ê³  ê°€ì‹œì„± ê´€ë¦¬
                //manageAdVisibility();

                // URL íŒŒë¼ë¯¸í„° ê²€ìƒ‰ì¼ ë•Œë§Œ ìë™ í™•ì¥/ë“œë¡­ë‹¤ìš´ ìˆ¨ê¹€ ì ìš©
                if (window.isApplyingUrlSearch) {
                    const expandAllToggle = document.getElementById('expandAllToggle');
                    if (!expandAllToggle || !expandAllToggle.checked) {
                        // ê¸°ì¡´ í™•ì¥ ìƒíƒœ ì´ˆê¸°í™”
                        containers.forEach(c => { c.classList.remove('expanded'); c.classList.remove('active'); });
                        if (firstVisibleIndex >= 0) {
                            const firstEl = containers[firstVisibleIndex];
                            if (firstEl) {
                                firstEl.classList.add('expanded');
                                firstEl.classList.add('active');
                            }
                        }
                    }
                    // ë“œë¡­ë‹¤ìš´ ìˆ¨ê¹€
                    const dropdown = document.getElementById('searchDropdown');
                    if (dropdown) dropdown.style.display = 'none';
                    // í”Œë˜ê·¸ ë¦¬ì…‹
                    window.isApplyingUrlSearch = false;
                }
            });
        }

        // ìºì‹œëœ ê²€ìƒ‰ ê²°ê³¼ ì ìš© í•¨ìˆ˜
        function applySearchResults(results) {
            const containers = document.querySelectorAll('.persona-detail-container');
            let visibleCount = 0;
            let firstVisibleIndex = -1;

            requestAnimationFrame(() => {
                containers.forEach((container, index) => {
                    const isVisible = results[index];

                    if (isVisible) {
                        container.style.position = 'relative';
                        container.style.visibility = 'visible';
                        container.style.height = 'auto';
                        visibleCount++;
                        if (firstVisibleIndex === -1) firstVisibleIndex = index;
                    } else {
                        container.style.position = 'absolute';
                        container.style.visibility = 'hidden';
                        container.style.height = '0';
                    }
                });

                // ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
                const countText = window.i18nFilteredCount || 'ì „ì²´';
                const countUnit = window.i18nCountUnit !== undefined ? window.i18nCountUnit : (currentLang === 'kr' ? 'ê°œ' : '');
                document.getElementById('filteredCount').textContent = `${countText} ${visibleCount}${countUnit}`;

                // ê²€ìƒ‰ í›„ ê´‘ê³  ê°€ì‹œì„± ê´€ë¦¬
                //manageAdVisibility();

                // URL íŒŒë¼ë¯¸í„° ê²€ìƒ‰ì¼ ë•Œë§Œ ìë™ í™•ì¥/ë“œë¡­ë‹¤ìš´ ìˆ¨ê¹€ ì ìš©
                if (window.isApplyingUrlSearch) {
                    // ë“œë¡­ë‹¤ìš´ ìˆ¨ê¹€
                    if (dropdown) dropdown.style.display = 'none';
                    // ì²« ë²ˆì§¸ ê²°ê³¼ ìë™ í™•ì¥ (expand-allì´ êº¼ì ¸ ìˆì„ ë•Œë§Œ)
                    const expandAllToggle = document.getElementById('expandAllToggle');
                    if (!expandAllToggle || !expandAllToggle.checked) {
                        containers.forEach(c => { c.classList.remove('expanded'); c.classList.remove('active'); });
                        if (firstVisibleIndex >= 0) {
                            const firstEl = containers[firstVisibleIndex];
                            if (firstEl) {
                                firstEl.classList.add('expanded');
                                firstEl.classList.add('active');
                            }
                        }
                    }
                    // í”Œë˜ê·¸ ë¦¬ì…‹
                    window.isApplyingUrlSearch = false;
                }
            });
        }

        // Close dropdown when clicking outside search
        document.addEventListener('click', (e) => {
            if (!searchInput.contains(e.target) && !dropdown.contains(e.target)) {
                dropdown.style.display = 'none';
            }
        });

        // When keyboard appears
        searchInput.addEventListener('focus', () => {
            document.body.classList.add('keyboard-open');
        });

        // When keyboard disappears
        searchInput.addEventListener('blur', () => {
            document.body.classList.remove('keyboard-open');
        });

        // Prevent viewport size changes on iOS
        if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
            const viewport = document.querySelector('meta[name="viewport"]');
            if (viewport) {
                viewport.content = 'width=device-width, initial-scale=1, maximum-scale=1';
            }
        }
    } // initializePageContent í•¨ìˆ˜ ì¢…ë£Œ

    // ----------------------------------------------------
    // Global skill level selector (LV6 / LV7 / LV8 / ALL)
    // ----------------------------------------------------

    function setupGlobalSkillLevelSelector() {
        const buttons = document.querySelectorAll('.skill-level-buttons-global .skill-level-btn');
        if (!buttons.length) return;

        function applyGlobalSkillLevel(level) {
            globalSkillLevel = level;
            const applyTo = (p) => {
                const original = p.dataset.originalText || p.textContent || '';
                if (level === null) {
                    p.textContent = original;
                } else {
                    p.textContent = filterDescByLevel(original, level);
                }
            };
            const uniqueParas = document.querySelectorAll('.persona-unique-skill-info p');
            const highlightParas = document.querySelectorAll('.persona-highlight-info p');
            uniqueParas.forEach(applyTo);
            highlightParas.forEach(applyTo);
            // ì¶”ì²œ ìŠ¤í‚¬(description)ì—ë„ ë™ì¼í•œ ìŠ¤í‚¬ ë ˆë²¨ í•„í„° ì ìš©
            const recommendedParas = document.querySelectorAll('.persona-recommended-skills .skill-description');
            recommendedParas.forEach((p) => {
                // type ì´ "íŒ¨ì‹œë¸Œ" ì¸ ì¶”ì²œ ìŠ¤í‚¬ì€ ìŠ¤í‚¬ ë ˆë²¨ í† ê¸€ì˜ ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ”ë‹¤.
                if (p.dataset.passive === 'true') return;
                applyTo(p);
            });
            if (typeof addTooltips === 'function') {
                try { addTooltips(); } catch (_) { /* noop */ }
            }
        }

        buttons.forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.preventDefault();
                const levelAttr = btn.dataset.level;
                const level = levelAttr === 'ALL' ? null : parseInt(levelAttr, 10);

                buttons.forEach(b => {
                    const isActive = b === btn;
                    b.classList.toggle('active', isActive);
                    b.setAttribute('aria-pressed', isActive ? 'true' : 'false');
                });

                applyGlobalSkillLevel(level);
            });
        });

        // ì´ˆê¸° ìƒíƒœ(LV6) ì „ì—­ ì ìš©
        applyGlobalSkillLevel(0);
    }

    // ì–¸ì–´ë³„ ì„¤ëª… ë°•ìŠ¤ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateExplainBoxTexts(currentLang) {
        const explainTexts = {
            kr: {
                instinct_title: "ë³¸ëŠ¥ Â· ê³ ìœ  ìŠ¤í‚¬ Â· HIGHLIGHT",
                skills_title: "ì¶”ì²œ ìŠ¤í‚¬",
                priority_label: "ì¤‘ìš”ë„ :",
                priority_label2: "ìš°ì„ ìˆœìœ„ :",
                priority_high: "ìƒ",
                priority_medium: "ì¤‘",
                priority_low: "í•˜",
                priority_normal: "ì¤‘",
                priority_very_low: "ìµœí•˜",
                priority_highest: "ìƒ"
            },
            en: {
                instinct_title: "Core Passive Â· Unique Skill Â· HIGHLIGHT",
                skills_title: "Recommended Skills",
                priority_label: "Importance :",
                priority_label2: "Priority :",
                priority_high: "High",
                priority_medium: "Med",
                priority_low: "Low",
                priority_normal: "Normal",
                priority_very_low: "Very Low",
                priority_highest: "High"
            },
            jp: {
                instinct_title: "æœ¬èƒ½ Â· å›ºæœ‰ã‚¹ã‚­ãƒ« Â· ãƒã‚¤ãƒ©ã‚¤ãƒˆ",
                skills_title: "æ¨å¥¨ã‚¹ã‚­ãƒ«",
                priority_label: "é‡è¦åº¦ :",
                priority_label2: "å„ªå…ˆé †ä½ :",
                priority_high: "é«˜",
                priority_medium: "ä¸­",
                priority_low: "ä½",
                priority_normal: "ä¸€èˆ¬",
                priority_very_low: "éå¸¸ã«ä½ã„",
                priority_highest: "é«˜ã„"
            }
        };

        const currentExplainTexts = explainTexts[currentLang] || explainTexts['kr'];

        // ì„¤ëª… ë°•ìŠ¤ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        const explainSections = document.querySelectorAll('.explain-section h4');
        if (explainSections[0]) explainSections[0].textContent = currentExplainTexts.instinct_title;
        if (explainSections[1]) explainSections[1].textContent = currentExplainTexts.skills_title;

        const priorityLabels = document.querySelectorAll('.priority-label');
        if (priorityLabels[0]) priorityLabels[0].textContent = currentExplainTexts.priority_label;
        if (priorityLabels[1]) priorityLabels[1].textContent = currentExplainTexts.priority_label2;

        // ìš°ì„ ìˆœìœ„ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        const priorityTexts = document.querySelectorAll('[data-priority-text]');
        priorityTexts.forEach(element => {
            const type = element.dataset.priorityText;
            switch (type) {
                case 'high':
                    element.textContent = currentExplainTexts.priority_highest;
                    break;
                case 'normal':
                    element.textContent = currentExplainTexts.priority_normal;
                    break;
                case 'low':
                    element.textContent = currentExplainTexts.priority_low;
                    break;
                case 'very-low':
                    element.textContent = currentExplainTexts.priority_very_low;
                    break;
            }
        });

        // ê¸°ì¡´ ìš°ì„ ìˆœìœ„ ì•„ì´í…œë“¤ (ì„¤ëª… ë°•ìŠ¤ ì²« ë²ˆì§¸ ì„¹ì…˜)
        const priorityItems = document.querySelectorAll('.priority-item span');
        if (priorityItems[0]) priorityItems[0].textContent = currentExplainTexts.priority_high;
        if (priorityItems[1]) priorityItems[1].textContent = currentExplainTexts.priority_medium;
        if (priorityItems[2]) priorityItems[2].textContent = currentExplainTexts.priority_low;
        if (priorityItems[3]) priorityItems[3].textContent = currentExplainTexts.priority_highest;
        if (priorityItems[4]) priorityItems[4].textContent = currentExplainTexts.priority_normal;
        if (priorityItems[5]) priorityItems[5].textContent = currentExplainTexts.priority_low;
        if (priorityItems[6]) priorityItems[6].textContent = currentExplainTexts.priority_very_low;
    }

    // ê´‘ê³  í° ë°•ìŠ¤ ìˆ¨ê¹€
    /*
    setTimeout(() => {
        document.querySelectorAll(".adsbygoogle").forEach(el => {
            const status = el.getAttribute("data-ad-status");
            const adslot = el.getAttribute("data-ad-slot");
            //console.log("google status", status);
            //console.log("google adslot", adslot);
            if (status === "unfilled" || el.querySelector("iframe") === null) {
                el.style.display = "none";
            }
        });
    }, 1000);  // ê´‘ê³  ë¡œë”© ê¸°ë‹¤ë ¸ë‹¤ê°€ 1ì´ˆ í›„ ê²€ì‚¬*/
</script>



<script>window.SITE_BASEURL = '{{ site.baseurl }}';</script>
<script src="{{ site.baseurl }}/apps/persona/skillfrom.js?v={{ site.time | date: '%s' }}"></script>