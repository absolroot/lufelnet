<!DOCTYPE html>
<html lang="kr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-adsense-account" content="ca-pub-5862324369257695">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5862324369257695"
  crossorigin="anonymous"></script>
  
  <!-- SEO 메타태그 -->
  <meta name="description" content="">
  <meta name="keywords" content="페르소나5 더 팬텀 X, P5X, 루페르넷, 괴도, 페르소나, 계시, 택틱, 게임공략">
  <meta name="author" content="루트">
  
  <!-- Open Graph 메타태그 -->
  <meta property="og:title" content="">
  <meta property="og:description" content="">
  <meta property="og:type" content="website">
  <meta property="og:url" content="http://localhost:4000/kr/revelations/">
  <meta property="og:image" content="http://localhost:4000/assets/img/home/seo.png">
  
  <title></title>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lz-string@1.4.4/libs/lz-string.min.js"></script>

  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-57DTGQ5TR7"></script>
  <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-57DTGQ5TR7');</script>
 
  
  <!-- 버전 관리 스크립트 -->
  <script>
    document.write('<script src="/assets/js/version.js?v=' + new Date().getTime() + '"><\/script>');
  </script>
  
  <link rel="icon" type="image/x-icon" href="/assets/img/favicon/favicon.ico">
  <link rel="icon" type="image/png" href="/assets/img/favicon/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/assets/img/favicon/favicon.svg" />
  <link rel="shortcut icon" href="/assets/img/favicon/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicon/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="LufelNet" />
  <link rel="manifest" href="/assets/img/favicon/site.webmanifest" />

  <script>
    // APP_VERSION을 사용하여 리소스 버전 관리
    document.write(`
      <link rel="stylesheet" href="/assets/css/default/common.css?v=${APP_VERSION}">
      <link rel="stylesheet" href="/assets/css/default/nav.css?v=${APP_VERSION}">
      <link rel="stylesheet" href="/assets/css/default/version-update.css?v=${APP_VERSION}">
      <script src="/assets/js/nav.js?v=${APP_VERSION}"><\/script>
      <script src="/assets/js/top_button.js?v=${APP_VERSION}"><\/script>
    `);
    
    
      
        document.write(`<link rel="stylesheet" href="/assets/css/revelations.css?v=${APP_VERSION}">`);
      
    
    
    
      
        document.write(`<script src="/assets/js/tooltip.js?v=${APP_VERSION}"><\/script>`);
      
    

    
      
        document.write(`<script src="/data/kr/revelations/revelations.js?v=${APP_VERSION}"><\/script>`);
      
        document.write(`<script src="/data/kr/tooltip.js?v=${APP_VERSION}"><\/script>`);
      
    
  </script>
</head>
<body>
  <!-- 네비게이션 컨테이너 -->
  <div class="container">
    <div id="nav-container"></div>
    
    <!-- 메인 콘텐츠 -->
    <!-- Main content -->
<div class="main-wrapper">
    <!-- Navigation path -->
    <div class="navigation-path">
        <script>document.write(`<a href="../?v=${APP_VERSION}">홈</a>`);</script>
        <span class="separator">/</span>
        <span class="current-page">계시</span>
    </div>
    <div class="header-container">
        <h1>계시</h1>
    </div>

    <!-- Filter section -->
    <div class="filter-section">
        <div class="filter-content">
            <!-- Revelation type filter -->
            <div class="filter-group">
                <h3>분류</h3>
                <div class="filter-options">
                    <label>
                        <input type="checkbox" name="type" value="main">
                        <img src="/assets/img/revelation/icon-주.png" alt="주 성위">
                    </label>
                    <label>
                        <input type="checkbox" name="type" value="sub">
                        <div class="sub-icons">
                            <img src="/assets/img/revelation/icon-일.png" alt="일월성진">
                            <img src="/assets/img/revelation/icon-월.png" alt="일월성진">
                            <img src="/assets/img/revelation/icon-성.png" alt="일월성진">
                            <img src="/assets/img/revelation/icon-진.png" alt="일월성진">
                        </div>
                    </label>
                </div>
            </div>

            <!-- Element filter -->
            <div class="filter-group">
                <h3>속성</h3>
                <div class="filter-options">
                    <label>
                        <input type="checkbox" name="element" value="물리">
                        <img src="/assets/img/character-cards/속성_물리.png" alt="물리">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="총격">
                        <img src="/assets/img/character-cards/속성_총격.png" alt="총격">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="화염">
                        <img src="/assets/img/character-cards/속성_화염.png" alt="화염">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="빙결">
                        <img src="/assets/img/character-cards/속성_빙결.png" alt="빙결">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="전격">
                        <img src="/assets/img/character-cards/속성_전격.png" alt="전격">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="질풍">
                        <img src="/assets/img/character-cards/속성_질풍.png" alt="질풍">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="염동">
                        <img src="/assets/img/character-cards/속성_염동.png" alt="염동">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="핵열">
                        <img src="/assets/img/character-cards/속성_핵열.png" alt="핵열">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="축복">
                        <img src="/assets/img/character-cards/속성_축복.png" alt="축복">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="주원">
                        <img src="/assets/img/character-cards/속성_주원.png" alt="주원">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="만능">
                        <img src="/assets/img/character-cards/속성_만능.png" alt="만능">
                        <span></span>
                    </label>
                </div>
            </div>

            <!-- Type filter -->
            <div class="filter-group">
                <h3>타입</h3>
                <div class="filter-options">
                    <label>
                        <input type="checkbox" name="effect" value="버프">
                        <p>버프</p>
                    </label>
                    <label>
                        <input type="checkbox" name="effect" value="디버프">
                        <p>디버프</p>
                    </label>
                    <label>
                        <input type="checkbox" name="effect" value="추가 효과">
                        <p>추가 효과</p>
                    </label>
                    <label>
                        <input type="checkbox" name="effect" value="HL 25%">
                        <p>HL 25%</p>
                    </label>
                    <label>
                        <input type="checkbox" name="effect" value="치료">
                        <p>치료</p>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- Separator line -->
    <div class="separator-line"></div>

    <!-- Revelation card container -->
    <div class="revelation-cards" id="revelationCards">
        <!-- Dynamically generated by JavaScript -->
    </div>
</div>



<script>
    // Initialize navigation on page load
    document.addEventListener('DOMContentLoaded', () => {
        Navigation.load('revelations', 1); // Set active state for current page
        VersionChecker.check();

        const cardsContainer = document.getElementById('revelationCards');
        
        // Separate main revelations and sub revelations
        const mainRevelations = Object.keys(revelationData.main);
        const subRevelations = Object.keys(revelationData.sub);
        
        // Create array of all revelations (sub revelations first, then main revelations)
        const allRevelations = [
            ...subRevelations.map(name => ({ name, type: 'sub' })),
            ...mainRevelations.map(name => ({ name, type: 'main' }))
        ];
        
        // Create card for each revelation
        allRevelations.forEach((revelation, index) => {
            // Insert ad every 7 cards (index starts at 0, so remainder 7 means 8th card)
            /*
            if (index > 0 && index % 7 === 0) {
                const adContainer = document.createElement('div');
                adContainer.className = 'card ad-card';
                adContainer.innerHTML = `
                    <ins class="adsbygoogle"
                            style="display:block"
                            data-ad-format="fluid"
                            data-ad-layout-key="-fh+6+3e-os+119"
                            data-ad-client="ca-pub-5862324369257695"
                            data-ad-slot="7402083530"></ins>
                `;
                cardsContainer.appendChild(adContainer);
                
                // Initialize new ad element
                (adsbygoogle = window.adsbygoogle || []).push({});
            }
            */

            const card = document.createElement('div');
            card.className = 'card';
            card.dataset.type = revelation.type;
            card.dataset.name = revelation.name;
            
            // Image container
            const imgContainer = document.createElement('div');
            imgContainer.className = 'img-container';
            
            // Revelation image
            const img = document.createElement('img');
            img.src = `/assets/img/revelation/${revelation.name}.webp`;
            img.alt = revelation.name;
            img.className = 'revelation-img';

            // Name image
            const nameImg = document.createElement('img');
            nameImg.src = `/assets/img/revelation/${revelation.name}.png`;
            nameImg.alt = revelation.name;
            nameImg.className = 'name-img';
            
            imgContainer.appendChild(img);
            imgContainer.appendChild(nameImg);
            
            // Info container
            const infoContainer = document.createElement('div');
            infoContainer.className = 'info-container';
            
            // Type label
            const typeLabel = document.createElement('div');
            typeLabel.className = 'type-label';
            
            // Container for text and icons
            const typeLabelContent = document.createElement('div');
            typeLabelContent.className = 'type-label-content';
            
            // Add text
            const typeText = document.createElement('span');
            typeText.textContent = revelation.name;  // Changed to revelation name
            
            // Icon container
            const iconContainer = document.createElement('div');
            iconContainer.className = 'type-icons';
            
            if (revelation.type === 'main') {
                // For main revelations
                const mainIcon = document.createElement('img');
                mainIcon.src = '/assets/img/revelation/icon-주.png';
                mainIcon.alt = '주';
                mainIcon.className = 'type-icon';
                iconContainer.appendChild(mainIcon);
            } else {
                // For sub revelations
                ['일', '월', '성', '진'].forEach(type => {
                    const icon = document.createElement('img');
                    icon.src = `/assets/img/revelation/icon-${type}.png`;
                    icon.alt = type;
                    icon.className = 'type-icon';
                    iconContainer.appendChild(icon);
                });
            }
            
            typeLabelContent.appendChild(typeText);
            typeLabelContent.appendChild(iconContainer);
            typeLabel.appendChild(typeLabelContent);
            
            // Effect description
            const effectsContainer = document.createElement('div');
            effectsContainer.className = 'effects-container';
            
            if (revelation.type === 'sub') {
                // For sub revelations, show 2-set and 4-set effects
                const effects = revelationData.sub_effects[revelation.name];
                effectsContainer.innerHTML = `
                    <div class="effect-set">
                        <div class="set-label">2세트</div>
                        <div class="set-desc">${effects.set2}</div>
                    </div>
                    <div class="effect-set">
                        <div class="set-label">4세트</div>
                        <div class="set-desc">${effects.set4}</div>
                    </div>
                `;
            } else {
                // For main revelations, show set_effects
                const mainEffects = revelationData.set_effects[revelation.name];
                effectsContainer.innerHTML = Object.entries(mainEffects)
                    .map(([subName, effect]) => `
                        <div class="effect-set">
                            <div class="set-label">${subName}</div>
                            <div class="set-desc">${effect}</div>
                        </div>
                    `).join('');
            }
            
            infoContainer.appendChild(typeLabel);
            infoContainer.appendChild(effectsContainer);
            
            card.appendChild(imgContainer);
            card.appendChild(infoContainer);
            cardsContainer.appendChild(card);
        });
        
        addTooltips();

        // Add filtering functionality
        const checkboxes = document.querySelectorAll('.filter-options input[type="checkbox"]');
        
        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                applyFilters();
            });
        });

        function applyFilters() {
            const selectedTypes = Array.from(document.querySelectorAll('input[name="type"]:checked')).map(cb => cb.value);
            const selectedElements = Array.from(document.querySelectorAll('input[name="element"]:checked')).map(cb => cb.value);
            const selectedEffects = Array.from(document.querySelectorAll('input[name="effect"]:checked')).map(cb => cb.value);
            
            const cards = document.querySelectorAll('.card');
            
            // List of filtered sub revelations
            let filteredSubRevelations = Object.keys(revelationData.sub_effects).filter(name => {
                const effects = revelationData.sub_effects[name];
                const elementMatch = selectedElements.length === 0 || 
                    selectedElements.some(element => effects.type.includes(element));
                const effectMatch = selectedEffects.length === 0 || 
                    selectedEffects.some(effect => effects.type.includes(effect));
                return elementMatch && effectMatch;
            });

            // Find main revelations related to filtered sub revelations
            let relatedMainRevelations = new Set();
            Object.entries(revelationData.main).forEach(([mainName, subNames]) => {
                if (subNames.some(subName => filteredSubRevelations.includes(subName))) {
                    relatedMainRevelations.add(mainName);
                }
            });

            cards.forEach(card => {
                const type = card.dataset.type;
                const name = card.dataset.name;
                
                const typeMatch = selectedTypes.length === 0 || selectedTypes.includes(type);
                const nameMatch = type === 'sub' ? 
                    filteredSubRevelations.includes(name) : 
                    relatedMainRevelations.has(name);

                if (typeMatch && nameMatch) {
                    card.style.visibility = 'visible';
                    card.style.opacity = '1';
                    card.style.position = 'relative';
                    card.style.height = 'auto';
                } else {
                    card.style.visibility = 'hidden';
                    card.style.opacity = '0';
                    card.style.position = 'absolute';
                    card.style.height = '0';
                }
            });
        }

        let activeCard = null; // Track currently active card

        // Handle card click events
        const cards = document.querySelectorAll('.card');
        cards.forEach(card => {
            card.addEventListener('click', (e) => {
                e.stopPropagation(); // Prevent event bubbling
                const clickedName = card.getAttribute('data-name');
                const cardType = card.getAttribute('data-type');

                if (activeCard === card) {
                    // If clicking the same card again, remove filter
                    deactivateFilter();
                } else {
                    // If clicking a different card, apply filter
                    activateFilter(card, clickedName, cardType);
                }
            });
        });

        // Clear filter when clicking empty space
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.card') && !e.target.closest('.filter-options')) {
                deactivateFilter();
            }
        });

        function activateFilter(card, name, type) {
            // Remove style from previously active card
            if (activeCard) {
                activeCard.classList.remove('active');
            }

            // Activate new card
            activeCard = card;
            card.classList.add('active');

            // Find related revelations
            let relatedRevelations = [];
            if (type === 'main') {
                // For main revelations
                relatedRevelations = revelationData.main[name] || [];
                relatedRevelations.push(name); // Include clicked card
            } else if (type === 'sub') {
                // For sub revelations
                relatedRevelations = revelationData.sub[name] || [];
                relatedRevelations.push(name); // Include clicked card
            }

            // Apply card filtering
            cards.forEach(c => {
                const cardName = c.getAttribute('data-name');
                const shouldShow = relatedRevelations.includes(cardName);

                if (shouldShow) {
                    c.style.visibility = 'visible';
                    c.style.opacity = '1';
                    c.style.position = 'relative';
                    c.style.height = 'auto';
                } else {
                    c.style.visibility = 'hidden';
                    c.style.opacity = '0';
                    c.style.position = 'absolute';
                    c.style.height = '0';
                }
            });
        }

        function deactivateFilter() {
            // Remove active card style
            if (activeCard) {
                activeCard.classList.remove('active');
                activeCard = null;
            }

            // Show all cards
            applyFilters();
        }
    });
</script>


    
    <!-- 푸터 
    <footer>
      <p>&copy; 2025 </p>
    </footer>-->
    <button id="top-button" class="floating-top-btn">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 4L4 12L5.4 13.4L11 7.8V20H13V7.8L18.6 13.4L20 12L12 4Z" fill="rgba(255, 255, 255, 0.6)"/>
      </svg>
    </button>
  </div>
</body>
</html>