---
layout: default
custom_css: [character]
custom_js: [translation-loader]

redirect_from: 
  - /kr/character/
  - /kr/character/index.html
---

<div class="main-wrapper">
    <!-- ì–¸ì–´ ì•ˆë‚´ ë©”ì‹œì§€ -->
    <div id="language-notice" class="language-notice" style="display: none;">
        <p id="language-notice-text"></p>
    </div>
    
    <div class="navigation-path">
        <script>document.write(`<a href="../?v=${APP_VERSION}" id="nav-home">í™ˆ</a>`);</script>
        <span class="separator">/</span>
        <span class="current-page" id="nav-current">ê´´ë„</span>
    </div>
    <div class="header-container">
        <h1 id="page-title">ê´´ë„ ìœ¡ì„±</h1>
    </div>
    <!-- Filter section -->
    <div class="filter-section">
        <div class="filter-header">
            <button class="filter-toggle-btn">
                <img src="{{ site.baseurl }}/assets/img/character-cards/filter.png" alt="í•„í„°" />
                <span></span>
            </button>
            <button class="filter-reset-btn" style="display: none;">
                <img src="{{ site.baseurl }}/assets/img/character-cards/reset.png" alt="ì´ˆê¸°í™”" />
            </button>
        </div>
        
        <div class="filter-content" style="display: none;">
            <!-- Element filter -->
            <div class="filter-group">
                <h3>ì†ì„±</h3>
                <div class="filter-options">
                    <label>
                        <input type="checkbox" name="element" value="ë¬¼ë¦¬">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì†ì„±_ë¬¼ë¦¬.png" alt="ë¬¼ë¦¬">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ì´ê²©">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì†ì„±_ì´ê²©.png" alt="ì´ê²©">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="í™”ì—¼">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì†ì„±_í™”ì—¼.png" alt="í™”ì—¼">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ë¹™ê²°">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì†ì„±_ë¹™ê²°.png" alt="ë¹™ê²°">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ì „ê²©">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì†ì„±_ì „ê²©.png" alt="ì „ê²©">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ì§ˆí’">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì†ì„±_ì§ˆí’.png" alt="ì§ˆí’">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ì—¼ë™">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì†ì„±_ì—¼ë™.png" alt="ì—¼ë™">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="í•µì—´">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì†ì„±_í•µì—´.png" alt="í•µì—´">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ì¶•ë³µ">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì†ì„±_ì¶•ë³µ.png" alt="ì¶•ë³µ">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ì£¼ì›">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì†ì„±_ì£¼ì›.png" alt="ì£¼ì›">
                        <span></span>
                    </label>
                    <label>
                        <input type="checkbox" name="element" value="ë§ŒëŠ¥">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì†ì„±_ë§ŒëŠ¥.png" alt="ë§ŒëŠ¥">
                        <span></span>
                    </label>
                </div>
            </div>
            
            <!-- Position filter -->
            <div class="filter-group">
                <h3>ì§ì—…</h3>
                <div class="filter-options">
                    <label>
                        <input type="checkbox" name="position" value="ì§€ë°°">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì§ì—…_ì§€ë°°.png" alt="ì§€ë°°">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="ë°˜í•­">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì§ì—…_ë°˜í•­.png" alt="ë°˜í•­">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="ìš°ì›”">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì§ì—…_ìš°ì›”.png" alt="ìš°ì›”">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="êµ´ë³µ">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì§ì—…_êµ´ë³µ.png" alt="êµ´ë³µ">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="ë°©ìœ„">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì§ì—…_ë°©ìœ„.png" alt="ë°©ìœ„">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="êµ¬ì›">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì§ì—…_êµ¬ì›.png" alt="êµ¬ì›">
                    </label>
                    <label>
                        <input type="checkbox" name="position" value="í•´ëª…">
                        <img src="{{ site.baseurl }}/assets/img/character-cards/ì§ì—…_í•´ëª….png" alt="í•´ëª…">
                    </label>
                </div>
            </div>
            
            <!-- Rarity filter -->
            <div class="filter-group">
                <h3>ìœ í˜•</h3>
                <div class="filter-options tag-options">
                    <label>
                        <input type="checkbox" name="rarity" value="5" hidden>
                        <div class="star-container">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star5.png" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star5.png" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star5.png" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star5.png" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star5.png" alt="â˜…">
                        </div>
                    </label>
                    <label>
                        <input type="checkbox" name="rarity" value="4" hidden>
                        <div class="star-container">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star4.png" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star4.png" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star4.png" alt="â˜…">
                            <img src="{{ site.baseurl }}/assets/img/character-detail/star4.png" alt="â˜…">
                        </div>
                    </label>
                    <label><input type="checkbox" name="tag" value="í•œì •"><img src="{{ site.baseurl }}/assets/img/pay/ì •í•´ì§„ ìš´ëª….png" alt="í•œì •"></label>
                    <label><input type="checkbox" name="tag" value="í†µìƒ"><img src="{{ site.baseurl }}/assets/img/pay/ë¯¸ë˜ì˜ ìš´ëª….png" alt="í†µìƒ"></label>
                    <label><input type="checkbox" name="tag" value="í˜ë¥´ì†Œë‚˜3"><span>P3</span></label>
                    <label><input type="checkbox" name="tag" value="í˜ë¥´ì†Œë‚˜5"><span>P5</span></label>
                </div>
            </div>

            <!-- Tag filter -->
            <div class="filter-group">
                <h3>íƒœê·¸</h3>
                <div class="filter-options tag-options">
                    <label><input type="checkbox" name="tag" value="TECHNICAL"><span>TECHNICAL</span></label>
                    <label><input type="checkbox" name="tag" value="ì¶”ê°€íš¨ê³¼"><span>ì¶”ê°€ íš¨ê³¼</span></label>
                    <label><input type="checkbox" name="tag" value="ì§€ì†ëŒ€ë¯¸ì§€"><span>ì§€ì† ëŒ€ë¯¸ì§€</span></label>
                    <label><input type="checkbox" name="tag" value="ë°©ì–´ë ¥ê°ì†Œ"><span>ë°©ì–´ë ¥ ê°ì†Œ</span></label>
                    <label><input type="checkbox" name="tag" value="ê´€í†µ"><span>ê´€í†µ</span></label>
                    <label><input type="checkbox" name="tag" value="íš¨ê³¼ëª…ì¤‘"><span>íš¨ê³¼ ëª…ì¤‘</span></label>
                    <label><input type="checkbox" name="tag" value="ì‹¤ë“œ"><span>ì‹¤ë“œ</span></label>
                    <label><input type="checkbox" name="tag" value="í™”ìƒ"><span>í™”ìƒ</span></label>
                    <label><input type="checkbox" name="tag" value="í’ìŠµ"><span>í’ìŠµ</span></label>
                    <label><input type="checkbox" name="tag" value="ê°ì „"><span>ê°ì „</span></label>
                    <label><input type="checkbox" name="tag" value="ë™ê²°"><span>ë™ê²°</span></label>
                </div>
            </div>
        </div>
    </div>

    <!-- Separator line -->
    <div class="separator-line"></div>

    <!-- Search section below filter section -->
    <div class="search-section">
        <div class="search-container">
            <div class="search-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z" fill="rgba(255, 255, 255, 0.6)"/>
                </svg>
            </div>
            <input type="text" id="characterSearch" placeholder="ìºë¦­í„° ê²€ìƒ‰..." autocomplete="off">
            <div id="searchDropdown" class="search-dropdown"></div>
        </div>
        <div class="search-count"></div>
    </div>

    <!-- Character card container -->
    <div class="character-cards" id="characterCards">
        <!-- Dynamically generated by JavaScript -->
    </div>
</div>

<script>
    // ë‹¤êµ­ì–´ ì§€ì› í•¨ìˆ˜
    async function updateLanguageContent() {
        const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';
        
        // Jekyll ë‹¤êµ­ì–´ ë°ì´í„° ì‚¬ìš©
        const i18nData = {
            kr: {
                language_notice: "",
                nav_home: "í™ˆ",
                nav_current: "ê´´ë„",
                page_title: "ê´´ë„ ìœ¡ì„±",
                filtered_count: "ì „ì²´",
                search_placeholder: "ìºë¦­í„° ê²€ìƒ‰..."
            },
            en: {
                language_notice: "{{ site.data.i18n.en.language_notice | default: 'ğŸŒ English translation is in progress. Some content may still be in Korean.' }}",
                nav_home: "{{ site.data.i18n.en.nav_home | default: 'Home' }}",
                nav_current: "{{ site.data.i18n.en.character_breadcrumb | default: 'Characters' }}",
                page_title: "{{ site.data.i18n.en.character_page_title | default: 'Characters' }}",
                filtered_count: "{{ site.data.i18n.en.filtered_count | default: 'Total' }}",
                search_placeholder: "{{ site.data.i18n.en.character_search_placeholder | default: 'Search characters...' }}"
            },
            jp: {
                language_notice: "{{ site.data.i18n.jp.language_notice | default: 'ğŸŒ æ—¥æœ¬èªç¿»è¨³ã¯é€²è¡Œä¸­ã§ã™ã€‚ä¸€éƒ¨ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯éŸ“å›½èªã®ã¾ã¾ã®å ´åˆãŒã‚ã‚Šã¾ã™ã€‚' }}",
                nav_home: "{{ site.data.i18n.jp.nav_home | default: 'ãƒ›ãƒ¼ãƒ ' }}",
                nav_current: "{{ site.data.i18n.jp.character_breadcrumb | default: 'ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼' }}",
                page_title: "{{ site.data.i18n.jp.character_page_title | default: 'ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼' }}",
                filtered_count: "{{ site.data.i18n.jp.filtered_count | default: 'å…¨ä½“' }}",
                search_placeholder: "{{ site.data.i18n.jp.character_search_placeholder | default: 'ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æ¤œç´¢...' }}"
            }
        };
        
        const data = i18nData[currentLang];
        if (!data) return;
        
        // ì–¸ì–´ ì•ˆë‚´ ë©”ì‹œì§€
        if (currentLang !== 'kr') {
            const notice = document.getElementById('language-notice');
            const noticeText = document.getElementById('language-notice-text');
            if (notice && noticeText && data.language_notice) {
                noticeText.textContent = data.language_notice;
                notice.style.display = 'block';
            }
        }
        
        // ë„¤ë¹„ê²Œì´ì…˜ ë° ì œëª© ì—…ë°ì´íŠ¸
        const navHome = document.getElementById('nav-home');
        const navCurrent = document.getElementById('nav-current');
        const pageTitle = document.getElementById('page-title');
        const searchInput = document.getElementById('characterSearch');
        
        if (navHome) navHome.textContent = data.nav_home;
        if (navCurrent) navCurrent.textContent = data.nav_current;
        if (pageTitle) pageTitle.textContent = data.page_title;
        if (searchInput) searchInput.placeholder = data.search_placeholder;
        
        // í•„í„° ì¹´ìš´íŠ¸ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•œ ì „ì—­ ë³€ìˆ˜ ì„¤ì •
        window.i18nFilteredCount = data.filtered_count;
        
        // í•„í„° ì œëª© ë²ˆì—­
        updateFilterTitles(currentLang);
    }
    
    // í•„í„° ì œëª© ë²ˆì—­ í•¨ìˆ˜
    function updateFilterTitles(currentLang) {
        const filterTitles = {
            kr: {
                element: "ì†ì„±",
                position: "ì§ì—…", 
                type: "ìœ í˜•",
                tag: "íƒœê·¸",
                count_unit: "ëª…"
            },
            en: {
                element: "Element",
                position: "Position",
                type: "Type", 
                tag: "Tag",
                count_unit: " "
            },
            jp: {
                element: "å±æ€§",
                position: "è·æ¥­",
                type: "ã‚¿ã‚¤ãƒ—",
                tag: "ã‚¿ã‚°",
                count_unit: "ä½“"
            }
        };
        
        const titles = filterTitles[currentLang];
        if (!titles) return;
        
        // í•„í„° ê·¸ë£¹ ì œëª©ë“¤ ì—…ë°ì´íŠ¸
        const filterGroups = document.querySelectorAll('.filter-group h3');
        if (filterGroups.length >= 4) {
            filterGroups[0].textContent = titles.element; // ì†ì„±
            filterGroups[1].textContent = titles.position; // ì§ì—…
            filterGroups[2].textContent = titles.type; // ìœ í˜•
            filterGroups[3].textContent = titles.tag; // íƒœê·¸
        }
        
        // ê°œìˆ˜ ë‹¨ìœ„ ì „ì—­ ë³€ìˆ˜ ì„¤ì •
        window.i18nCountUnit = titles.count_unit;
    }

    // ì–¸ì–´ë³„ SEO ì„¤ì • í•¨ìˆ˜
    function updateSEOContent() {
        const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';
        
        const seoData = {
            'kr': {
                title: 'ê´´ë„ ìœ¡ì„± ê°€ì´ë“œ - í˜ë¥´ì†Œë‚˜5 ë” íŒ¬í…€ X ë£¨í˜ë¥´ë„·',
                description: 'í˜ë¥´ì†Œë‚˜5 ë” íŒ¬í…€ Xì˜ ê´´ë„ë³„ ìœ¡ì„± ê°€ì´ë“œ. ì¶”ì²œ ì„¸íŒ…, ìŠ¤í‚¬, ì˜ì‹, ì „ìš©ë¬´ê¸° ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.'
            },
            'en': {
                title: 'Character Guide - Persona 5: The Phantom X LufelNet',
                description: 'Character development guide for Persona 5: The Phantom X. Check recommended setup, skills, awareness, and exclusive weapon info.'
            },
            'jp': {
                title: 'æ€ªç›—è‚²æˆã‚¬ã‚¤ãƒ‰ - ãƒšãƒ«ã‚½ãƒŠ5 ã‚¶ãƒ»ãƒ•ã‚¡ãƒ³ãƒˆãƒ  X LufelNet',
                description: 'ãƒšãƒ«ã‚½ãƒŠ5 ã‚¶ãƒ»ãƒ•ã‚¡ãƒ³ãƒˆãƒ  Xã®æ€ªç›—åˆ¥è‚²æˆã‚¬ã‚¤ãƒ‰ã€‚ãŠã™ã™ã‚è¨­å®šã€ã‚¹ã‚­ãƒ«ã€æ„è­˜ã€å°‚ç”¨æ­¦å™¨æƒ…å ±ã‚’ã”ç¢ºèªãã ã•ã„ã€‚'
            }
        };
        
        const currentSEO = seoData[currentLang] || seoData['kr'];
        
        // íƒ€ì´í‹€ ì—…ë°ì´íŠ¸
        document.title = currentSEO.title;
        
        // ë©”íƒ€ íƒœê·¸ ì—…ë°ì´íŠ¸
        const metaDescription = document.querySelector('meta[name="description"]');
        const ogTitle = document.querySelector('meta[property="og:title"]');
        const ogDescription = document.querySelector('meta[property="og:description"]');
        
        if (metaDescription) metaDescription.setAttribute('content', currentSEO.description);
        if (ogTitle) ogTitle.setAttribute('content', currentSEO.title);
        if (ogDescription) ogDescription.setAttribute('content', currentSEO.description);
    }

    // Initialize navigation on page load
    // ê¸°ì¡´ DOMContentLoaded ë¦¬ìŠ¤ë„ˆ ì œê±°ë¨ - í•˜ë‹¨ì˜ í†µí•©ëœ ë¦¬ìŠ¤ë„ˆ ì‚¬ìš©

    // ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë°ì´í„° ì¶”ì¶œí•˜ëŠ” í•¨ìˆ˜
    function extractDataFromScript(scriptText) {
        // characterDataì™€ characterListë¥¼ ì¶”ì¶œí•˜ëŠ” ì •ê·œì‹
        const characterDataMatch = scriptText.match(/const characterData = ({[\s\S]*?});/);
        const characterListMatch = scriptText.match(/const characterList = ({[\s\S]*?});/);
        
        if (!characterDataMatch || !characterListMatch) {
            throw new Error('Failed to extract data from script');
        }
        
        // JSONìœ¼ë¡œ íŒŒì‹±í•˜ê¸° ìœ„í•´ Function ìƒì„±ì ì‚¬ìš©
        const characterData = new Function('return ' + characterDataMatch[1])();
        const characterList = new Function('return ' + characterListMatch[1])();
        
        return { characterData, characterList };
    }

    // ì–¸ì–´ë³„ ìºë¦­í„° ë°ì´í„° ë¡œë”© ë° ë³‘í•©
    async function loadCharacterData() {
        const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';
        
        try {
            // 1. í•œêµ­ì–´ ë°ì´í„° ë¡œë”© (ê¸°ë³¸ ë°ì´í„°)
            const krResponse = await fetch(`/data/kr/characters/characters.js?v=${APP_VERSION}`);
            if (!krResponse.ok) {
                throw new Error('Failed to load KR character data');
            }
            
            const krScriptText = await krResponse.text();
            const { characterData: krCharacterData, characterList: krCharacterList } = extractDataFromScript(krScriptText);
            
            console.log('KR character count:', Object.keys(krCharacterData).length);
            console.log('KR character list:', krCharacterList);
            
            // 2. ì–¸ì–´ë³„ ë°ì´í„° ë¡œë”© (í•œêµ­ì–´ê°€ ì•„ë‹Œ ê²½ìš°)
            if (currentLang !== 'kr') {
                const langResponse = await fetch(`/data/${currentLang}/characters/characters.js?v=${APP_VERSION}`);
                if (langResponse.ok) {
                    const langScriptText = await langResponse.text();
                    const { characterData: langCharacterData, characterList: langCharacterList } = extractDataFromScript(langScriptText);
                    
                    console.log(`${currentLang.toUpperCase()} character count:`, Object.keys(langCharacterData).length);
                    console.log(`${currentLang.toUpperCase()} character list:`, langCharacterList);
                    
                    // 3. ë°ì´í„° ë³‘í•© (í•˜ì´ë¸Œë¦¬ë“œ ë°©ì‹) - ì–¸ì–´ë³„ ìºë¦­í„°ë§Œ í¬í•¨
                    const mergedData = mergeCharacterData(krCharacterData, langCharacterData);
                    
                    // ì¤‘ìš”: ì „ì—­ ë³€ìˆ˜ë¥¼ ì™„ì „íˆ êµì²´
                    window.characterData = mergedData; // ë³‘í•©ëœ ë°ì´í„°ë§Œ ì‚¬ìš©
                    window.characterList = langCharacterList; // ì–¸ì–´ë³„ ìºë¦­í„° ëª©ë¡ ì‚¬ìš©
                    
                    console.log('Final characterData count:', Object.keys(window.characterData).length);
                    console.log('Final characterData keys:', Object.keys(window.characterData));
                    console.log('Final character list:', window.characterList);
                    
                } else {
                    console.log('Language data not found, using KR data');
                    // ì–¸ì–´ë³„ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ í•œêµ­ì–´ ë°ì´í„° ì‚¬ìš©
                    window.characterData = krCharacterData;
                    window.characterList = krCharacterList;
                }
            } else {
                console.log('Using KR data directly');
                // í•œêµ­ì–´ì¸ ê²½ìš° ê·¸ëŒ€ë¡œ ì‚¬ìš©
                window.characterData = krCharacterData;
                window.characterList = krCharacterList;
            }
            
            return true;
            
        } catch (error) {
            console.error('Failed to load character data:', error);
            return false;
        }
    }
    
    // ìºë¦­í„° ë°ì´í„° ë³‘í•© í•¨ìˆ˜ (í•˜ì´ë¸Œë¦¬ë“œ ë°©ì‹)
    function mergeCharacterData(krData, langData) {
        const mergedData = {};
        
        console.log('ğŸš€ğŸš€ğŸš€ NEW MERGE FUNCTION IS RUNNING! ğŸš€ğŸš€ğŸš€');
        console.log('=== MERGE CHARACTER DATA DEBUG ===');
        console.log('KR data keys:', Object.keys(krData).length, 'characters');
        console.log('Lang data keys:', Object.keys(langData).length, 'characters');
        
        // ìƒ˜í”Œ ë°ì´í„° í™•ì¸
        const firstKrKey = Object.keys(krData)[0];
        const firstLangKey = Object.keys(langData)[0];
        
        console.log(`Sample KR data (${firstKrKey}):`, {
            element: krData[firstKrKey]?.element,
            position: krData[firstKrKey]?.position,
            rarity: krData[firstKrKey]?.rarity,
            name: krData[firstKrKey]?.name,
            name_en: krData[firstKrKey]?.name_en,
            name_jp: krData[firstKrKey]?.name_jp,
            role: krData[firstKrKey]?.role,
            tag: krData[firstKrKey]?.tag
        });
        
        console.log(`Sample Lang data (${firstLangKey}):`, {
            element: langData[firstLangKey]?.element,
            position: langData[firstLangKey]?.position,
            rarity: langData[firstLangKey]?.rarity,
            name: langData[firstLangKey]?.name,
            role: langData[firstLangKey]?.role,
            tag: langData[firstLangKey]?.tag
        });
        
        // ì–¸ì–´ë³„ ë°ì´í„°ì— ìˆëŠ” ìºë¦­í„°ë§Œ í¬í•¨ (langData ê¸°ì¤€ìœ¼ë¡œ í•„í„°ë§)
        for (const characterKey in langData) {
            console.log('Merging character:', characterKey);
            
            if (krData[characterKey]) {
                // í•œêµ­ì–´ ë°ì´í„°ë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì™„ì „íˆ ë³µì‚¬ (ëª¨ë“  ì†ì„± ë³´ì¡´)
                mergedData[characterKey] = { ...krData[characterKey] };
                
                const langChar = langData[characterKey];
                const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';
                
                // name ì²˜ë¦¬: í˜„ì¬ ì–¸ì–´ì— ë”°ë¼ ì ì ˆí•œ ì´ë¦„ ì‚¬ìš©
                if (currentLang === 'en' && krData[characterKey].name_en) {
                    mergedData[characterKey].name = krData[characterKey].name_en;
                } else if (currentLang === 'jp' && krData[characterKey].name_jp) {
                    mergedData[characterKey].name = krData[characterKey].name_jp;
                } else if (langChar.name && langChar.name !== '') {
                    // ì–¸ì–´ë³„ ë°ì´í„°ì— ì´ë¦„ì´ ìˆê³  ë¹ˆ ë¬¸ìì—´ì´ ì•„ë‹ˆë©´ ì‚¬ìš©
                    mergedData[characterKey].name = langChar.name;
                }
                
                // persona ì²˜ë¦¬: í˜„ì¬ ì–¸ì–´ì— ë”°ë¼ ì ì ˆí•œ í˜ë¥´ì†Œë‚˜ ì´ë¦„ ì‚¬ìš©
                if (currentLang === 'en' && krData[characterKey].persona_en) {
                    mergedData[characterKey].persona = krData[characterKey].persona_en;
                } else if (currentLang === 'jp' && krData[characterKey].persona_jp) {
                    mergedData[characterKey].persona = krData[characterKey].persona_jp;
                } else if (langChar.persona && langChar.persona !== '') {
                    mergedData[characterKey].persona = langChar.persona;
                }
                
                // ë‹¤ë¥¸ í•„ë“œë“¤ì€ ì–¸ì–´ë³„ ë°ì´í„°ì— ê°’ì´ ìˆê³  ë¹ˆ ë¬¸ìì—´ì´ ì•„ë‹ ë•Œë§Œ ë®ì–´ì“°ê¸°
                // ì¤‘ìš”: element, position, rarity ë“±ì€ ì ˆëŒ€ ë®ì–´ì“°ì§€ ì•ŠìŒ (í•œêµ­ì–´ ë°ì´í„° ìœ ì§€)
                if (langChar.role && langChar.role !== '') {
                    mergedData[characterKey].role = langChar.role;
                }
                if (langChar.tag && langChar.tag !== '') {
                    mergedData[characterKey].tag = langChar.tag;
                }
                if (langChar.release_order !== undefined && langChar.release_order !== 0) {
                    mergedData[characterKey].release_order = langChar.release_order;
                }
                
                // ì¤‘ìš”í•œ ì†ì„±ë“¤ì´ ì œëŒ€ë¡œ ë³´ì¡´ë˜ì—ˆëŠ”ì§€ í™•ì¸
                if (!mergedData[characterKey].element || !mergedData[characterKey].position || !mergedData[characterKey].rarity) {
                    console.warn(`Missing critical data for ${characterKey}:`, {
                        element: mergedData[characterKey].element,
                        position: mergedData[characterKey].position,
                        rarity: mergedData[characterKey].rarity
                    });
                }
                
            } else {
                console.warn(`Character ${characterKey} not found in KR data`);
            }
        }
        
        console.log('Merged data keys:', Object.keys(mergedData).length, 'characters');
        console.log('Final merged characters:', Object.keys(mergedData));
        
        // ì²« ë²ˆì§¸ ë³‘í•©ëœ ìºë¦­í„°ì˜ ì „ì²´ ë°ì´í„° í™•ì¸
        const firstMergedKey = Object.keys(mergedData)[0];
        if (firstMergedKey) {
            console.log('FULL MERGED DATA for', firstMergedKey, ':', mergedData[firstMergedKey]);
        }
        
        return mergedData;
    }
    
    // P3 í•„í„° í‘œì‹œ ì—¬ë¶€ í™•ì¸
    function shouldShowP3Filter() {
        if (!characterData) return false;
        
        // ë¡œë”©ëœ ìºë¦­í„° ì¤‘ì— persona3=trueì¸ ìºë¦­í„°ê°€ ìˆëŠ”ì§€ í™•ì¸
        return Object.values(characterData).some(char => char.persona3 === true);
    }
    
    // P3 í•„í„° í‘œì‹œ/ìˆ¨ê¹€ ì²˜ë¦¬
    function toggleP3Filter() {
        const p3Filter = document.querySelector('label input[value="í˜ë¥´ì†Œë‚˜3"]');
        if (p3Filter) {
            const p3Label = p3Filter.closest('label');
            if (shouldShowP3Filter()) {
                p3Label.style.display = 'inline-block';
            } else {
                p3Label.style.display = 'none';
            }
        }
    }

    // ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€ë¥¼ ìœ„í•œ í”Œë˜ê·¸
    let isInitializing = false;
    let isInitialized = false;

    async function initializePageContent() {
        // ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€
        if (isInitializing || isInitialized) {
            console.log('initializePageContent already running or completed');
            return;
        }
        
        isInitializing = true;
        console.log('=== STARTING PAGE INITIALIZATION ===');
        
        // ìºë¦­í„° ë°ì´í„° ë¡œë”©
        const dataLoaded = await loadCharacterData();
        if (!dataLoaded || typeof characterData === 'undefined') {
            console.error('characterData is not loaded');
            isInitializing = false;
            return;
        }
        
        // P3 í•„í„° í‘œì‹œ ì—¬ë¶€ ì²˜ë¦¬
        toggleP3Filter();

        const cardsContainer = document.getElementById('characterCards');
        const searchCount = document.querySelector('.search-count');
        
        // ê¸°ì¡´ ì¹´ë“œë“¤ ì œê±° (ì¤‘ë³µ ë°©ì§€)
        cardsContainer.innerHTML = '';
        
        // Combine mainParty and supportParty from characterList (ì–¸ì–´ë³„ ì œí•œëœ ëª©ë¡)
        let allCharacters = [
            ...characterList.mainParty,
            ...characterList.supportParty
        ];

        // Exclude 'Wonder' from characters
        allCharacters = allCharacters.filter(character => character !== "ì›ë”");
        
        console.log('Character list for current language:', allCharacters);
        console.log('Available characters in characterData:', Object.keys(characterData));
        
        // characterListì— ìˆëŠ” ìºë¦­í„°ë§Œ ì‚¬ìš©í•˜ê³ , characterDataì—ë„ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
        const availableCharacters = allCharacters.filter(characterName => {
            const exists = characterData[characterName] !== undefined;
            if (!exists) {
                console.warn(`Character ${characterName} not found in characterData`);
            }
            return exists;
        });
        
        console.log('Final available characters:', availableCharacters);
        
        // Sort by release_order (descending), then by rarity
        const sortedCharacters = availableCharacters.sort((a, b) => {
            const releaseOrderDiff = characterData[b].release_order - characterData[a].release_order;
            if (releaseOrderDiff !== 0) return releaseOrderDiff;
            return characterData[b].rarity - characterData[a].rarity;
        });
        
        // ì´ˆê¸° ê²€ìƒ‰ ê²°ê³¼ ìˆ˜ í‘œì‹œ
        const countText = window.i18nFilteredCount || 'ì „ì²´';
        const countUnit = window.i18nCountUnit || 'ëª…';
        searchCount.textContent = `${countText} ${sortedCharacters.length}${countUnit}`;
        
        console.log('=== STARTING CARD CREATION ===');
        console.log('sortedCharacters array:', sortedCharacters);
        console.log('characterData object keys:', Object.keys(characterData));
        
        // Create card for each character
        sortedCharacters.forEach((characterName, index) => {
            console.log(`[${index}] Creating card for: ${characterName}`);
            
            const charData = characterData[characterName];
            if (!charData) {
                console.error(`No data found for character: ${characterName}`);
                return;
            }
            
            // ì „ì²´ ë°ì´í„° êµ¬ì¡° í™•ì¸ (ì²« ë²ˆì§¸ ìºë¦­í„°ë§Œ)
            if (index === 0) {
                console.log(`FULL DATA for ${characterName}:`, charData);
                console.log(`All keys in charData:`, Object.keys(charData));
            }
            
            console.log(`${characterName} data:`, {
                element: charData.element,
                position: charData.position,
                rarity: charData.rarity,
                name: charData.name
            });
            
            // ì†ì„± ê°’ ë””ë²„ê·¸
            const element = charData.element;
            const position = charData.position;
            const rarity = charData.rarity;
            
            if (!element || !position || !rarity) {
                console.warn(`Missing attributes for ${characterName}:`, {
                    element: element,
                    position: position,
                    rarity: rarity
                });
            }
            
            const card = document.createElement('div');
            card.className = 'card';
            card.dataset.element = element || 'undefined';
            card.dataset.position = position || 'undefined';
            card.dataset.rarity = rarity || 'undefined';
            card.dataset.persona5 = charData.persona5 ? 'true' : 'false';
            card.dataset.persona3 = charData.persona3 ? 'true' : 'false';
            card.dataset.limit = charData.limit ? 'true' : 'false';
            card.dataset.tags = charData.tag || '';
            
            // Create link wrapper - ì–¸ì–´ íŒŒë¼ë¯¸í„° ì¶”ê°€
            const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';
            const link = document.createElement('a');
            link.href = `/character.html?name=${encodeURIComponent(characterName)}&lang=${currentLang}&v=${APP_VERSION}`;
            link.style.textDecoration = 'none';
            link.style.color = 'inherit';
            
            // Position icon container
            const positionContainer = document.createElement('div');
            positionContainer.className = 'position-container';
            
            // Position icon
            const positionIcon = document.createElement('img');
            positionIcon.src = `{{ site.baseurl }}/assets/img/character-cards/ì§ì—…_${position || 'undefined'}.png`;
            positionIcon.alt = position || 'undefined';
            positionIcon.className = 'position-icon';
            
            // Character image
            const img = document.createElement('img');
            img.src = `{{ site.baseurl }}/assets/img/character-cards/card_skeleton.webp`;
            img.alt = characterName;
            img.className = 'character-img';
            
            // ì‹¤ì œ ì´ë¯¸ì§€ ë¡œë“œ
            const realImage = new Image();
            realImage.src = `{{ site.baseurl }}/assets/img/character-cards/${characterName}.webp`;
            realImage.alt = characterName;
            realImage.className = 'character-img';
            realImage.onload = () => {
                img.src = realImage.src;
                img.classList.add('loaded');
            };
            
            // Element icon
            const elementIcon = document.createElement('img');
            elementIcon.src = `{{ site.baseurl }}/assets/img/character-cards/ì†ì„±_${element || 'undefined'}.png`;
            elementIcon.alt = element || 'undefined';
            elementIcon.className = 'element-icon';
            
            // Add name
            const nameText = document.createElement('span');
            nameText.textContent = charData.name;
            nameText.className = 'name-text';
            nameText.dataset.persona3 = charData.persona3;
            nameText.dataset.persona4 = charData.persona4;
            nameText.dataset.persona5 = charData.persona5;
            
            positionContainer.appendChild(positionIcon);
            link.appendChild(positionContainer);
            link.appendChild(img);
            link.appendChild(elementIcon);
            link.appendChild(nameText);
            card.appendChild(link);
            cardsContainer.appendChild(card);
        });

        // í•„í„° ë° ê²€ìƒ‰ ê¸°ëŠ¥ ì´ˆê¸°í™”
        initializeFiltersAndSearch(sortedCharacters);
        
        // ë²ˆì—­ ì ìš© (ë°ì´í„° ë¡œë”© í›„)
        await applyTranslations();
        
        // ì´ˆê¸°í™” ì™„ë£Œ
        isInitializing = false;
        isInitialized = true;
        console.log('=== PAGE INITIALIZATION COMPLETED ===');
    } // initializePageContent í•¨ìˆ˜ ì¢…ë£Œ
    
    // í•„í„° ë° ê²€ìƒ‰ ê¸°ëŠ¥ ì´ˆê¸°í™”
    function initializeFiltersAndSearch(sortedCharacters) {
        const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';
        
        // ì˜ì–´/ì¼ë³¸ì–´ì¼ ë•Œ íƒœê·¸ í•„í„° ìˆ¨ê¸°ê¸°
        if (currentLang === 'en' || currentLang === 'jp') {
            const tagFilterGroup = document.querySelector('.filter-group:last-child');
            if (tagFilterGroup) {
                tagFilterGroup.style.display = 'none';
            }
        }

        // í•„í„° ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        const filterInputs = document.querySelectorAll('input[type="checkbox"]');
        filterInputs.forEach(input => {
            input.addEventListener('change', applyFilters);
        });

        const searchCount = document.querySelector('.search-count');
        const filterToggleBtn = document.querySelector('.filter-toggle-btn');
        const filterContent = document.querySelector('.filter-content');
        const filterResetBtn = document.querySelector('.filter-reset-btn');
        const checkboxes = document.querySelectorAll('.filter-options input[type="checkbox"]');
        
        if (filterContent) {
            filterContent.style.display = 'block';
        }

        // Filter toggle
        if (filterToggleBtn) {
            filterToggleBtn.addEventListener('click', () => {
                filterContent.style.display = filterContent.style.display === 'none' ? 'block' : 'none';
            });
            filterToggleBtn.style.display = 'none';
        }
        
        // Reset button
        if (filterResetBtn) {
            filterResetBtn.addEventListener('click', () => {
                checkboxes.forEach(cb => cb.checked = false);
                filterResetBtn.style.display = 'none';
                applyFilters();
            });
            filterResetBtn.style.display = 'none';
        }

        // Filter application function
        function applyFilters() {
            const selectedElements = Array.from(document.querySelectorAll('input[name="element"]:checked')).map(cb => cb.value);
            const selectedPositions = Array.from(document.querySelectorAll('input[name="position"]:checked')).map(cb => cb.value);
            const selectedRarities = Array.from(document.querySelectorAll('input[name="rarity"]:checked')).map(cb => parseInt(cb.value));
            const selectedTags = Array.from(document.querySelectorAll('input[name="tag"]:checked')).map(cb => cb.value);
            
            let visibleCount = 0;
            
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                const element = card.dataset.element;
                const position = card.dataset.position;
                const rarity = parseInt(card.dataset.rarity);
                const isPersona5 = card.dataset.persona5 === 'true';
                const isPersona3 = card.dataset.persona3 === 'true';
                const isLimited = card.dataset.limit === 'true';
                const characterTags = card.dataset.tags || '';
                
                const elementMatch = selectedElements.length === 0 || 
                    selectedElements.includes(element) || 
                    (element === "ì§ˆí’ë¹™ê²°" && (selectedElements.includes("ì§ˆí’") || selectedElements.includes("ë¹™ê²°")));
                    
                const positionMatch = selectedPositions.length === 0 || selectedPositions.includes(position);
                const rarityMatch = selectedRarities.length === 0 || selectedRarities.includes(rarity);
                
                const tagMatch = selectedTags.every(tag => {
                    switch(tag) {
                        case 'í˜ë¥´ì†Œë‚˜5':
                            return isPersona5;
                        case 'í˜ë¥´ì†Œë‚˜3':
                            return isPersona3;
                        case 'í•œì •':
                            return isLimited;
                        case 'í†µìƒ':
                            return !isLimited;
                        case 'TECHNICAL':
                            return characterTags.includes('TECHNICAL') || characterTags.includes('ìŠ¤í‚¬ë§ˆìŠ¤í„°');
                        case 'ì¶”ê°€íš¨ê³¼':
                            return characterTags.includes('ì¶”ê°€ íš¨ê³¼') || characterTags.includes('ì¶”ê°€íš¨ê³¼');
                        case 'ì§€ì†ëŒ€ë¯¸ì§€':
                            return characterTags.includes('ì§€ì† ëŒ€ë¯¸ì§€') || characterTags.includes('í™”ìƒ') || characterTags.includes('ì£¼ì›');
                        case 'í™”ìƒ':
                            return characterTags.includes('í™”ìƒ') || (characterTags.includes('ì›ì†Œ ì´ìƒ') && !characterTags.includes('ì›ì†Œ ì´ìƒ ì œê±°'));
                        case 'í’ìŠµ':
                            return characterTags.includes('í’ìŠµ') || (characterTags.includes('ì›ì†Œ ì´ìƒ') && !characterTags.includes('ì›ì†Œ ì´ìƒ ì œê±°'));
                        case 'ê°ì „':
                            return characterTags.includes('ê°ì „') || (characterTags.includes('ì›ì†Œ ì´ìƒ') && !characterTags.includes('ì›ì†Œ ì´ìƒ ì œê±°'));
                        case 'ë™ê²°':
                            return characterTags.includes('ë™ê²°') || (characterTags.includes('ì›ì†Œ ì´ìƒ') && !characterTags.includes('ì›ì†Œ ì´ìƒ ì œê±°'));
                        case 'ì‹¤ë“œ':
                            return characterTags.includes('ì‹¤ë“œ');
                        case 'íš¨ê³¼ëª…ì¤‘':
                            return characterTags.includes('íš¨ê³¼ ëª…ì¤‘');
                        case 'ë°©ì–´ë ¥ê°ì†Œ':
                            return characterTags.includes('ë°©ì–´ë ¥ ê°ì†Œ');
                        case 'ê´€í†µ':
                            return characterTags.includes('ê´€í†µ');
                        default:
                            return false;
                    }
                });
                
                const shouldShow = elementMatch && positionMatch && rarityMatch && (selectedTags.length === 0 || tagMatch);
                card.style.display = shouldShow ? 'block' : 'none';
                if (shouldShow) visibleCount++;
            });
            
            // Update search count
            if (searchCount) {
                const countText = window.i18nFilteredCount || 'ì „ì²´';
                const countUnit = window.i18nCountUnit || 'ëª…';
                searchCount.textContent = `${countText} ${visibleCount}${countUnit}`;
            }
        }

        // ê²€ìƒ‰ ê¸°ëŠ¥ êµ¬í˜„
        const searchInput = document.getElementById('characterSearch');
        const dropdown = document.getElementById('searchDropdown');
        const cards = document.querySelectorAll('.card');
        const characterNames = sortedCharacters;

        // ë³„ì¹­ ë§¤í•‘
        const nicknameMap = {
            'ìœ ì´' : 'YUI',
            'ë¼ë©´' : 'ì¹´ë…¸ ìŠŒ',
            'ìš§ìƒ¤' : 'ì‚¬ì¹´ëª¨í†  ë¥˜ì§€',
            'ìˆ˜ëª¨ì½”' : 'ë…¸ê²Œ í† ëª¨ì½”Â·ì—¬ë¦„',
            'ìˆ˜í† í•˜' : 'ì•„ë¼ì´ ëª¨í† í•˜Â·ì—¬ë¦„',
            'ì™•ì™•ë£¨': 'ë„ê²ìì¹´ ë£¨ìš°ë‚˜',
            'ì–¼íƒ±': 'ì•„ì‹œì•¼ ë§ˆì‚¬í‚¤',
            'ì¡°ì»¤': 'ì•„ë§ˆë¯¸ì•¼ ë Œ',
            'ì˜ì‚¬' : 'í‚¤íƒ€ìí†  í‚¤ë¼',
            'ê·¸ìƒˆë¼': 'ì•„ì¼€ì¹˜ ê³ ë¡œ',
            'í™”ì˜¤ë§' : 'ë¦¬ ì•¼ì˜¤ë§Â·ì‚¬ìë¬´',
            'ë¶ˆì˜¤ë§' : 'ë¦¬ ì•¼ì˜¤ë§Â·ì‚¬ìë¬´',
            '5ë¦¬ì½”' : 'íƒ€ë„¤ë¬´ë¼ ë¦¬ì½”Â·ë§¤í™”',
            'í’ë¦¬ì½”' : 'íƒ€ë„¤ë¬´ë¼ ë¦¬ì½”Â·ë§¤í™”',
            'í’íƒ€ë‰´' : 'ì½”í† ë„¤ ëª½íƒ€ë‰´Â·ë°±ì¡°',
            'ë°±íƒ€ë‰´' : 'ì½”í† ë„¤ ëª½íƒ€ë‰´Â·ë°±ì¡°',
            '3ì£¼' : 'ìœ í‚¤ ë§ˆì½”í† '
        };

        if (searchInput) {
            searchInput.addEventListener('input', (e) => {
                const searchValue = e.target.value.toLowerCase();
                if (dropdown) {
                    dropdown.innerHTML = '';
                    
                    if (searchValue.length > 0) {
                        const nicknameMatch = Object.entries(nicknameMap).find(([nickname, realName]) => 
                            nickname.toLowerCase().includes(searchValue)
                        );

                        const matches = characterNames.filter(name => {
                            const characterName = characterData[name].name;
                            return name.toLowerCase().includes(searchValue) ||
                                   characterName.toLowerCase().includes(searchValue) ||
                                   (nicknameMatch && characterName === nicknameMatch[1]);
                        });

                        if (matches.length > 0) {
                            dropdown.style.display = 'block';
                            matches.forEach(name => {
                                const div = document.createElement('div');
                                div.className = 'dropdown-item';
                                div.textContent = characterData[name].name;
                                div.addEventListener('click', () => {
                                    searchInput.value = characterData[name].name;
                                    dropdown.style.display = 'none';
                                    filterBySearch(name.toLowerCase());
                                });
                                dropdown.appendChild(div);
                            });
                        } else {
                            dropdown.style.display = 'none';
                        }
                    } else {
                        dropdown.style.display = 'none';
                        filterBySearch('');
                    }
                }

                filterBySearch(searchValue);
            });
        }

        // Search filtering function
        function filterBySearch(searchValue) {
            let visibleCount = 0;
            
            cards.forEach(card => {
                const nameText = card.querySelector('.name-text');
                if (!nameText) return;
                
                const displayName = nameText.textContent;
                const displayNameLower = displayName.toLowerCase();
                
                const characterKey = Object.keys(characterData).find(key => 
                    characterData[key].name === displayName
                );

                const nicknameMatch = Object.entries(nicknameMap).find(([nickname, realName]) => 
                    nickname.toLowerCase().includes(searchValue) && realName === displayName
                );
                
                const shouldShow = searchValue === '' || 
                    characterKey?.toLowerCase().includes(searchValue) || 
                    displayNameLower.includes(searchValue) ||
                    nicknameMatch !== undefined;
                
                card.style.display = shouldShow ? 'block' : 'none';
                if (shouldShow) visibleCount++;
            });
            
            if (searchCount) {
                const countText = window.i18nFilteredCount || 'ì „ì²´';
                searchCount.textContent = `${countText} ${visibleCount}ëª…`;
            }
        }
    } // initializePageContent í•¨ìˆ˜ ì¢…ë£Œ
    
    // ë²ˆì—­ ì‹œìŠ¤í…œ ì ìš©
    async function applyTranslations() {
        const currentLang = typeof LanguageRouter !== 'undefined' ? LanguageRouter.getCurrentLanguage() : 'kr';
        if (currentLang === 'kr') return;
        
        try {
            // ë²ˆì—­ ë°ì´í„° ë¡œë“œ
            const translations = await TranslationLoader.loadTranslations('characters', currentLang);
            if (!translations) {
                console.warn('No translations found for', currentLang);
                return;
            }
            
            console.log('Applying translations for', currentLang, translations);
            
            // ì¹´ë“œ ì—…ë°ì´íŠ¸
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                const nameElement = card.querySelector('.name-text');
                if (!nameElement) return;
                
                const originalName = nameElement.textContent;
                const characterKey = Object.keys(characterData).find(key => 
                    characterData[key].name === originalName
                );
                
                if (characterKey && characterData[characterKey]) {
                    const char = characterData[characterKey];
                    
                    // ì´ë¦„ ë²ˆì—­ (name_en ë˜ëŠ” name_jp ì‚¬ìš©)
                    const translatedName = currentLang === 'en' ? char.name_en : char.name_jp;
                    if (translatedName) {
                        nameElement.textContent = translatedName;
                    }
                    
                    // ì†ì„± ì•„ì´ì½˜ alt í…ìŠ¤íŠ¸ ë²ˆì—­
                    const elementImg = card.querySelector('.element-icon');
                    if (elementImg && translations.elements && translations.elements[char.element]) {
                        elementImg.alt = translations.elements[char.element];
                        elementImg.title = translations.elements[char.element];
                    }
                }
            });
            
            // í•„í„° ë ˆì´ë¸” ë²ˆì—­
            updateFilterLabels(translations, currentLang);
            
            // ê²€ìƒ‰ í”Œë ˆì´ìŠ¤í™€ë” ë²ˆì—­
            updateSearchPlaceholder(currentLang);
            
            // UI í…ìŠ¤íŠ¸ ë²ˆì—­
            updateUITexts(currentLang);
            
        } catch (error) {
            console.warn('Translation application failed:', error);
        }
    }
    
    // í•„í„° ë ˆì´ë¸” ë²ˆì—­
    function updateFilterLabels(translations, lang) {
        if (!translations) return;
        
        // ì†ì„± í•„í„° ë²ˆì—­
        if (translations.elements) {
            const elementLabels = document.querySelectorAll('.filter-group:first-child .filter-options label span');
            elementLabels.forEach((span, index) => {
                const elementKey = span.textContent;
                if (translations.elements[elementKey]) {
                    span.textContent = translations.elements[elementKey];
                }
            });
        }
        
        // ì§ì—… í•„í„° ë²ˆì—­ 
        if (translations.positions) {
            const positionLabels = document.querySelectorAll('.filter-group:nth-child(2) .filter-options label');
            positionLabels.forEach(label => {
                const img = label.querySelector('img');
                if (img) {
                    const positionKey = img.alt;
                    if (translations.positions[positionKey]) {
                        img.alt = translations.positions[positionKey];
                        img.title = translations.positions[positionKey];
                    }
                }
            });
        }
        
        // íƒœê·¸ í•„í„° ë²ˆì—­
        if (translations.tags) {
            const tagLabels = document.querySelectorAll('.filter-group:last-child .filter-options label span');
            tagLabels.forEach(span => {
                const tagKey = span.textContent;
                if (translations.tags[tagKey]) {
                    span.textContent = translations.tags[tagKey];
                }
            });
        }
    }
    
    // ê²€ìƒ‰ í”Œë ˆì´ìŠ¤í™€ë” ë²ˆì—­
    function updateSearchPlaceholder(lang) {
        const searchInput = document.getElementById('characterSearch');
        if (!searchInput) return;
        
        const placeholders = {
            'en': 'Search characters...',
            'jp': 'ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æ¤œç´¢...'
        };
        
        if (placeholders[lang]) {
            searchInput.placeholder = placeholders[lang];
        }
    }
    
    // UI í…ìŠ¤íŠ¸ ë²ˆì—­
    function updateUITexts(lang) {
        if (lang === 'kr') return;
        
        // ê¸°ì¡´ i18n ì‹œìŠ¤í…œ í™œìš©
        if (window.i18nData && window.i18nData[lang]) {
            const i18n = window.i18nData[lang];
            
            // í˜ì´ì§€ ì œëª©
            const pageTitle = document.getElementById('page-title');
            if (pageTitle && i18n.character_title) {
                pageTitle.textContent = i18n.character_title;
            }
            
            // ë¸Œë ˆë“œí¬ëŸ¼
            const navHome = document.getElementById('nav-home');
            const navCurrent = document.getElementById('nav-current');
            if (navHome && i18n.nav_home) navHome.textContent = i18n.nav_home;
            if (navCurrent && i18n.nav_character) navCurrent.textContent = i18n.nav_character;
            
            // í•„í„° ê·¸ë£¹ ì œëª©ë“¤
            const filterGroups = document.querySelectorAll('.filter-group h3');
            const filterTitles = [i18n.filter_element, i18n.filter_position, i18n.filter_type, i18n.filter_tag];
            filterGroups.forEach((title, index) => {
                if (filterTitles[index]) {
                    title.textContent = filterTitles[index];
                }
            });
        }
    }
    
    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™” (í†µí•©ëœ ì´ˆê¸°í™” í•¨ìˆ˜)
    document.addEventListener('DOMContentLoaded', async () => {
        console.log('DOMContentLoaded event fired');
        
        // ê¸°ë³¸ ì´ˆê¸°í™” ì‘ì—…
        Navigation.load('character'); // nav active
        VersionChecker.check();
        
        // SEO ì„¤ì • ì—…ë°ì´íŠ¸
        updateSEOContent();
        
        // ì–¸ì–´ ë¼ìš°í„° ì´ˆê¸°í™” ë° ì½˜í…ì¸  ì—…ë°ì´íŠ¸
        if (typeof LanguageRouter !== 'undefined') {
            // ì´ë¯¸ ì–¸ì–´ íŒŒë¼ë¯¸í„°ê°€ ìˆê±°ë‚˜ ì§ì ‘ ì ‘ê·¼í•œ ê²½ìš° ë¦¬ë‹¤ì´ë ‰ì…˜ ì—†ì´ ì§„í–‰
            const hasLangParam = window.location.search.includes('lang=');
            if (hasLangParam) {
                // ì–¸ì–´ íŒŒë¼ë¯¸í„°ê°€ ìˆìœ¼ë©´ ë°”ë¡œ ì½˜í…ì¸  ë¡œë“œ
                updateLanguageContent().then(async () => {
                    await initializePageContent();
                });
            } else {
                // ì–¸ì–´ íŒŒë¼ë¯¸í„°ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ í•œêµ­ì–´ë¡œ ì„¤ì •í•˜ê³  ì½˜í…ì¸  ë¡œë“œ
                const currentUrl = new URL(window.location);
                currentUrl.searchParams.set('lang', 'kr');
                window.history.replaceState({}, '', currentUrl);
                
                updateLanguageContent().then(async () => {
                    await initializePageContent();
                });
            }
        } else {
            updateLanguageContent();
            await initializePageContent();
        }
    });
    
    // ì¶”ê°€ ì•ˆì „ì¥ì¹˜: window.onloadì—ì„œë„ ì²´í¬
    window.addEventListener('load', async () => {
        console.log('Window load event fired');
        if (!isInitialized) {
            console.log('Page not initialized yet, running initialization...');
            await initializePageContent();
        } else {
            console.log('Page already initialized, skipping...');
        }
    });
    
</script> 