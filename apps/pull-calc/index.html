---
layout: default
custom_css: []
custom_js: [tooltip, character/character-list]
custom_data: [characters/characters.js]
permalink: /pull-calc/
language: kr
title: 가챠 플래너 - 페르소나5 더 팬텀 X 루페르넷
description: 페르소나5 더 팬텀 X 뽑기 계획 시뮬레이터
alternate_urls:
  en: /pull-calc/?lang=en
  jp: /pull-calc/?lang=jp
redirect_from:
  - /kr/pull-calc/
---

<!-- Pull Calc CSS -->
<link rel="stylesheet" href="{{ site.baseurl }}/apps/pull-calc/pull-calc.css?v={{ site.time | date: '%s' }}">

<!-- Schedule Data -->
<script src="{{ site.baseurl }}/apps/schedule/data.js?v={{ site.time | date: '%s' }}"></script>

<!-- SEO Meta Tags -->
{% if page.alternate_urls %}
<link rel="alternate" hreflang="ko" href="{{ site.url }}/pull-calc/" />
{% for lang in page.alternate_urls %}
<link rel="alternate" hreflang="{{ lang[0] }}" href="{{ site.url }}{{ lang[1] }}" />
{% endfor %}
<link rel="alternate" hreflang="x-default" href="{{ site.url }}/pull-calc/" />
{% endif %}

<!-- Main Content -->
<div class="main-wrapper pull-calc-page">
    <!-- Navigation Path -->
    <div class="navigation-path">
        <script>document.write(`<a href="../../?v=${APP_VERSION}" id="nav-home">홈</a>`);</script>
        <span class="separator">/</span>
        <span class="current-page" id="nav-current">가챠 플래너</span>
    </div>

    <!-- Header -->
    <div class="header-container">
        <h1 id="page-title">가챠 플래너</h1>
    </div>

    <!-- Must Read Accordion -->
    <div class="settings-container">
        <div class="accordion-section" id="mustReadAccordion">
            <div class="accordion-header" data-target="mustReadContent">
                <h3 id="mustReadTitle">계산기 기준 및 안내</h3>
                <svg class="accordion-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </div>
            <div class="accordion-content" id="mustReadContent">
                <div class="mustread-content" id="mustReadText">
                    <!-- Content will be populated by JavaScript based on language -->
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Accordions -->
    <div class="settings-container settings-grid">
        <!-- Assets Accordion -->
        <div class="accordion-section expanded" id="assetsAccordion">
            <div class="accordion-header" data-target="assetsContent">
                <h3 id="assetsTitle">보유 자산</h3>
                <svg class="accordion-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </div>
            <div class="accordion-content" id="assetsContent">
                <div class="input-row">
                    <div class="input-group">
                        <label class="input-label">
                            <img src="{{ site.baseurl }}/assets/img/pay/이계 수정.png" alt="" class="input-icon">
                            <span id="labelPaidEmber">유료 엠버</span>
                        </label>
                        <input type="number" id="inputPaidEmber" class="modal-input" value="0" min="0">
                    </div>
                    <div class="input-group">
                        <label class="input-label">
                            <img src="{{ site.baseurl }}/assets/img/pay/이계 엠버.png" alt="" class="input-icon">
                            <span id="labelEmber">이계 엠버</span>
                        </label>
                        <input type="number" id="inputEmber" class="modal-input" value="0" min="0">
                    </div>
                    <div class="input-group">
                        <label class="input-label">
                            <img src="{{ site.baseurl }}/assets/img/pay/인지 단면.png" alt="" class="input-icon">
                            <span id="labelCognigem">인지 결정</span>
                            <span class="tooltip-icon" data-i18n-tooltip="tooltipCognigem" data-tooltip="10개 = 100 엠버 (글로벌판)">
                                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="9" cy="9" r="8.5" stroke="currentColor" stroke-opacity="0.1" fill="rgba(255,255,255,0.05)"></circle>
                                    <path d="M7.2 7.2C7.2 6.32 7.92 5.6 8.8 5.6H9.2C10.08 5.6 10.8 6.32 10.8 7.2C10.8 7.84 10.48 8.4 9.96 8.68L9.6 8.88C9.28 9.04 9.2 9.2 9.2 9.6V10.4M9 12.4V13.2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.3"></path>
                                </svg>
                            </span>
                        </label>
                        <input type="number" id="inputCognigem" class="modal-input" value="0" min="0">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label class="input-label">
                            <img src="{{ site.baseurl }}/assets/img/pay/정해진 운명.png" alt="" class="input-icon">
                            <span id="labelTicket">계약 티켓</span>
                            <span class="tooltip-icon" data-i18n-tooltip="tooltipTicket" data-tooltip="1장 = 150 엠버">
                                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="9" cy="9" r="8.5" stroke="currentColor" stroke-opacity="0.1" fill="rgba(255,255,255,0.05)"></circle>
                                    <path d="M7.2 7.2C7.2 6.32 7.92 5.6 8.8 5.6H9.2C10.08 5.6 10.8 6.32 10.8 7.2C10.8 7.84 10.48 8.4 9.96 8.68L9.6 8.88C9.28 9.04 9.2 9.2 9.2 9.6V10.4M9 12.4V13.2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.3"></path>
                                </svg>
                            </span>
                        </label>
                        <input type="number" id="inputTicket" class="modal-input" value="0" min="0">
                    </div>

                    <div class="input-group">
                        <label class="input-label">
                            <img src="{{ site.baseurl }}/assets/img/pay/정해진 코인.png" alt="" class="input-icon">
                            <span id="labelWeaponTicket">무기 티켓</span>
                            <span class="tooltip-icon" data-i18n-tooltip="tooltipWeaponTicket" data-tooltip="1장 = 150 엠버">
                                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="9" cy="9" r="8.5" stroke="currentColor" stroke-opacity="0.1" fill="rgba(255,255,255,0.05)"></circle>
                                    <path d="M7.2 7.2C7.2 6.32 7.92 5.6 8.8 5.6H9.2C10.08 5.6 10.8 6.32 10.8 7.2C10.8 7.84 10.48 8.4 9.96 8.68L9.6 8.88C9.28 9.04 9.2 9.2 9.2 9.6V10.4M9 12.4V13.2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.3"></path>
                                </svg>
                            </span>
                        </label>
                        <input type="number" id="inputWeaponTicket" class="modal-input" value="0" min="0">
                    </div>
                </div>
            </div>
        </div>

        <!-- Pity Accordion -->
        <div class="accordion-section expanded" id="pityAccordion">
            <div class="accordion-header" data-target="pityContent">
                <h3 id="pityTitle">피티 설정</h3>
                <div class="pity-summary">
                    <span id="charMedianValue">110회</span>
                    <span class="pity-sep">/</span>
                    <span id="weaponMedianValue">70회</span>
                </div>
                <svg class="accordion-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </div>
            <div class="accordion-content" id="pityContent">
                <div class="input-row">
                    <div class="input-group">
                        <label class="input-label">
                            <img src="{{ site.baseurl }}/assets/img/pay/정해진 운명.png" alt="" class="input-icon">
                            <span id="labelCharPity">캐릭터 진행 중</span>
                            <span class="pity-max">/110</span>
                            <span class="tooltip-icon" data-i18n-tooltip="tooltipCharPity" data-tooltip="캐릭터 배너에서 마지막 5성을 뽑은 후 경과한 뽑기 수입니다. 110회는 하드 피티(천장 확정)입니다.">
                                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="9" cy="9" r="8.5" stroke="currentColor" stroke-opacity="0.1" fill="rgba(255,255,255,0.05)"></circle>
                                    <path d="M7.2 7.2C7.2 6.32 7.92 5.6 8.8 5.6H9.2C10.08 5.6 10.8 6.32 10.8 7.2C10.8 7.84 10.48 8.4 9.96 8.68L9.6 8.88C9.28 9.04 9.2 9.2 9.2 9.6V10.4M9 12.4V13.2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.3"></path>
                                </svg>
                            </span>
                        </label>
                        <input type="number" id="inputCharPity" class="modal-input" value="0" min="0" max="110">
                    </div>
                    <div class="input-group">
                        <label class="input-label">
                            <img src="{{ site.baseurl }}/assets/img/pay/정해진 코인.png" alt="" class="input-icon">
                            <span id="labelWeaponPity">무기 진행 중</span>
                            <span class="pity-max">/70</span>
                            <span class="tooltip-icon" data-i18n-tooltip="tooltipWeaponPity" data-tooltip="무기 배너에서 마지막 5성을 뽑은 후 경과한 뽑기 수입니다. 70회는 하드 피티(천장)입니다.">
                                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="9" cy="9" r="8.5" stroke="currentColor" stroke-opacity="0.1" fill="rgba(255,255,255,0.05)"></circle>
                                    <path d="M7.2 7.2C7.2 6.32 7.92 5.6 8.8 5.6H9.2C10.08 5.6 10.8 6.32 10.8 7.2C10.8 7.84 10.48 8.4 9.96 8.68L9.6 8.88C9.28 9.04 9.2 9.2 9.2 9.6V10.4M9 12.4V13.2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.3"></path>
                                </svg>
                            </span>
                        </label>
                        <input type="number" id="inputWeaponPity" class="modal-input" value="0" min="0" max="70">
                    </div>
                </div>
                <div class="checkbox-row">
                    <div class="input-group checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="inputWeapon5050Failed">
                            <span id="labelWeapon5050Failed">무기 50:50 실패</span>
                            <span class="tooltip-icon" data-i18n-tooltip="tooltipWeapon5050Failed" data-tooltip="무기 배너에서 50% 확률로 한정 무기를 뽑지 못했는지 여부입니다. 실패 시 다음 5성은 반드시 픽업 무기입니다.">
                                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="9" cy="9" r="8.5" stroke="currentColor" stroke-opacity="0.1" fill="rgba(255,255,255,0.05)"></circle>
                                    <path d="M7.2 7.2C7.2 6.32 7.92 5.6 8.8 5.6H9.2C10.08 5.6 10.8 6.32 10.8 7.2C10.8 7.84 10.48 8.4 9.96 8.68L9.6 8.88C9.28 9.04 9.2 9.2 9.2 9.6V10.4M9 12.4V13.2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.3"></path>
                                </svg>
                            </span>
                        </label>
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label class="input-label">
                            <span id="labelWeaponScenario">무기 계산 시나리오</span>
                            <span class="tooltip-icon" data-i18n-tooltip="tooltipWeaponScenario" data-tooltip="무기 50:50의 운을 기준으로 필요 엠버량을 계산합니다. 최선: 모든 50:50 성공, 평균: 절반 성공, 최악: 모든 50:50 실패">
                                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="9" cy="9" r="8.5" stroke="currentColor" stroke-opacity="0.1" fill="rgba(255,255,255,0.05)"></circle>
                                    <path d="M7.2 7.2C7.2 6.32 7.92 5.6 8.8 5.6H9.2C10.08 5.6 10.8 6.32 10.8 7.2C10.8 7.84 10.48 8.4 9.96 8.68L9.6 8.88C9.28 9.04 9.2 9.2 9.2 9.6V10.4M9 12.4V13.2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.3"></path>
                                </svg>
                            </span>
                        </label>
                        <!-- 기본값은 Worst-->
                        <select id="inputWeaponScenario" class="modal-input">
                            <option value="best" id="optionBest">최선 (모든 50:50 성공)</option>
                            <option value="average" id="optionAverage">평균 (절반 성공)</option>
                            <option value="worst" selected id="optionWorst">최악 (모든 50:50 실패)</option>
                        </select>
                    </div>
                </div>
                <!--
                <p class="pity-source" id="pitySource">
                    Pity 중간값은 iantCode의 P5X 가챠 통계 데이터를 기반으로 산정됩니다.
                </p>
                -->
            </div>
        </div>

        <!-- Income Accordion -->
        <div class="accordion-section expanded" id="incomeAccordion">
            <div class="accordion-header" data-target="incomeContent">
                <h3 id="incomeTitle">수입 설정</h3>
                <svg class="accordion-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </div>
            <div class="accordion-content" id="incomeContent">
                <div class="input-row">
                    <div class="input-group">
                        <label class="input-label">
                            <img src="{{ site.baseurl }}/assets/img/pay/패스.png" alt="" class="input-icon">
                            <span id="labelDailyMission">일일 미션</span>
                            <span class="tooltip-icon" data-i18n-tooltip="tooltipDailyMission" data-tooltip="매일 획득 가능한 엠버. 기본값 80.">
                                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="9" cy="9" r="8.5" stroke="currentColor" stroke-opacity="0.1" fill="rgba(255,255,255,0.05)"></circle>
                                    <path d="M7.2 7.2C7.2 6.32 7.92 5.6 8.8 5.6H9.2C10.08 5.6 10.8 6.32 10.8 7.2C10.8 7.84 10.48 8.4 9.96 8.68L9.6 8.88C9.28 9.04 9.2 9.2 9.2 9.6V10.4M9 12.4V13.2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.3"></path>
                                </svg>
                            </span>
                        </label>
                        <input type="number" id="inputDailyMission" class="modal-input" value="80" min="0">
                    </div>
                    <div class="input-group">
                        <label class="input-label">
                            <img src="{{ site.baseurl }}/assets/img/pay/이벤트.png" alt="" class="input-icon">
                            <span id="labelVersionIncome">버전별 수입</span>
                            <span class="tooltip-icon" data-i18n-tooltip="tooltipVersionIncome" data-tooltip="각 버전(패치)마다 지급되는 수입. 흉몽(NTMR), 바다(SoS) 등 주간 콘텐츠 합계를 버전 기간으로 나눈 값 + 점검 보상, 리딤 코드, 이벤트 등. 4.0 이후는 3주 간격이므로 1.5배 적용.">
                                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="9" cy="9" r="8.5" stroke="currentColor" stroke-opacity="0.1" fill="rgba(255,255,255,0.05)"></circle>
                                    <path d="M7.2 7.2C7.2 6.32 7.92 5.6 8.8 5.6H9.2C10.08 5.6 10.8 6.32 10.8 7.2C10.8 7.84 10.48 8.4 9.96 8.68L9.6 8.88C9.28 9.04 9.2 9.2 9.2 9.6V10.4M9 12.4V13.2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.3"></path>
                                </svg>
                            </span>
                        </label>
                        <input type="number" id="inputVersionIncome" class="modal-input" value="6000" min="0">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label class="input-label">
                            <input type="checkbox" id="inputMonthlySubEnabled">
                            <img src="{{ site.baseurl }}/assets/img/pay/월정액.png" alt="" class="input-icon">
                            <span id="labelMonthlySub">월정액 (엠버/일)</span>
                            <span class="tooltip-icon" data-i18n-tooltip="tooltipMonthlySub" data-tooltip="월정액 구매 시 매일 획득하는 엠버. 기본값 100.">
                                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="9" cy="9" r="8.5" stroke="currentColor" stroke-opacity="0.1" fill="rgba(255,255,255,0.05)"></circle>
                                    <path d="M7.2 7.2C7.2 6.32 7.92 5.6 8.8 5.6H9.2C10.08 5.6 10.8 6.32 10.8 7.2C10.8 7.84 10.48 8.4 9.96 8.68L9.6 8.88C9.28 9.04 9.2 9.2 9.2 9.6V10.4M9 12.4V13.2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.3"></path>
                                </svg>
                            </span>
                        </label>
                        <input type="number" id="inputMonthlySubAmount" class="modal-input" value="100" min="0">
                    </div>
                    <div class="input-group">
                        <!-- Battle Pass - DISABLED -->
                        <!-- <label class="input-label">
                            <input type="checkbox" id="inputBattlePassEnabled">
                            <img src="{{ site.baseurl }}/assets/img/pay/디럭스 패스.png" alt="" class="input-icon">
                            <span id="labelBattlePass">배틀 패스 (엠버/패치)</span>
                            <span class="tooltip-icon" data-i18n-tooltip="tooltipBattlePass" data-tooltip="배틀 패스 구매 시 각 패치마다 획득하는 엠버. 기본값 1430 (한정 티켓 5장 + 유료 엠버 680).">
                                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="9" cy="9" r="8.5" stroke="currentColor" stroke-opacity="0.1" fill="rgba(255,255,255,0.05)"></circle>
                                    <path d="M7.2 7.2C7.2 6.32 7.92 5.6 8.8 5.6H9.2C10.08 5.6 10.8 6.32 10.8 7.2C10.8 7.84 10.48 8.4 9.96 8.68L9.6 8.88C9.28 9.04 9.2 9.2 9.2 9.6V10.4M9 12.4V13.2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.3"></path>
                                </svg>
                            </span>
                        </label>
                        <input type="number" id="inputBattlePassAmount" class="modal-input" value="1430" min="0"> -->
                    </div>
                </div>
                <div class="checkbox-row">
                    <div class="input-group checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="inputRecursive">
                            <img src="{{ site.baseurl }}/assets/img/pay/인지 단면.png" alt="" class="input-icon">
                            <span id="labelRecursive">인지 단면 재귀적 변환</span>
                            <span class="tooltip-icon" data-i18n-tooltip="tooltipRecursive" data-tooltip="모든 4성 캐릭터 풀돌(A6) 상태를 가정합니다. 4성, 5성 캐릭터를 뽑을 때 획득하는 인지 단면을 즉시 엠버로 변환(10개=100엠버)하여 다시 뽑기에 사용합니다.">
                                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="9" cy="9" r="8.5" stroke="currentColor" stroke-opacity="0.1" fill="rgba(255,255,255,0.05)"></circle>
                                    <path d="M7.2 7.2C7.2 6.32 7.92 5.6 8.8 5.6H9.2C10.08 5.6 10.8 6.32 10.8 7.2C10.8 7.84 10.48 8.4 9.96 8.68L9.6 8.88C9.28 9.04 9.2 9.2 9.2 9.6V10.4M9 12.4V13.2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.3"></path>
                                </svg>
                            </span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Extra Income Accordion -->
        <div class="accordion-section expanded" id="extraIncomeAccordion">
            <div class="accordion-header" data-target="extraIncomeContent">
                <h3>
                    <span id="extraIncomeTitle">추가 수입</span>
                    <button type="button" class="extra-income-add-inline" id="extraIncomeAddBtn">+</button>
                    <span class="tooltip-icon" data-i18n-tooltip="tooltipExtraIncome" data-tooltip="Weekly income counts Mondays, and Monthly income counts the 1st day of the month between the current and next banner.">
                        <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="9" cy="9" r="8.5" stroke="currentColor" stroke-opacity="0.1" fill="rgba(255,255,255,0.05)"></circle>
                            <path d="M7.2 7.2C7.2 6.32 7.92 5.6 8.8 5.6H9.2C10.08 5.6 10.8 6.32 10.8 7.2C10.8 7.84 10.48 8.4 9.96 8.68L9.6 8.88C9.28 9.04 9.2 9.2 9.2 9.6V10.4M9 12.4V13.2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.3"></path>
                        </svg>
                    </span>
                </h3>
                <svg class="accordion-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </div>
            <div class="accordion-content" id="extraIncomeContent">
                <div id="extraIncomeRoot"></div>
            </div>
        </div>
    </div>

    <!-- Timeline Section -->
    <section class="timeline-section">
        <div class="timeline-container" id="timelineContainer">
            <!-- Timeline will be rendered here -->
            <div class="timeline-loading">
                <span id="loadingText">로딩 중...</span>
            </div>
        </div>
    </section>

    <!-- Balance Chart Section -->
    <section class="chart-section">
        <div class="section-header">
            <h2 id="chartTitle">재화 변화 그래프</h2>
            <span class="tooltip-icon" data-i18n-tooltip="tooltipChart" data-tooltip="시간에 따른 재화 변화를 보여줍니다. 빨간색 영역은 재화가 부족한 구간입니다.">
                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="9" cy="9" r="8.5" stroke="currentColor" stroke-opacity="0.1" fill="rgba(255,255,255,0.05)"></circle>
                    <path d="M7.2 7.2C7.2 6.32 7.92 5.6 8.8 5.6H9.2C10.08 5.6 10.8 6.32 10.8 7.2C10.8 7.84 10.48 8.4 9.96 8.68L9.6 8.88C9.28 9.04 9.2 9.2 9.2 9.6V10.4M9 12.4V13.2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.3"></path>
                </svg>
            </span>
        </div>
        <div class="chart-container" id="chartContainer">
            <canvas id="balanceChart"></canvas>
            <div class="chart-empty" id="chartEmpty">
                <span id="chartEmptyText">타임라인에서 캐릭터를 선택하세요</span>
            </div>
        </div>
    </section>

    <!-- Plan Section -->
    <section class="plan-section">
        <div class="section-header">
            <h2 id="planTitle">뽑기 계획</h2>
            <span class="plan-count" id="planCount">(0)</span>
        </div>
        <div class="plan-description" id="planDescription">
            타임라인에서 캐릭터를 클릭하여 계획에 추가하세요.
        </div>
        <div class="plan-list" id="planList">
            <!-- Plan items will be rendered here -->
        </div>
    </section>
</div>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

<!-- Navigation -->
<script src="{{ site.baseurl }}/assets/js/nav.js?v={{ site.time | date: '%s' }}"></script>

<!-- Pull Calc JS -->
<script src="{{ site.baseurl }}/apps/pull-calc/pull-calc-i18n.js?v={{ site.time | date: '%s' }}"></script>
<script src="{{ site.baseurl }}/apps/pull-calc/pull-calc.js?v={{ site.time | date: '%s' }}"></script>
<script src="{{ site.baseurl }}/apps/pull-calc/pull-calc-extra.js?v={{ site.time | date: '%s' }}"></script>
<script src="{{ site.baseurl }}/apps/pull-calc/pull-calc-plan.js?v={{ site.time | date: '%s' }}"></script>
<script src="{{ site.baseurl }}/apps/pull-calc/pull-calc-graph.js?v={{ site.time | date: '%s' }}"></script>

<script>
(function() {
    // SEO Meta Data
    const seoData = {
        kr: {
            title: '가챠 플래너 - 페르소나5 더 팬텀 X 루페르넷',
            description: '페르소나5 더 팬텀 X 가챠 계획 시뮬레이터. 향후 캐릭터 출시에 맞춰 필요한 재화를 계산하고 계약 계획을 수립할 수 있습니다.',
            keywords: 'P5X, 페르소나5X, 가챠 플래너, 가챠 계산기, 가챠 시뮬레이터, P5X 계산기, 계약 계획',
            ogLocale: 'ko_KR'
        },
        en: {
            title: 'Pull Planner - Persona 5 The Phantom X | lufel.net',
            description: 'Pull planning simulator for Persona 5 The Phantom X. Calculate required resources and plan your pulls for upcoming character releases.',
            keywords: 'P5X, Persona 5X, Pull Planner, Gacha Calculator, Pull Simulator, Pull Calculator, Gacha Planning',
            ogLocale: 'en_US'
        },
        jp: {
            title: 'ガチャプランナー - ペルソナ5 ザ・ファントム X | lufel.net',
            description: 'ペルソナ5 ザ・ファントム Xのガチャ計画シミュレーター。今後のキャラクターリリースに合わせて必要な資源を計算し、ガチャ計画を立てることができます。',
            keywords: 'P5X, ペルソナ5X, ガチャプランナー, ガチャ計算機, ガチャシミュレーター, P5X計算機, ガチャ計画',
            ogLocale: 'ja_JP'
        }
    };

    function detectLang() {
        const urlParams = new URLSearchParams(window.location.search);
        const lang = urlParams.get('lang');
        if (lang && ['kr', 'en', 'jp'].includes(lang)) {
            return lang;
        }
        // URL 경로에서 언어 확인
        const pathLang = window.location.pathname.split('/')[1];
        if (['kr', 'en', 'jp'].includes(pathLang)) {
            return pathLang;
        }
        // 로컬 스토리지에서 언어 확인
        const savedLang = localStorage.getItem('preferredLanguage');
        if (savedLang && ['kr', 'en', 'jp'].includes(savedLang)) {
            return savedLang;
        }
        // 브라우저 언어 감지
        const browserLang = navigator.language.toLowerCase();
        if (browserLang.startsWith('ko')) return 'kr';
        if (browserLang.startsWith('ja')) return 'jp';
        if (browserLang.startsWith('en')) return 'en';
        return 'kr'; // 기본값
    }

    function updateSEOTags(lang) {
        const seo = seoData[lang] || seoData.kr;
        const baseUrl = 'https://lufel.net';
        const currentUrl = `${baseUrl}/pull-calc/?lang=${lang}`;

        // Update document title
        document.title = seo.title;

        // Update meta description
        let metaDesc = document.querySelector('meta[name="description"]');
        if (!metaDesc) {
            metaDesc = document.createElement('meta');
            metaDesc.setAttribute('name', 'description');
            document.head.appendChild(metaDesc);
        }
        metaDesc.setAttribute('content', seo.description);

        // Update meta keywords
        let metaKeywords = document.querySelector('meta[name="keywords"]');
        if (!metaKeywords) {
            metaKeywords = document.createElement('meta');
            metaKeywords.setAttribute('name', 'keywords');
            document.head.appendChild(metaKeywords);
        }
        metaKeywords.setAttribute('content', seo.keywords);

        // Update Open Graph tags
        function updateOGTag(property, content) {
            let tag = document.querySelector(`meta[property="${property}"]`);
            if (!tag) {
                tag = document.createElement('meta');
                tag.setAttribute('property', property);
                document.head.appendChild(tag);
            }
            tag.setAttribute('content', content);
        }

        updateOGTag('og:title', seo.title);
        updateOGTag('og:description', seo.description);
        updateOGTag('og:url', currentUrl);
        updateOGTag('og:locale', seo.ogLocale);
        updateOGTag('og:type', 'website');
        updateOGTag('og:image', `${baseUrl}/assets/img/home/seo.png`);

        // Update Twitter Card tags
        function updateTwitterTag(name, content) {
            let tag = document.querySelector(`meta[name="${name}"]`);
            if (!tag) {
                tag = document.createElement('meta');
                tag.setAttribute('name', name);
                document.head.appendChild(tag);
            }
            tag.setAttribute('content', content);
        }

        updateTwitterTag('twitter:card', 'summary_large_image');
        updateTwitterTag('twitter:title', seo.title);
        updateTwitterTag('twitter:description', seo.description);
        updateTwitterTag('twitter:image', `${baseUrl}/assets/img/home/seo.png`);

        // Update canonical URL
        let canonical = document.querySelector('link[rel="canonical"]');
        if (!canonical) {
            canonical = document.createElement('link');
            canonical.setAttribute('rel', 'canonical');
            document.head.appendChild(canonical);
        }
        canonical.setAttribute('href', currentUrl);

        // Update HTML lang attribute
        document.documentElement.setAttribute('lang', lang === 'jp' ? 'ja' : lang === 'kr' ? 'ko' : 'en');
    }

    // Initialize on DOM ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
            const lang = detectLang();
            Navigation.load('pull-calc');
            updateSEOTags(lang);
        });
    } else {
        const lang = detectLang();
        Navigation.load('pull-calc');
        updateSEOTags(lang);
    }
})();
</script>
